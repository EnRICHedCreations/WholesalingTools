<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wholesaling Tools Dashboard - Enriched Property Solutions LLC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        /* Custom styles for Deal Analysis */
        html {
            scroll-behavior: smooth;
        }

        .tab-content {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Alert message styles */
        .alert-message {
            z-index: 9999;
        }

        /* Custom color scheme */
        .bg-primary {
            background-color: #3b82f6;
        }

        .text-primary {
            color: #3b82f6;
        }

        .bg-secondary {
            background-color: #1d4ed8;
        }

        /* Tab styles */
        .tab-active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .tab-inactive {
            background-color: white;
            color: #6b7280;
            border-color: #d1d5db;
        }

        .tab-inactive:hover {
            background-color: #f3f4f6;
            color: #374151;
        }

        /* Mobile responsiveness for tabs */
        @media (max-width: 768px) {
            .tab-container {
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }

            .tab-container::-webkit-scrollbar {
                display: none;
            }

            .tab-list {
                display: flex;
                min-width: max-content;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-blue-800 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Mobile Header -->
            <div class="flex flex-col space-y-4 py-6 md:hidden">
                <div class="flex items-center justify-center space-x-3">
                    <div class="bg-white rounded-lg p-2 shadow-md">
                        <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/>
                        </svg>
                    </div>
                    <div class="text-center">
                        <h1 class="text-xl font-bold text-white">Free Wholesaling Tools</h1>
                        <p class="text-blue-100 text-xs font-medium">Real Estate Analysis Platform</p>
                    </div>
                </div>
                <div class="text-center">
                    <div class="text-white font-semibold text-xs">Created by</div>
                    <div class="text-blue-100 text-xs">Enriched Property Solutions LLC</div>
                </div>
            </div>

            <!-- Desktop Header -->
            <div class="hidden md:flex justify-between items-center py-8">
                <div class="flex items-center space-x-4">
                    <div class="bg-white rounded-lg p-2 shadow-md">
                        <svg class="w-8 h-8 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-white">FreeWholesalingTools.com</h1>
                        <p class="text-blue-100 text-sm font-medium">Professional Real Estate Analysis Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-right">
                        <div class="text-white font-semibold text-sm">Created by</div>
                        <div class="text-blue-100 text-sm">Enriched Property Solutions LLC</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Navigation Tabs -->
    <div class="bg-white border-b sticky top-0 z-30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="tab-container">
                <nav class="tab-list flex flex-wrap gap-2 py-2" role="tablist">
                    <button onclick="switchTab('deal-analysis')" id="tab-deal-analysis" class="tab-active px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üìä Deal Analysis & Calculator
                    </button>
                    <button onclick="switchTab('assignment-fee')" id="tab-assignment-fee" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üí∞ Assignment Fee Calculator
                    </button>
                    <button onclick="switchTab('csv-duplicate-finder')" id="tab-csv-duplicate-finder" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üîç CSV Duplicate Finder
                    </button>
                    <button onclick="switchTab('coming-soon-1')" id="tab-coming-soon-1" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üó∫Ô∏è Address Geocoder
                    </button>
                    <button onclick="switchTab('coming-soon-2')" id="tab-coming-soon-2" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        ü§ñ AI Property Assessment
                    </button>
                    <button onclick="switchTab('contracts-generator')" id="tab-contracts-generator" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üìÑ Contract Generator
                    </button>
                    <button onclick="switchTab('rental-calculator')" id="tab-rental-calculator" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üè† Rental Calculator
                    </button>
                    <button onclick="switchTab('seller-finance')" id="tab-seller-finance" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üí∞ Seller Finance Calculator
                    </button>
                    <button onclick="switchTab('land-value')" id="tab-land-value" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üåç Land Value Estimator
                    </button>
                    <button onclick="switchTab('novation-calculator')" id="tab-novation-calculator" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üî¨ Novation Calculator
                    </button>
                    <button onclick="switchTab('lead-scorer')" id="tab-lead-scorer" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üéØ Lead Scorer
                    </button>
                    <button onclick="switchTab('hedge-fund-calculator')" id="tab-hedge-fund-calculator" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üè¶ Hedge Fund Calculator
                    </button>
                    <button onclick="switchTab('seller-psychology')" id="tab-seller-psychology" class="tab-inactive px-4 py-2 rounded-lg font-medium text-sm border transition-colors whitespace-nowrap">
                        üé≠ Seller Psychology
                    </button>
                </nav>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Deal Analysis Tab - YOUR ORIGINAL CONTENT PRESERVED -->
        <div id="content-deal-analysis" class="tab-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">Deal Analysis & Calculator</h2>
                <button onclick="clearAnalysis()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear Analysis
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>How to use:</strong> Enter your ARV and repair costs to use the calculators below, they are based on these two inputs.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">       
                <!-- Enhanced ARV Calculator with $/sqft -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">üè† ARV Calculator (with $/sq ft)</h3>

                    <!-- Subject Property Square Footage -->
                    <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                        <label class="block text-gray-700 text-sm font-semibold mb-2">Subject Property Square Footage</label>
                        <input type="number" id="subjectSqft" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="1500" onchange="calculateARV()">
                        <p class="text-xs text-gray-600 mt-1">Enter the square footage of the property you're analyzing</p>
                    </div>

                    <div class="space-y-6">
                        <!-- Comparable 1 -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <label class="block text-gray-700 text-sm font-semibold mb-3">Comparable Sale 1</label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">Sale Price</label>
                                    <input type="number" id="comp1" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="250000" onchange="calculateARV()">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">Square Feet</label>
                                    <input type="number" id="comp1Sqft" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="1450" onchange="calculateARV()">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">$/sq ft</label>
                                    <div class="px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg font-semibold text-green-600" id="comp1PricePerSqft">$0.00</div>
                                </div>
                            </div>
                        </div>

                        <!-- Comparable 2 -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <label class="block text-gray-700 text-sm font-semibold mb-3">Comparable Sale 2</label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">Sale Price</label>
                                    <input type="number" id="comp2" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="245000" onchange="calculateARV()">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">Square Feet</label>
                                    <input type="number" id="comp2Sqft" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="1400" onchange="calculateARV()">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">$/sq ft</label>
                                    <div class="px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg font-semibold text-green-600" id="comp2PricePerSqft">$0.00</div>
                                </div>
                            </div>
                        </div>

                        <!-- Comparable 3 -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <label class="block text-gray-700 text-sm font-semibold mb-3">Comparable Sale 3</label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">Sale Price</label>
                                    <input type="number" id="comp3" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="260000" onchange="calculateARV()">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">Square Feet</label>
                                    <input type="number" id="comp3Sqft" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="1550" onchange="calculateARV()">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600 mb-1">$/sq ft</label>
                                    <div class="px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg font-semibold text-green-600" id="comp3PricePerSqft">$0.00</div>
                                </div>
                            </div>
                        </div>

                        <!-- ARV Results -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Average Method -->
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <div class="text-center">
                                    <div class="text-sm text-green-700 font-medium">Average Sale Price Method</div>
                                    <div class="text-2xl font-bold text-green-600" id="calculatedARV">$0</div>
                                </div>
                            </div>

                            <!-- Price Per Square Foot Method -->
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <div class="text-center">
                                    <div class="text-sm text-blue-700 font-medium">$/sq ft Method</div>
                                    <div class="text-xs text-blue-600 mb-1">Avg: <span id="avgPricePerSqft">$0.00</span>/sq ft</div>
                                    <div class="text-2xl font-bold text-blue-600" id="calculatedARVBySqft">$0</div>
                                </div>
                            </div>
                        </div>

                        <!-- Final Recommended ARV -->
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <div class="flex justify-between items-center">
                                <span class="font-semibold text-yellow-800">Recommended ARV (Conservative):</span>
                                <span class="text-3xl font-bold text-yellow-600" id="recommendedARV">$0</span>
                            </div>
                            <p class="text-xs text-yellow-700 mt-2">Uses the lower of the two calculation methods for conservative estimates</p>
                        </div>
                    </div>
                </div>

                <!-- Simple Repair Cost Input -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4">üî® Estimated Repairs</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Total Estimated Repair Costs</label>
                            <input type="number" id="totalRepairsInput"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg text-lg font-semibold text-right"
                                   placeholder="0"
                                   onchange="updateSimpleRepairs()">
                            <p class="text-xs text-gray-500 mt-1">Enter your total estimated repair costs for this property</p>
                        </div>

                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                            <div class="flex justify-between items-center">
                                <span class="font-semibold text-orange-800">Total Repairs:</span>
                                <span class="text-xl font-bold text-orange-600" id="totalRepairs">$0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Profit Margin Analysis and Deal Evaluation - Full Width -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-6">üí∞ Profit Margin Analysis and Deal Evaluation</h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Left Side: Input Values -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Input Values</h4>
                        <div>
                            <label class="block text-gray-700 text-sm font-semibold mb-2">Purchase Price</label>
                            <input type="number" id="purchasePrice" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="180000" onchange="calculateProfit()">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-semibold mb-2">Assignment Fee</label>
                            <input type="number" id="assignmentFee" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="15000" onchange="calculateProfit()">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-semibold mb-2">Marketing Costs</label>
                            <input type="number" id="marketingCosts" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="500" onchange="calculateProfit()">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-semibold mb-2">Other Costs</label>
                            <input type="number" id="otherCosts" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="200" onchange="calculateProfit()">
                        </div>
                    </div>

                    <!-- Right Side: Calculations and Analysis -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Calculations & Analysis</h4>

                        <!-- Profit Breakdown -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h5 class="font-semibold mb-3">Profit Breakdown</h5>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-sm">ARV:</span>
                                    <span class="text-sm font-medium" id="profitARV">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm">Purchase Price:</span>
                                    <span class="text-sm font-medium" id="profitPurchase">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm">Repairs:</span>
                                    <span class="text-sm font-medium" id="profitRepairs">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm">Closing Fees (10%):</span>
                                    <span class="text-sm font-medium" id="profitClosingFees">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm">Assignment Fee:</span>
                                    <span class="text-sm font-medium text-green-600" id="profitAssignment">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm">Marketing & Costs:</span>
                                    <span class="text-sm font-medium text-red-600" id="profitCosts">$0</span>
                                </div>
                                <hr class="my-2">
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold">Buyer's Profit Potential:</span>
                                    <span class="text-lg font-bold" id="buyerProfit">$0</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold">Your Net Profit:</span>
                                    <span class="text-lg font-bold text-green-600" id="yourProfit">$0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Deal Score -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex justify-between items-center">
                                <span class="font-medium">Deal Score:</span>
                                <span class="text-2xl font-bold" id="dealScore">-</span>
                            </div>
                        </div>

                        <!-- Deal Evaluation -->
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h5 class="font-semibold mb-2">Deal Evaluation</h5>
                            <div id="dealEvaluation" class="text-sm text-gray-700">
                                Enter deal details to see evaluation
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Buyer-Focused Profit Calculator -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4">üéØ Buyer-Focused Profit Calculator</h3>
                <p class="text-sm text-gray-600 mb-4">Formula: ARV - Repairs - Closing Cost - Buyer Profit = MAO</p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-4">
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-gray-600 uppercase tracking-wide">ARV</span>
                            <div class="text-lg font-bold text-gray-800 mt-1" id="buyerFocusedARV">$0</div>
                            <div class="text-xs text-gray-500 mt-1">After Repair Value</div>
                        </div>
                    </div>

                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-gray-600 uppercase tracking-wide">Repairs</span>
                            <div class="text-lg font-bold text-gray-800 mt-1" id="buyerFocusedRepairs">$0</div>
                            <div class="text-xs text-gray-500 mt-1">Total Repair Costs</div>
                        </div>
                    </div>

                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-orange-600 uppercase tracking-wide">Closing Costs</span>
                            <div class="text-lg font-bold text-orange-800 mt-1" id="buyerFocusedClosing">$0</div>
                            <div class="text-xs text-orange-500 mt-1">10% of ARV</div>
                        </div>
                    </div>

                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-purple-600 uppercase tracking-wide">Buyer Profit</span>
                            <div class="text-lg font-bold text-purple-800 mt-1" id="buyerFocusedProfit">$0</div>
                            <div class="text-xs text-purple-500 mt-1">Based on Repair Level</div>
                        </div>
                    </div>

                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-green-600 uppercase tracking-wide">MAO</span>
                            <div class="text-lg font-bold text-green-600 mt-1" id="buyerFocusedMAO">$0</div>
                            <div class="text-xs text-green-500 mt-1">Max Allowable Offer</div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-blue-600 uppercase tracking-wide">LAO</span>
                            <div class="text-lg font-bold text-blue-600 mt-1" id="buyerFocusedLAO">$0</div>
                            <div class="text-xs text-blue-500 mt-1">MAO √ó 70%</div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                    <h4 class="font-semibold text-green-800 text-sm mb-2">üí∞ Buyer Profit Structure:</h4>
                    <div class="text-xs text-green-700 space-y-1">
                        <div>‚Ä¢ <strong>Under $30k repairs:</strong> $30k buyer profit required</div>
                        <div>‚Ä¢ <strong>$30k-$50k repairs:</strong> Same as repair amount for profit</div>
                        <div>‚Ä¢ <strong>$50k-$80k repairs:</strong> $50k buyer profit required</div>
                    </div>
                </div>
            </div>

            <!-- Rapid Offer System -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4">‚ö° Rapid Offer System Calculator</h3>
                <p class="text-sm text-gray-600 mb-4">Based on Flip with Rick / Zach Ginn Wholesaling Formula</p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-gray-600 uppercase tracking-wide">Net Value</span>
                            <div class="text-lg font-bold text-gray-800 mt-1" id="rapidNetValue">$0</div>
                            <div class="text-xs text-gray-500 mt-1">ARV - Repairs</div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-blue-600 uppercase tracking-wide">Multiplier</span>
                            <div class="text-lg font-bold text-blue-800 mt-1" id="rapidMultiplier">0%</div>
                            <div class="text-xs text-blue-500 mt-1">Based on ARV</div>
                        </div>
                    </div>

                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-green-600 uppercase tracking-wide">Max Offer (MAO)</span>
                            <div class="text-lg font-bold text-green-600 mt-1" id="rapidMAO">$0</div>
                            <div class="text-xs text-green-500 mt-1">Highest Offer</div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-blue-600 uppercase tracking-wide">Initial Offer (LAO)</span>
                            <div class="text-lg font-bold text-blue-600 mt-1" id="rapidLAO">$0</div>
                            <div class="text-xs text-blue-500 mt-1">70% of MAO</div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                    <h4 class="font-semibold text-yellow-800 text-sm mb-2">üéØ Offer Strategy:</h4>
                    <div class="text-xs text-yellow-700 space-y-1">
                        <div>‚Ä¢ <strong>Start with Initial Offer (LAO)</strong> - Your opening lowball offer</div>
                        <div>‚Ä¢ <strong>Negotiate up to Max Offer (MAO)</strong> - Your absolute ceiling</div>
                        <div>‚Ä¢ <strong>Multiplier scales with ARV</strong> - Higher value properties use higher percentages</div>
                        <div>‚Ä¢ <strong>&lt;$120k: 70%</strong> | <strong>$120k-$220k: 80%</strong> | <strong>$220k-$300k: 81.5%</strong> | <strong>$300k-$400k: 82.9%</strong> | <strong>&gt;$400k: 84.9%</strong></div>
                    </div>
                </div>
            </div>

            <!-- Custom Percentage Calculator -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4">üìä Custom Percentage Calculator</h3>
                <p class="text-sm text-gray-600 mb-4">Formula: (ARV √ó X%) - Repairs = Max Offer</p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-gray-600 uppercase tracking-wide">ARV</span>
                            <div class="text-lg font-bold text-gray-800 mt-1" id="customARV">$0</div>
                            <div class="text-xs text-gray-500 mt-1">After Repair Value</div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <label class="text-xs font-medium text-blue-600 uppercase tracking-wide block mb-2">Percentage</label>
                        <input type="number" id="customPercentage"
                               class="w-full text-center text-lg font-bold bg-transparent border-0 focus:ring-0 p-0"
                               placeholder="75" min="1" max="100" step="0.1"
                               oninput="calculateCustomOffer()">
                        <div class="text-xs text-blue-500 mt-1">% of ARV</div>
                    </div>

                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-gray-600 uppercase tracking-wide">Repairs</span>
                            <div class="text-lg font-bold text-gray-800 mt-1" id="customRepairs">$0</div>
                            <div class="text-xs text-gray-500 mt-1">Total Repair Costs</div>
                        </div>
                    </div>

                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-green-600 uppercase tracking-wide">Max Offer</span>
                            <div class="text-lg font-bold text-green-600 mt-1" id="customMaxOffer">$0</div>
                            <div class="text-xs text-green-500 mt-1">Your Calculated Offer</div>
                        </div>
                    </div>

                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                        <div class="text-center">
                            <span class="text-xs font-medium text-purple-600 uppercase tracking-wide">Spread</span>
                            <div class="text-lg font-bold text-purple-600 mt-1" id="customSpread">$0</div>
                            <div class="text-xs text-purple-500 mt-1">ARV - Max Offer</div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <h4 class="font-semibold text-blue-800 text-sm mb-2">üí° How to Use:</h4>
                    <div class="text-xs text-blue-700 space-y-1">
                        <div>‚Ä¢ <strong>Enter your percentage</strong> - Common ranges: 65%-80% for different markets/strategies</div>
                        <div>‚Ä¢ <strong>Calculation updates automatically</strong> - Uses your ARV and repair estimates from above</div>
                        <div>‚Ä¢ <strong>Compare with Buyer-Focused Calculator</strong> - Use both calculators to validate your offers</div>
                        <div>‚Ä¢ <strong>Adjust percentage based on</strong> - Market conditions, competition, profit targets</div>
                    </div>
                </div>
            </div>

            <!-- Market Comparables -->
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-4">üèòÔ∏è Market Comparables Research</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-medium mb-3">Quick Comp Analysis</h4>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Neighborhood</label>
                                <input type="text" id="neighborhood" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Enter neighborhood or zip code">
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-gray-700 text-sm font-semibold mb-2">Price Range Low</label>
                                    <input type="number" id="priceRangeLow" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="200000">
                                </div>
                                <div>
                                    <label class="block text-gray-700 text-sm font-semibold mb-2">Price Range High</label>
                                    <input type="number" id="priceRangeHigh" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="300000">
                                </div>
                            </div>
                            <div class="grid grid-cols-3 gap-2">
                                <div>
                                    <label class="block text-gray-700 text-xs font-semibold mb-1">Min Beds</label>
                                    <input type="number" id="minBeds" class="w-full px-3 py-2 border border-gray-300 rounded" placeholder="2">
                                </div>
                                <div>
                                    <label class="block text-gray-700 text-xs font-semibold mb-1">Min Baths</label>
                                    <input type="number" step="0.5" id="minBaths" class="w-full px-3 py-2 border border-gray-300 rounded" placeholder="1">
                                </div>
                                <div>
                                    <label class="block text-gray-700 text-xs font-semibold mb-1">Min Sqft</label>
                                    <input type="number" id="minSqft" class="w-full px-3 py-2 border border-gray-300 rounded" placeholder="1000">
                                </div>
                            </div>
                            <button onclick="searchComparables()" class="w-full bg-secondary text-white py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors">
                                Research Comparables
                            </button>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-medium mb-3">Research Notes & Links</h4>
                        <div class="space-y-3">
                            <textarea id="researchNotes" class="w-full px-4 py-3 border border-gray-300 rounded-lg h-32" placeholder="Add notes about comparables, market conditions, etc."></textarea>
                            <div class="flex justify-center">
                                <button onclick="window.open('https://www.zillow.com', '_blank')" class="bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg text-sm font-medium transition-colors">
                                    Open Zillow Search
                                </button>
                            </div>
                            <div id="comparablesResults" class="bg-gray-50 rounded-lg p-4 text-sm">
                                <p class="text-gray-600">Comparable search results will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        </div>

        <!-- Assignment Fee Calculator Tab -->
        <div id="content-assignment-fee" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üí∞ Assignment Fee Calculator</h2>
                <button onclick="clearAssignmentFee()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear Calculator
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>Professional Assignment Fee Calculator:</strong> Calculate optimal assignment fees based on ARV, repair costs, and buyer profit requirements. Ensures competitive pricing while maximizing your wholesale profit margins.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column: Inputs -->
                <div class="space-y-6">
                    <!-- Property Information -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üè† Property Details</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Address</label>
                                <input type="text" id="af-property-address" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="123 Main St, City, State 12345">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">After Repair Value (ARV)</label>
                                <input type="number" id="af-arv" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="250000" onchange="calculateAssignmentFee()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Your Purchase Price</label>
                                <input type="number" id="af-purchase-price" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="150000" onchange="calculateAssignmentFee()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Estimated Repair Costs</label>
                                <input type="number" id="af-repair-costs" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="35000" onchange="calculateAssignmentFee()">
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚öôÔ∏è Advanced Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Closing Costs Override</label>
                                <div class="flex items-center space-x-3">
                                    <input type="checkbox" id="af-override-closing" onchange="calculateAssignmentFee()">
                                    <span class="text-sm text-gray-600">Override default 10% closing costs</span>
                                </div>
                                <input type="number" id="af-closing-costs-custom" class="w-full px-4 py-3 border border-gray-300 rounded-lg mt-2" placeholder="25000" disabled onchange="calculateAssignmentFee()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Buyer Profit Override</label>
                                <div class="flex items-center space-x-3">
                                    <input type="checkbox" id="af-override-profit" onchange="calculateAssignmentFee()">
                                    <span class="text-sm text-gray-600">Override auto-calculated buyer profit</span>
                                </div>
                                <input type="number" id="af-buyer-profit-custom" class="w-full px-4 py-3 border border-gray-300 rounded-lg mt-2" placeholder="30000" disabled onchange="calculateAssignmentFee()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Market Adjustment</label>
                                <select id="af-market-adjustment" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateAssignmentFee()">
                                    <option value="1.0">Normal Market</option>
                                    <option value="1.1">Hot Market (+10%)</option>
                                    <option value="1.2">Very Hot Market (+20%)</option>
                                    <option value="0.9">Slow Market (-10%)</option>
                                    <option value="0.8">Cold Market (-20%)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Results -->
                <div class="space-y-6">
                    <!-- Assignment Fee Results -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üí∞ Assignment Fee Analysis</h3>

                        <div class="text-center mb-6">
                            <div class="text-3xl font-bold text-green-600 mb-2" id="af-assignment-fee">$0</div>
                            <div class="text-sm text-gray-600">Recommended Assignment Fee</div>
                        </div>

                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Purchase Price:</span>
                                <span class="font-semibold" id="af-display-purchase">$0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Assignment Fee:</span>
                                <span class="font-semibold text-green-600" id="af-display-fee">$0</span>
                            </div>
                            <div class="border-t pt-2">
                                <div class="flex justify-between items-center font-bold">
                                    <span class="text-gray-700">Buyer Total Cost:</span>
                                    <span id="af-buyer-total">$0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Buyer Profit Analysis -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üéØ Buyer Profit Breakdown</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">After Repair Value:</span>
                                <span class="font-semibold" id="af-display-arv">$0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Buyer Purchase Cost:</span>
                                <span id="af-display-buyer-cost">$0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Repair Costs:</span>
                                <span id="af-display-repairs">$0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Closing Costs:</span>
                                <span id="af-display-closing">$0</span>
                            </div>
                            <div class="border-t pt-2">
                                <div class="flex justify-between items-center font-bold">
                                    <span class="text-gray-700">Buyer Profit:</span>
                                    <span class="text-green-600" id="af-display-buyer-profit">$0</span>
                                </div>
                            </div>
                            <div class="text-xs text-gray-500 mt-2" id="af-profit-rule">
                                Profit calculated using repair-based rules
                            </div>
                        </div>
                    </div>

                    <!-- Deal Validation -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚úÖ Deal Validation</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Deal Margin:</span>
                                <span class="font-semibold" id="af-deal-margin">0%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Your ROI:</span>
                                <span class="font-semibold" id="af-your-roi">0%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Buyer ROI:</span>
                                <span class="font-semibold" id="af-buyer-roi">0%</span>
                            </div>
                            <div class="mt-4 p-3 rounded-lg" id="af-deal-status">
                                <div class="text-sm font-semibold" id="af-status-text">Enter deal details to validate</div>
                                <div class="text-xs mt-1" id="af-status-detail">Fill in all required fields above</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Export Options -->
            <div class="mt-8 flex justify-center gap-4 flex-wrap">
                <button onclick="exportAssignmentAnalysis()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    üìÑ Export Analysis
                </button>
                <button onclick="generateBuyerPresentation()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium">
                    üìä Generate Buyer Presentation
                </button>
                <button onclick="copyAssignmentContract()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                    üìã Copy Contract Details
                </button>
            </div>

            <!-- JavaScript for Assignment Fee Calculator -->
            <script>
                function calculateAssignmentFee() {
                    // Get input values
                    const arv = parseFloat(document.getElementById('af-arv').value) || 0;
                    const purchasePrice = parseFloat(document.getElementById('af-purchase-price').value) || 0;
                    const repairCosts = parseFloat(document.getElementById('af-repair-costs').value) || 0;
                    const marketAdjustment = parseFloat(document.getElementById('af-market-adjustment').value) || 1.0;

                    // Calculate closing costs (10% of ARV by default)
                    let closingCosts;
                    if (document.getElementById('af-override-closing').checked) {
                        closingCosts = parseFloat(document.getElementById('af-closing-costs-custom').value) || 0;
                    } else {
                        closingCosts = arv * 0.10;
                    }

                    // Calculate buyer profit based on repair amount rules
                    let buyerProfit;
                    if (document.getElementById('af-override-profit').checked) {
                        buyerProfit = parseFloat(document.getElementById('af-buyer-profit-custom').value) || 0;
                    } else {
                        if (repairCosts < 30000) {
                            buyerProfit = 30000; // Under $30k repairs: $30k profit required
                        } else if (repairCosts >= 30000 && repairCosts <= 50000) {
                            buyerProfit = repairCosts; // $30k-$50k repairs: Same as repair amount
                        } else {
                            buyerProfit = 50000; // $50k+ repairs: $50k profit required
                        }
                    }

                    // Apply market adjustment to buyer profit
                    buyerProfit = buyerProfit * marketAdjustment;

                    // Calculate maximum buyer cost: ARV - Repairs - Closing Costs - Buyer Profit
                    const maxBuyerCost = arv - repairCosts - closingCosts - buyerProfit;

                    // Calculate assignment fee: Max Buyer Cost - Purchase Price
                    const assignmentFee = Math.max(0, maxBuyerCost - purchasePrice);

                    // Calculate buyer total cost
                    const buyerTotal = purchasePrice + assignmentFee;

                    // Calculate actual buyer profit with this assignment fee
                    const actualBuyerProfit = arv - buyerTotal - repairCosts - closingCosts;

                    // Calculate ROI metrics
                    const dealMargin = arv > 0 ? ((arv - buyerTotal - repairCosts - closingCosts) / arv * 100) : 0;
                    const yourROI = purchasePrice > 0 ? (assignmentFee / purchasePrice * 100) : 0;
                    const buyerROI = buyerTotal > 0 ? (actualBuyerProfit / buyerTotal * 100) : 0;

                    // Update displays
                    document.getElementById('af-assignment-fee').textContent = formatCurrency(assignmentFee);
                    document.getElementById('af-display-purchase').textContent = formatCurrency(purchasePrice);
                    document.getElementById('af-display-fee').textContent = formatCurrency(assignmentFee);
                    document.getElementById('af-buyer-total').textContent = formatCurrency(buyerTotal);

                    document.getElementById('af-display-arv').textContent = formatCurrency(arv);
                    document.getElementById('af-display-buyer-cost').textContent = formatCurrency(buyerTotal);
                    document.getElementById('af-display-repairs').textContent = formatCurrency(repairCosts);
                    document.getElementById('af-display-closing').textContent = formatCurrency(closingCosts);
                    document.getElementById('af-display-buyer-profit').textContent = formatCurrency(actualBuyerProfit);

                    document.getElementById('af-deal-margin').textContent = dealMargin.toFixed(1) + '%';
                    document.getElementById('af-your-roi').textContent = yourROI.toFixed(1) + '%';
                    document.getElementById('af-buyer-roi').textContent = buyerROI.toFixed(1) + '%';

                    // Update profit rule explanation
                    let profitRule = '';
                    if (repairCosts < 30000) {
                        profitRule = 'Under $30k repairs: $30k buyer profit required';
                    } else if (repairCosts >= 30000 && repairCosts <= 50000) {
                        profitRule = '$30k-$50k repairs: Profit equals repair amount';
                    } else {
                        profitRule = 'Over $50k repairs: $50k buyer profit required';
                    }
                    document.getElementById('af-profit-rule').textContent = profitRule;

                    // Update deal validation status
                    updateDealStatus(assignmentFee, dealMargin, buyerROI, actualBuyerProfit);
                }

                function updateDealStatus(assignmentFee, dealMargin, buyerROI, buyerProfit) {
                    const statusDiv = document.getElementById('af-deal-status');
                    const statusText = document.getElementById('af-status-text');
                    const statusDetail = document.getElementById('af-status-detail');

                    if (assignmentFee <= 0) {
                        statusDiv.className = 'mt-4 p-3 rounded-lg bg-red-100 border border-red-300';
                        statusText.textContent = '‚ùå Deal Not Viable';
                        statusDetail.textContent = 'Assignment fee is $0 or negative. Adjust purchase price or repair estimates.';
                    } else if (buyerProfit < 20000) {
                        statusDiv.className = 'mt-4 p-3 rounded-lg bg-yellow-100 border border-yellow-300';
                        statusText.textContent = '‚ö†Ô∏è Low Buyer Profit';
                        statusDetail.textContent = 'Buyer profit below $20k may be difficult to sell. Consider adjusting.';
                    } else if (dealMargin < 15) {
                        statusDiv.className = 'mt-4 p-3 rounded-lg bg-yellow-100 border border-yellow-300';
                        statusText.textContent = '‚ö†Ô∏è Tight Margins';
                        statusDetail.textContent = 'Deal margin below 15%. Ensure numbers are accurate.';
                    } else if (assignmentFee > 50000) {
                        statusDiv.className = 'mt-4 p-3 rounded-lg bg-blue-100 border border-blue-300';
                        statusText.textContent = 'üéØ High-Value Deal';
                        statusDetail.textContent = 'Excellent assignment fee! Verify ARV and repair estimates.';
                    } else {
                        statusDiv.className = 'mt-4 p-3 rounded-lg bg-green-100 border border-green-300';
                        statusText.textContent = '‚úÖ Good Deal';
                        statusDetail.textContent = 'Solid assignment fee with healthy buyer profit margins.';
                    }
                }

                function formatCurrency(amount) {
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(amount);
                }

                // Toggle custom input fields
                document.getElementById('af-override-closing').addEventListener('change', function() {
                    document.getElementById('af-closing-costs-custom').disabled = !this.checked;
                    calculateAssignmentFee();
                });

                document.getElementById('af-override-profit').addEventListener('change', function() {
                    document.getElementById('af-buyer-profit-custom').disabled = !this.checked;
                    calculateAssignmentFee();
                });

                function clearAssignmentFee() {
                    // Clear all inputs
                    const inputs = document.querySelectorAll('#content-assignment-fee input, #content-assignment-fee select');
                    inputs.forEach(input => {
                        if (input.type === 'checkbox') {
                            input.checked = false;
                        } else {
                            input.value = '';
                        }
                    });

                    // Disable custom fields
                    document.getElementById('af-closing-costs-custom').disabled = true;
                    document.getElementById('af-buyer-profit-custom').disabled = true;

                    // Reset displays
                    document.getElementById('af-assignment-fee').textContent = '$0';
                    document.getElementById('af-display-purchase').textContent = '$0';
                    document.getElementById('af-display-fee').textContent = '$0';
                    document.getElementById('af-buyer-total').textContent = '$0';
                    document.getElementById('af-display-arv').textContent = '$0';
                    document.getElementById('af-display-buyer-cost').textContent = '$0';
                    document.getElementById('af-display-repairs').textContent = '$0';
                    document.getElementById('af-display-closing').textContent = '$0';
                    document.getElementById('af-display-buyer-profit').textContent = '$0';
                    document.getElementById('af-deal-margin').textContent = '0%';
                    document.getElementById('af-your-roi').textContent = '0%';
                    document.getElementById('af-buyer-roi').textContent = '0%';
                    document.getElementById('af-profit-rule').textContent = 'Profit calculated using repair-based rules';

                    // Reset status
                    const statusDiv = document.getElementById('af-deal-status');
                    statusDiv.className = 'mt-4 p-3 rounded-lg bg-gray-100 border border-gray-300';
                    document.getElementById('af-status-text').textContent = 'Enter deal details to validate';
                    document.getElementById('af-status-detail').textContent = 'Fill in all required fields above';
                }

                function exportAssignmentAnalysis() {
                    const address = document.getElementById('af-property-address').value || 'Property Analysis';
                    const arv = document.getElementById('af-arv').value || '0';
                    const purchasePrice = document.getElementById('af-purchase-price').value || '0';
                    const repairCosts = document.getElementById('af-repair-costs').value || '0';
                    const assignmentFee = document.getElementById('af-assignment-fee').textContent;
                    const buyerProfit = document.getElementById('af-display-buyer-profit').textContent;
                    const dealMargin = document.getElementById('af-deal-margin').textContent;

                    const analysis = `ASSIGNMENT FEE ANALYSIS
Generated: ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}

PROPERTY INFORMATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Address: ${address}
After Repair Value (ARV): $${arv}
Purchase Price: $${purchasePrice}
Estimated Repair Costs: $${repairCosts}

ASSIGNMENT FEE CALCULATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Recommended Assignment Fee: ${assignmentFee}
Buyer Total Investment: ${document.getElementById('af-buyer-total').textContent}
Buyer Projected Profit: ${buyerProfit}

DEAL METRICS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Deal Margin: ${dealMargin}
Your ROI: ${document.getElementById('af-your-roi').textContent}
Buyer ROI: ${document.getElementById('af-buyer-roi').textContent}

PROFIT CALCULATION RULES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${document.getElementById('af-profit-rule').textContent}

DEAL VALIDATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Status: ${document.getElementById('af-status-text').textContent}
Notes: ${document.getElementById('af-status-detail').textContent}

BREAKDOWN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
After Repair Value: ${document.getElementById('af-display-arv').textContent}
Less: Repair Costs: ${document.getElementById('af-display-repairs').textContent}
Less: Closing Costs: ${document.getElementById('af-display-closing').textContent}
Less: Buyer Profit: ${buyerProfit}
Equals: Max Buyer Cost: ${document.getElementById('af-display-buyer-cost').textContent}
Less: Your Purchase: ${document.getElementById('af-display-purchase').textContent}
Equals: Assignment Fee: ${document.getElementById('af-display-fee').textContent}

Generated by Enriched Property Solutions LLC - Assignment Fee Calculator`;

                    const blob = new Blob([analysis], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${address.replace(/[^a-zA-Z0-9]/g, '_')}_Assignment_Analysis_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }

                function generateBuyerPresentation() {
                    const address = document.getElementById('af-property-address').value || 'Investment Property';
                    const arv = document.getElementById('af-arv').value || '0';
                    const buyerCost = document.getElementById('af-buyer-total').textContent;
                    const repairCosts = document.getElementById('af-repair-costs').value || '0';
                    const buyerProfit = document.getElementById('af-display-buyer-profit').textContent;
                    const buyerROI = document.getElementById('af-buyer-roi').textContent;

                    const presentation = `INVESTMENT OPPORTUNITY PRESENTATION
${address}

EXECUTIVE SUMMARY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Investment Property: ${address}
Total Investment Required: ${buyerCost}
Projected Profit: ${buyerProfit}
Projected ROI: ${buyerROI}

INVESTMENT BREAKDOWN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Purchase Price: ${buyerCost}
Estimated Rehab Cost: $${repairCosts}
Closing Costs: ${document.getElementById('af-display-closing').textContent}
Total Investment: ${(parseFloat(buyerCost.replace(/[$,]/g, '')) + parseFloat(repairCosts) + parseFloat(document.getElementById('af-display-closing').textContent.replace(/[$,]/g, ''))).toLocaleString('en-US', {style: 'currency', currency: 'USD', minimumFractionDigits: 0})}

PROFIT ANALYSIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
After Repair Value: $${arv}
Total Investment: ${(parseFloat(buyerCost.replace(/[$,]/g, '')) + parseFloat(repairCosts) + parseFloat(document.getElementById('af-display-closing').textContent.replace(/[$,]/g, ''))).toLocaleString('en-US', {style: 'currency', currency: 'USD', minimumFractionDigits: 0})}
Projected Profit: ${buyerProfit}
Return on Investment: ${buyerROI}

DEAL HIGHLIGHTS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚úì Profitable investment opportunity
‚úì Clear profit margins and ROI projections
‚úì Detailed cost analysis provided
‚úì Ready for immediate purchase

NEXT STEPS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
1. Review investment details
2. Conduct property inspection if desired
3. Verify repair cost estimates
4. Execute purchase agreement
5. Close on property

Contact Information: [Your contact details here]

Generated by Enriched Property Solutions LLC - Investment Opportunity Presentation`;

                    const blob = new Blob([presentation], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${address.replace(/[^a-zA-Z0-9]/g, '_')}_Buyer_Presentation_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }

                function copyAssignmentContract() {
                    const address = document.getElementById('af-property-address').value || '[Property Address]';
                    const purchasePrice = document.getElementById('af-purchase-price').value || '0';
                    const assignmentFee = document.getElementById('af-assignment-fee').textContent.replace(/[$,]/g, '');
                    const buyerTotal = document.getElementById('af-buyer-total').textContent.replace(/[$,]/g, '');

                    const contractDetails = `ASSIGNMENT CONTRACT DETAILS

Property: ${address}
Original Purchase Price: $${purchasePrice}
Assignment Fee: $${assignmentFee}
Total Buyer Investment: $${buyerTotal}

Contract Terms:
- Assignment of purchase agreement
- Assignment fee: $${assignmentFee}
- Buyer assumes all original contract terms
- Closing date: [Insert closing date]
- Earnest money: [Insert amount]

Generated: ${new Date().toLocaleDateString()}`;

                    navigator.clipboard.writeText(contractDetails).then(() => {
                        alert('Contract details copied to clipboard!');
                    }).catch(() => {
                        // Fallback for older browsers
                        const textArea = document.createElement('textarea');
                        textArea.value = contractDetails;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        alert('Contract details copied to clipboard!');
                    });
                }
            </script>
        </div>

        <!-- CSV Duplicate Finder Tab -->
        <div id="content-csv-duplicate-finder" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üîç CSV Duplicate Finder</h2>
                <button onclick="clearCSVFinder()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear All
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>Smart CSV Cross-Reference Tool:</strong> Upload two CSV files (e.g., tax delinquents & code violations) to find properties that appear in both lists. Advanced matching finds similar addresses even when data is in different columns or formats.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- File Upload Section -->
                <div class="space-y-6">
                    <!-- File 1 Upload -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üìã First CSV File</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">File Name/Description</label>
                                <input type="text" id="csv1-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="e.g., Tax Delinquents">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Upload CSV File</label>
                                <input type="file" id="csv1-file" accept=".csv" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="handleFileUpload(1)">
                            </div>
                            <div id="csv1-status" class="text-sm text-gray-500"></div>
                            <div id="csv1-preview" class="hidden">
                                <h4 class="font-semibold text-gray-700 mb-2">Preview (first 3 rows):</h4>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full text-xs border border-gray-200">
                                        <thead id="csv1-headers" class="bg-gray-50"></thead>
                                        <tbody id="csv1-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- File 2 Upload -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üìã Second CSV File</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">File Name/Description</label>
                                <input type="text" id="csv2-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="e.g., Code Violations">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Upload CSV File</label>
                                <input type="file" id="csv2-file" accept=".csv" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="handleFileUpload(2)">
                            </div>
                            <div id="csv2-status" class="text-sm text-gray-500"></div>
                            <div id="csv2-preview" class="hidden">
                                <h4 class="font-semibold text-gray-700 mb-2">Preview (first 3 rows):</h4>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full text-xs border border-gray-200">
                                        <thead id="csv2-headers" class="bg-gray-50"></thead>
                                        <tbody id="csv2-body"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Matching Settings -->
                <div class="space-y-6">
                    <!-- Match Configuration -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚öôÔ∏è Matching Settings</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Address Matching Sensitivity</label>
                                <select id="match-sensitivity" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                                    <option value="exact">Exact Match Only</option>
                                    <option value="high" selected>High Sensitivity (Recommended)</option>
                                    <option value="medium">Medium Sensitivity</option>
                                    <option value="low">Low Sensitivity (More Matches)</option>
                                </select>
                                <div class="text-xs text-gray-500 mt-1">High sensitivity finds "123 Main St" and "123 Main Street"</div>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Additional Match Fields</label>
                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="match-owner" class="mr-2" checked>
                                        <label class="text-sm text-gray-700">Match Owner Names</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" id="match-parcel" class="mr-2" checked>
                                        <label class="text-sm text-gray-700">Match Parcel/Tax IDs</label>
                                    </div>
                                    <div class="flex items-center">
                                        <input type="checkbox" id="match-zip" class="mr-2" checked>
                                        <label class="text-sm text-gray-700">Require Same ZIP Code</label>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Minimum Match Score</label>
                                <input type="range" id="match-threshold" min="60" max="100" value="80" class="w-full">
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>60% (More Matches)</span>
                                    <span id="threshold-value">80%</span>
                                    <span>100% (Exact Only)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Match Button -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <button id="find-matches-btn" onclick="findMatches()" disabled class="w-full bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700 transition-colors font-medium text-lg disabled:bg-gray-400 disabled:cursor-not-allowed">
                            üîç Find Matching Entries
                        </button>
                        <div class="text-xs text-gray-500 mt-2 text-center">Upload both CSV files to enable matching</div>
                    </div>

                    <!-- Progress -->
                    <div id="matching-progress" class="bg-white rounded-lg shadow p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚è≥ Processing...</h3>
                        <div class="w-full bg-gray-200 rounded-full h-3 mb-2">
                            <div id="progress-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                        <div id="progress-text" class="text-sm text-gray-600 text-center">Initializing...</div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results-section" class="hidden">
                <!-- Match Summary -->
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üìä Match Results</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600" id="total-matches">0</div>
                            <div class="text-sm text-gray-600">Total Matches</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600" id="high-confidence">0</div>
                            <div class="text-sm text-gray-600">High Confidence</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-yellow-600" id="medium-confidence">0</div>
                            <div class="text-sm text-gray-600">Medium Confidence</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-gray-600" id="processing-time">0s</div>
                            <div class="text-sm text-gray-600">Processing Time</div>
                        </div>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üíæ Export Options</h3>
                    <div class="flex gap-4 flex-wrap">
                        <button onclick="exportMatches('csv')" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium">
                            üìÑ Export CSV
                        </button>
                        <button onclick="exportMatches('excel')" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                            üìä Export Excel
                        </button>
                        <button onclick="exportMatches('detailed')" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                            üìã Detailed Report
                        </button>
                        <button onclick="copyMatchList()" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors font-medium">
                            üìã Copy to Clipboard
                        </button>
                    </div>
                </div>

                <!-- Matches Table -->
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">üéØ Matching Entries</h3>
                        <div class="flex gap-2">
                            <select id="confidence-filter" onchange="filterMatches()" class="px-3 py-2 border border-gray-300 rounded">
                                <option value="all">All Matches</option>
                                <option value="high">High Confidence Only</option>
                                <option value="medium">Medium+ Confidence</option>
                            </select>
                            <button onclick="toggleMatchDetails()" id="toggle-details" class="px-3 py-2 bg-gray-100 rounded hover:bg-gray-200">
                                Show Details
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table id="matches-table" class="min-w-full text-sm border border-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left">Confidence</th>
                                    <th class="px-4 py-2 text-left">Address/Property</th>
                                    <th class="px-4 py-2 text-left">File 1 Data</th>
                                    <th class="px-4 py-2 text-left">File 2 Data</th>
                                    <th class="px-4 py-2 text-left">Match Score</th>
                                </tr>
                            </thead>
                            <tbody id="matches-body">
                                <!-- Matches will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- JavaScript for CSV Duplicate Finder -->
            <script>
                let csv1Data = null;
                let csv2Data = null;
                let matchResults = [];
                let showingDetails = false;

                // Update threshold display
                document.getElementById('match-threshold').addEventListener('input', function() {
                    document.getElementById('threshold-value').textContent = this.value + '%';
                });

                function clearCSVFinder() {
                    // Clear file inputs
                    document.getElementById('csv1-file').value = '';
                    document.getElementById('csv2-file').value = '';
                    document.getElementById('csv1-name').value = '';
                    document.getElementById('csv2-name').value = '';

                    // Clear data
                    csv1Data = null;
                    csv2Data = null;
                    matchResults = [];

                    // Hide previews and results
                    document.getElementById('csv1-preview').classList.add('hidden');
                    document.getElementById('csv2-preview').classList.add('hidden');
                    document.getElementById('results-section').classList.add('hidden');
                    document.getElementById('matching-progress').classList.add('hidden');

                    // Clear status messages
                    document.getElementById('csv1-status').textContent = '';
                    document.getElementById('csv2-status').textContent = '';

                    // Disable find button
                    document.getElementById('find-matches-btn').disabled = true;
                }

                function handleFileUpload(fileNumber) {
                    const fileInput = document.getElementById(`csv${fileNumber}-file`);
                    const statusDiv = document.getElementById(`csv${fileNumber}-status`);
                    const previewDiv = document.getElementById(`csv${fileNumber}-preview`);

                    if (!fileInput.files[0]) return;

                    const file = fileInput.files[0];
                    statusDiv.textContent = 'Reading file...';

                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const csvText = e.target.result;
                            const lines = csvText.split('\n').filter(line => line.trim());

                            if (lines.length < 2) {
                                statusDiv.textContent = 'Error: File must have at least a header row and one data row';
                                statusDiv.className = 'text-sm text-red-500';
                                return;
                            }

                            // Parse CSV
                            const headers = parseCSVLine(lines[0]);
                            const rows = lines.slice(1, Math.min(lines.length, 4)).map(line => parseCSVLine(line));

                            // Store data
                            const fullData = lines.slice(1).map(line => parseCSVLine(line));
                            if (fileNumber === 1) {
                                csv1Data = { headers, data: fullData };
                            } else {
                                csv2Data = { headers, data: fullData };
                            }

                            // Show preview
                            displayPreview(fileNumber, headers, rows);
                            statusDiv.textContent = `‚úÖ Loaded ${fullData.length} rows with ${headers.length} columns`;
                            statusDiv.className = 'text-sm text-green-600';

                            // Check if both files are loaded
                            if (csv1Data && csv2Data) {
                                document.getElementById('find-matches-btn').disabled = false;
                            }

                        } catch (error) {
                            statusDiv.textContent = `Error: ${error.message}`;
                            statusDiv.className = 'text-sm text-red-500';
                        }
                    };

                    reader.readAsText(file);
                }

                function parseCSVLine(line) {
                    const result = [];
                    let current = '';
                    let inQuotes = false;

                    for (let i = 0; i < line.length; i++) {
                        const char = line[i];

                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            result.push(current.trim());
                            current = '';
                        } else {
                            current += char;
                        }
                    }

                    result.push(current.trim());
                    return result;
                }

                function displayPreview(fileNumber, headers, rows) {
                    const headersDiv = document.getElementById(`csv${fileNumber}-headers`);
                    const bodyDiv = document.getElementById(`csv${fileNumber}-body`);
                    const previewDiv = document.getElementById(`csv${fileNumber}-preview`);

                    // Clear previous content
                    headersDiv.innerHTML = '';
                    bodyDiv.innerHTML = '';

                    // Add headers
                    const headerRow = document.createElement('tr');
                    headers.forEach(header => {
                        const th = document.createElement('th');
                        th.className = 'px-2 py-1 text-left border';
                        th.textContent = header;
                        headerRow.appendChild(th);
                    });
                    headersDiv.appendChild(headerRow);

                    // Add data rows
                    rows.forEach(row => {
                        const tr = document.createElement('tr');
                        row.forEach(cell => {
                            const td = document.createElement('td');
                            td.className = 'px-2 py-1 border';
                            td.textContent = cell || '';
                            tr.appendChild(td);
                        });
                        bodyDiv.appendChild(tr);
                    });

                    previewDiv.classList.remove('hidden');
                }

                async function findMatches() {
                    if (!csv1Data || !csv2Data) {
                        alert('Please upload both CSV files first');
                        return;
                    }

                    // Show progress
                    const progressDiv = document.getElementById('matching-progress');
                    const progressBar = document.getElementById('progress-bar');
                    const progressText = document.getElementById('progress-text');
                    progressDiv.classList.remove('hidden');

                    const startTime = Date.now();
                    matchResults = [];

                    // Get settings
                    const sensitivity = document.getElementById('match-sensitivity').value;
                    const threshold = parseInt(document.getElementById('match-threshold').value);
                    const matchOwner = document.getElementById('match-owner').checked;
                    const matchParcel = document.getElementById('match-parcel').checked;
                    const matchZip = document.getElementById('match-zip').checked;

                    const totalComparisons = csv1Data.data.length * csv2Data.data.length;
                    let completed = 0;

                    progressText.textContent = 'Comparing entries...';

                    // Process in chunks to avoid blocking UI
                    for (let i = 0; i < csv1Data.data.length; i++) {
                        for (let j = 0; j < csv2Data.data.length; j++) {
                            const match = compareRows(
                                csv1Data.data[i], csv1Data.headers,
                                csv2Data.data[j], csv2Data.headers,
                                sensitivity, matchOwner, matchParcel, matchZip
                            );

                            if (match.score >= threshold) {
                                matchResults.push({
                                    ...match,
                                    file1Row: csv1Data.data[i],
                                    file2Row: csv2Data.data[j],
                                    file1Headers: csv1Data.headers,
                                    file2Headers: csv2Data.headers
                                });
                            }

                            completed++;

                            // Update progress every 100 comparisons
                            if (completed % 100 === 0) {
                                const progress = (completed / totalComparisons) * 100;
                                progressBar.style.width = progress + '%';
                                progressText.textContent = `Processed ${completed.toLocaleString()} of ${totalComparisons.toLocaleString()} comparisons...`;

                                // Allow UI to update
                                await new Promise(resolve => setTimeout(resolve, 1));
                            }
                        }
                    }

                    // Complete progress
                    progressBar.style.width = '100%';
                    const processingTime = ((Date.now() - startTime) / 1000).toFixed(1);
                    progressText.textContent = `Found ${matchResults.length} matches in ${processingTime} seconds`;

                    // Hide progress after 2 seconds and show results
                    setTimeout(() => {
                        progressDiv.classList.add('hidden');
                        displayResults(processingTime);
                    }, 2000);
                }

                function compareRows(row1, headers1, row2, headers2, sensitivity, matchOwner, matchParcel, matchZip) {
                    const matches = [];
                    let totalScore = 0;
                    let matchedFields = 0;

                    // Find address fields
                    const addressFields1 = findAddressFields(headers1);
                    const addressFields2 = findAddressFields(headers2);

                    // Compare addresses
                    for (let field1 of addressFields1) {
                        for (let field2 of addressFields2) {
                            const val1 = row1[field1.index] || '';
                            const val2 = row2[field2.index] || '';

                            if (val1 && val2) {
                                const score = calculateAddressMatch(val1, val2, sensitivity);
                                if (score > 0) {
                                    matches.push({
                                        field1: field1.name,
                                        field2: field2.name,
                                        value1: val1,
                                        value2: val2,
                                        score: score,
                                        type: 'address'
                                    });
                                    totalScore += score;
                                    matchedFields++;
                                }
                            }
                        }
                    }

                    // Compare owner names if enabled
                    if (matchOwner) {
                        const ownerFields1 = findOwnerFields(headers1);
                        const ownerFields2 = findOwnerFields(headers2);

                        for (let field1 of ownerFields1) {
                            for (let field2 of ownerFields2) {
                                const val1 = row1[field1.index] || '';
                                const val2 = row2[field2.index] || '';

                                if (val1 && val2) {
                                    const score = calculateNameMatch(val1, val2);
                                    if (score > 60) {
                                        matches.push({
                                            field1: field1.name,
                                            field2: field2.name,
                                            value1: val1,
                                            value2: val2,
                                            score: score,
                                            type: 'owner'
                                        });
                                        totalScore += score * 0.7; // Weight owner matches slightly less
                                        matchedFields++;
                                    }
                                }
                            }
                        }
                    }

                    // Compare parcel IDs if enabled
                    if (matchParcel) {
                        const parcelFields1 = findParcelFields(headers1);
                        const parcelFields2 = findParcelFields(headers2);

                        for (let field1 of parcelFields1) {
                            for (let field2 of parcelFields2) {
                                const val1 = row1[field1.index] || '';
                                const val2 = row2[field2.index] || '';

                                if (val1 && val2) {
                                    const score = calculateExactMatch(val1, val2);
                                    if (score > 90) {
                                        matches.push({
                                            field1: field1.name,
                                            field2: field2.name,
                                            value1: val1,
                                            value2: val2,
                                            score: score,
                                            type: 'parcel'
                                        });
                                        totalScore += score * 1.2; // Weight parcel matches higher
                                        matchedFields++;
                                    }
                                }
                            }
                        }
                    }

                    const avgScore = matchedFields > 0 ? totalScore / matchedFields : 0;

                    return {
                        score: Math.round(avgScore),
                        matches: matches,
                        matchedFields: matchedFields,
                        confidence: avgScore >= 90 ? 'high' : avgScore >= 75 ? 'medium' : 'low'
                    };
                }

                function findAddressFields(headers) {
                    const addressKeywords = ['address', 'addr', 'street', 'st', 'location', 'property', 'site'];
                    return headers.map((header, index) => ({ name: header, index }))
                        .filter(field => addressKeywords.some(keyword =>
                            field.name.toLowerCase().includes(keyword)));
                }

                function findOwnerFields(headers) {
                    const ownerKeywords = ['owner', 'name', 'taxpayer', 'person', 'entity'];
                    return headers.map((header, index) => ({ name: header, index }))
                        .filter(field => ownerKeywords.some(keyword =>
                            field.name.toLowerCase().includes(keyword)));
                }

                function findParcelFields(headers) {
                    const parcelKeywords = ['parcel', 'tax', 'id', 'pin', 'account', 'number'];
                    return headers.map((header, index) => ({ name: header, index }))
                        .filter(field => parcelKeywords.some(keyword =>
                            field.name.toLowerCase().includes(keyword)));
                }

                function calculateAddressMatch(addr1, addr2, sensitivity) {
                    // Normalize addresses
                    const norm1 = normalizeAddress(addr1);
                    const norm2 = normalizeAddress(addr2);

                    if (norm1 === norm2) return 100;

                    // Calculate similarity based on sensitivity
                    const similarity = calculateStringSimilarity(norm1, norm2);

                    switch (sensitivity) {
                        case 'exact':
                            return similarity >= 100 ? 100 : 0;
                        case 'high':
                            return similarity >= 85 ? similarity : 0;
                        case 'medium':
                            return similarity >= 75 ? similarity : 0;
                        case 'low':
                            return similarity >= 65 ? similarity : 0;
                        default:
                            return similarity >= 80 ? similarity : 0;
                    }
                }

                function normalizeAddress(address) {
                    return address.toLowerCase()
                        .replace(/[^\w\s]/g, ' ') // Remove punctuation
                        .replace(/\bstreet\b/g, 'st')
                        .replace(/\bavenue\b/g, 'ave')
                        .replace(/\bblvd\b/g, 'boulevard')
                        .replace(/\brd\b/g, 'road')
                        .replace(/\bdr\b/g, 'drive')
                        .replace(/\bct\b/g, 'court')
                        .replace(/\bln\b/g, 'lane')
                        .replace(/\bpl\b/g, 'place')
                        .replace(/\s+/g, ' ')
                        .trim();
                }

                function calculateNameMatch(name1, name2) {
                    const norm1 = name1.toLowerCase().replace(/[^\w\s]/g, ' ').replace(/\s+/g, ' ').trim();
                    const norm2 = name2.toLowerCase().replace(/[^\w\s]/g, ' ').replace(/\s+/g, ' ').trim();

                    return calculateStringSimilarity(norm1, norm2);
                }

                function calculateExactMatch(val1, val2) {
                    const norm1 = val1.replace(/[^\w]/g, '').toLowerCase();
                    const norm2 = val2.replace(/[^\w]/g, '').toLowerCase();

                    return norm1 === norm2 ? 100 : 0;
                }

                function calculateStringSimilarity(str1, str2) {
                    const longer = str1.length > str2.length ? str1 : str2;
                    const shorter = str1.length > str2.length ? str2 : str1;

                    if (longer.length === 0) return 100;

                    const distance = levenshteinDistance(longer, shorter);
                    return Math.round(((longer.length - distance) / longer.length) * 100);
                }

                function levenshteinDistance(str1, str2) {
                    const matrix = [];

                    for (let i = 0; i <= str2.length; i++) {
                        matrix[i] = [i];
                    }

                    for (let j = 0; j <= str1.length; j++) {
                        matrix[0][j] = j;
                    }

                    for (let i = 1; i <= str2.length; i++) {
                        for (let j = 1; j <= str1.length; j++) {
                            if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                                matrix[i][j] = matrix[i - 1][j - 1];
                            } else {
                                matrix[i][j] = Math.min(
                                    matrix[i - 1][j - 1] + 1,
                                    matrix[i][j - 1] + 1,
                                    matrix[i - 1][j] + 1
                                );
                            }
                        }
                    }

                    return matrix[str2.length][str1.length];
                }

                function displayResults(processingTime) {
                    const resultsSection = document.getElementById('results-section');

                    // Calculate statistics
                    const highConfidence = matchResults.filter(m => m.confidence === 'high').length;
                    const mediumConfidence = matchResults.filter(m => m.confidence === 'medium').length;

                    // Update summary
                    document.getElementById('total-matches').textContent = matchResults.length.toLocaleString();
                    document.getElementById('high-confidence').textContent = highConfidence.toLocaleString();
                    document.getElementById('medium-confidence').textContent = mediumConfidence.toLocaleString();
                    document.getElementById('processing-time').textContent = processingTime + 's';

                    // Populate matches table
                    populateMatchesTable();

                    resultsSection.classList.remove('hidden');
                }

                function populateMatchesTable() {
                    const tbody = document.getElementById('matches-body');
                    tbody.innerHTML = '';

                    const filter = document.getElementById('confidence-filter').value;
                    let filteredMatches = matchResults;

                    if (filter === 'high') {
                        filteredMatches = matchResults.filter(m => m.confidence === 'high');
                    } else if (filter === 'medium') {
                        filteredMatches = matchResults.filter(m => m.confidence !== 'low');
                    }

                    filteredMatches.forEach((match, index) => {
                        const tr = document.createElement('tr');
                        tr.className = index % 2 === 0 ? 'bg-gray-50' : 'bg-white';

                        // Confidence badge
                        const confidenceColor = match.confidence === 'high' ? 'bg-green-100 text-green-800' :
                                               match.confidence === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                               'bg-gray-100 text-gray-800';

                        // Find best address match
                        const addressMatch = match.matches.find(m => m.type === 'address') || match.matches[0];

                        tr.innerHTML = `
                            <td class="px-4 py-2">
                                <span class="px-2 py-1 rounded text-xs font-medium ${confidenceColor}">
                                    ${match.confidence.toUpperCase()}
                                </span>
                            </td>
                            <td class="px-4 py-2 font-medium">${addressMatch ? addressMatch.value1 : 'No address found'}</td>
                            <td class="px-4 py-2">
                                <div class="text-xs text-gray-600">${document.getElementById('csv1-name').value || 'File 1'}</div>
                                <div>${showingDetails ? formatRowDetails(match.file1Row, match.file1Headers) : formatRowSummary(match.file1Row, match.file1Headers)}</div>
                            </td>
                            <td class="px-4 py-2">
                                <div class="text-xs text-gray-600">${document.getElementById('csv2-name').value || 'File 2'}</div>
                                <div>${showingDetails ? formatRowDetails(match.file2Row, match.file2Headers) : formatRowSummary(match.file2Row, match.file2Headers)}</div>
                            </td>
                            <td class="px-4 py-2 text-center">
                                <div class="font-bold">${match.score}%</div>
                                <div class="text-xs text-gray-500">${match.matchedFields} fields</div>
                            </td>
                        `;

                        tbody.appendChild(tr);
                    });
                }

                function formatRowSummary(row, headers) {
                    // Show first 3 non-empty fields
                    const nonEmpty = row.map((val, i) => val ? `${headers[i]}: ${val}` : null)
                                       .filter(v => v)
                                       .slice(0, 3);
                    return nonEmpty.join('<br>');
                }

                function formatRowDetails(row, headers) {
                    // Show all non-empty fields
                    const nonEmpty = row.map((val, i) => val ? `${headers[i]}: ${val}` : null)
                                       .filter(v => v);
                    return nonEmpty.join('<br>');
                }

                function filterMatches() {
                    populateMatchesTable();
                }

                function toggleMatchDetails() {
                    showingDetails = !showingDetails;
                    const button = document.getElementById('toggle-details');
                    button.textContent = showingDetails ? 'Hide Details' : 'Show Details';
                    populateMatchesTable();
                }

                function exportMatches(format) {
                    if (matchResults.length === 0) {
                        alert('No matches to export');
                        return;
                    }

                    const file1Name = document.getElementById('csv1-name').value || 'File1';
                    const file2Name = document.getElementById('csv2-name').value || 'File2';

                    if (format === 'csv') {
                        exportCSV(file1Name, file2Name);
                    } else if (format === 'excel') {
                        alert('Excel export coming soon! Use CSV export for now.');
                    } else if (format === 'detailed') {
                        exportDetailedReport(file1Name, file2Name);
                    }
                }

                function exportCSV(file1Name, file2Name) {
                    const headers = ['Confidence', 'Match_Score', 'Matched_Fields'];

                    // Add file 1 headers
                    csv1Data.headers.forEach(h => headers.push(`${file1Name}_${h}`));

                    // Add file 2 headers
                    csv2Data.headers.forEach(h => headers.push(`${file2Name}_${h}`));

                    let csvContent = headers.join(',') + '\n';

                    matchResults.forEach(match => {
                        const row = [
                            match.confidence,
                            match.score,
                            match.matchedFields
                        ];

                        // Add file 1 data
                        match.file1Row.forEach(cell => row.push(`"${cell}"`));

                        // Add file 2 data
                        match.file2Row.forEach(cell => row.push(`"${cell}"`));

                        csvContent += row.join(',') + '\n';
                    });

                    downloadFile(csvContent, 'csv_matches.csv', 'text/csv');
                }

                function exportDetailedReport(file1Name, file2Name) {
                    let report = `CSV Duplicate Finder - Detailed Match Report\n`;
                    report += `Generated: ${new Date().toLocaleString()}\n`;
                    report += `File 1: ${file1Name} (${csv1Data.data.length} rows)\n`;
                    report += `File 2: ${file2Name} (${csv2Data.data.length} rows)\n`;
                    report += `Total Matches Found: ${matchResults.length}\n\n`;

                    const highConf = matchResults.filter(m => m.confidence === 'high').length;
                    const medConf = matchResults.filter(m => m.confidence === 'medium').length;
                    const lowConf = matchResults.filter(m => m.confidence === 'low').length;

                    report += `Match Quality Distribution:\n`;
                    report += `- High Confidence: ${highConf}\n`;
                    report += `- Medium Confidence: ${medConf}\n`;
                    report += `- Low Confidence: ${lowConf}\n\n`;

                    report += `DETAILED MATCHES:\n`;
                    report += `${'='.repeat(50)}\n\n`;

                    matchResults.forEach((match, index) => {
                        report += `Match #${index + 1} (${match.confidence.toUpperCase()} - ${match.score}%)\n`;
                        report += `-`.repeat(30) + '\n';

                        // Show matched fields
                        match.matches.forEach(m => {
                            report += `${m.type.toUpperCase()}: ${m.field1} = "${m.value1}" <-> ${m.field2} = "${m.value2}" (${m.score}%)\n`;
                        });

                        report += `\n${file1Name} Data:\n`;
                        match.file1Headers.forEach((header, i) => {
                            if (match.file1Row[i]) {
                                report += `  ${header}: ${match.file1Row[i]}\n`;
                            }
                        });

                        report += `\n${file2Name} Data:\n`;
                        match.file2Headers.forEach((header, i) => {
                            if (match.file2Row[i]) {
                                report += `  ${header}: ${match.file2Row[i]}\n`;
                            }
                        });

                        report += '\n' + '='.repeat(50) + '\n\n';
                    });

                    downloadFile(report, 'csv_match_report.txt', 'text/plain');
                }

                function copyMatchList() {
                    if (matchResults.length === 0) {
                        alert('No matches to copy');
                        return;
                    }

                    let text = `CSV Matches (${matchResults.length} found):\n\n`;

                    matchResults.forEach((match, index) => {
                        const addressMatch = match.matches.find(m => m.type === 'address') || match.matches[0];
                        text += `${index + 1}. ${addressMatch ? addressMatch.value1 : 'No address'} (${match.confidence} - ${match.score}%)\n`;
                    });

                    navigator.clipboard.writeText(text).then(() => {
                        alert('Match list copied to clipboard!');
                    });
                }

                function downloadFile(content, filename, mimeType) {
                    const blob = new Blob([content], { type: mimeType });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                }
            </script>
        </div>

        <!-- Address Geocoder Tab -->
        <div id="content-coming-soon-1" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üó∫Ô∏è Smart Address Geocoder</h2>
                <button onclick="clearGeocoder()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear All
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>Intelligent Address Enhancement:</strong> Fill missing ZIP codes from addresses OR find cities from ZIP codes. Perfect for cleaning property lists with incomplete address data.</p>
                <p class="text-sm text-blue-800"><strong>Important:</strong> Use the headers "First Name,Last Name,Property Address,City,State,Zip Code,County" or the tool will not work properly.</p>    
            </div>

            <!-- Mode Selection -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üìã Choose Operation Mode</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="border-2 border-blue-500 bg-blue-50 rounded-lg p-4 cursor-pointer" id="zip-mode" onclick="selectMode('zip')">
                        <div class="flex items-center mb-2">
                            <div class="w-4 h-4 border-2 border-blue-500 rounded-full mr-3 bg-blue-500"></div>
                            <h4 class="font-semibold text-gray-800">üîç Find ZIP Codes</h4>
                        </div>
                        <p class="text-sm text-gray-600">Have addresses, need ZIP codes</p>
                        <p class="text-xs text-gray-500 mt-1">Input: Street + City + State ‚Üí Output: ZIP Code</p>
                    </div>
                    <div class="border-2 border-gray-300 bg-gray-50 rounded-lg p-4 cursor-pointer" id="city-mode" onclick="selectMode('city')">
                        <div class="flex items-center mb-2">
                            <div class="w-4 h-4 border-2 border-gray-300 rounded-full mr-3"></div>
                            <h4 class="font-semibold text-gray-800">üèôÔ∏è Find Cities</h4>
                        </div>
                        <p class="text-sm text-gray-600">Have ZIP codes, need cities</p>
                        <p class="text-xs text-gray-500 mt-1">Input: ZIP Code + Street ‚Üí Output: City + State</p>
                    </div>
                    <div class="border-2 border-gray-300 bg-gray-50 rounded-lg p-4 cursor-pointer" id="county-mode" onclick="selectMode('county')">
                        <div class="flex items-center mb-2">
                            <div class="w-4 h-4 border-2 border-gray-300 rounded-full mr-3"></div>
                            <h4 class="font-semibold text-gray-800">üèòÔ∏è Find City + ZIP</h4>
                        </div>
                        <p class="text-sm text-gray-600">Have address + county, need city + ZIP</p>
                        <p class="text-xs text-gray-500 mt-1">Input: Street + County + State ‚Üí Output: City + ZIP Code</p>
                    </div>
                </div>
            </div>

            <!-- File Upload -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üìÅ Upload CSV File</h3>
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 hover:bg-gray-50 transition-all" id="upload-area">
                    <div class="text-4xl mb-4 opacity-70">üìÑ</div>
                    <h4 class="text-xl font-semibold mb-2 text-gray-800">Upload Your Property List</h4>
                    <p class="text-gray-600 mb-4" id="upload-description">Upload CSV with addresses to find ZIP codes</p>
                    <input type="file" id="geocoder-file" accept=".csv" class="hidden" onchange="handleGeocoderUpload()">
                    <button onclick="document.getElementById('geocoder-file').click()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        Browse Files
                    </button>
                </div>
                <div id="file-info" class="mt-4 hidden">
                    <div class="flex items-center justify-between bg-gray-50 p-3 rounded-lg">
                        <div>
                            <span class="font-medium text-gray-800" id="file-name"></span>
                            <span class="text-sm text-gray-500 ml-2" id="file-size"></span>
                        </div>
                        <span class="text-green-600 font-medium" id="file-rows"></span>
                    </div>
                </div>
            </div>

            <!-- Column Mapping -->
            <div id="column-mapping" class="bg-white rounded-lg shadow p-6 mb-6 hidden">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üîó Map Your Columns</h3>
                <div id="zip-mapping" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">Street Address Column</label>
                        <select id="address-col" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">City Column</label>
                        <select id="city-col" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">State Column</label>
                        <select id="state-col" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                </div>
                <div id="city-mapping" class="grid grid-cols-1 md:grid-cols-2 gap-4 hidden">
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">ZIP Code Column</label>
                        <select id="zip-col" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">Street Address Column (Optional)</label>
                        <select id="address-col-city" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                </div>
                <div id="county-mapping" class="grid grid-cols-1 md:grid-cols-3 gap-4 hidden">
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">Street Address Column</label>
                        <select id="address-col-county" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">County Column</label>
                        <select id="county-col" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-semibold mb-2">State Column</label>
                        <select id="state-col-county" class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                            <option value="">Select column...</option>
                        </select>
                    </div>
                </div>

                <!-- Preview -->
                <div class="mt-6">
                    <h4 class="font-semibold text-gray-700 mb-2">Preview (first 3 rows):</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm border border-gray-200" id="preview-table">
                            <!-- Preview content will be populated here -->
                        </table>
                    </div>
                </div>

                <!-- Process Button -->
                <div class="mt-6 text-center">
                    <button id="process-geocoding" onclick="startGeocoding()" disabled class="bg-blue-600 text-white px-8 py-4 rounded-lg hover:bg-blue-700 transition-colors font-medium text-lg disabled:bg-gray-400 disabled:cursor-not-allowed">
                        üöÄ Start Processing
                    </button>
                    <p class="text-xs text-gray-500 mt-2">Configure column mapping to enable processing</p>
                </div>
            </div>

            <!-- Processing Progress -->
            <div id="processing-section" class="bg-white rounded-lg shadow p-6 mb-6 hidden">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">‚è≥ Processing Addresses</h3>
                <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                    <div id="geocoding-progress" class="bg-blue-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="text-center mb-4">
                    <span id="progress-status" class="font-medium text-gray-700">Initializing...</span>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                    <div class="text-center p-3 bg-gray-50 rounded-lg border">
                        <div class="text-2xl font-bold text-gray-800" id="total-processed">0</div>
                        <div class="text-sm text-gray-600">Processed</div>
                    </div>
                    <div class="text-center p-3 bg-gray-50 rounded-lg border">
                        <div class="text-2xl font-bold text-green-600" id="successful-geocodes">0</div>
                        <div class="text-sm text-gray-600">Success</div>
                    </div>
                    <div class="text-center p-3 bg-gray-50 rounded-lg border">
                        <div class="text-2xl font-bold text-red-600" id="failed-geocodes">0</div>
                        <div class="text-sm text-gray-600">Failed</div>
                    </div>
                    <div class="text-center p-3 bg-gray-50 rounded-lg border">
                        <div class="text-2xl font-bold text-blue-600" id="success-rate">0%</div>
                        <div class="text-sm text-gray-600">Success Rate</div>
                    </div>
                    <div class="text-center p-3 bg-gray-50 rounded-lg border">
                        <div class="text-2xl font-bold text-purple-600" id="processing-speed">0/min</div>
                        <div class="text-sm text-gray-600">Speed</div>
                    </div>
                </div>

                <div class="mt-4 flex justify-center">
                    <button id="stop-processing" onclick="stopGeocoding()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-colors font-medium">
                        ‚èπÔ∏è Stop Processing
                    </button>
                </div>
            </div>

            <!-- Results -->
            <div id="geocoder-results-section" class="bg-white rounded-lg shadow p-6 hidden">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üìä Results Summary</h3>

                <!-- Summary Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600" id="final-success-count">0</div>
                            <div class="text-sm text-green-700">Successfully Enhanced</div>
                        </div>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-red-600" id="final-failed-count">0</div>
                            <div class="text-sm text-red-700">Could Not Enhance</div>
                        </div>
                    </div>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-blue-600" id="final-success-rate">0%</div>
                            <div class="text-sm text-blue-700">Overall Success Rate</div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Data Preview -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-3">Enhanced Data Preview:</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full text-sm border border-gray-200" id="results-preview">
                            <!-- Results preview will be populated here -->
                        </table>
                    </div>
                </div>

                <!-- Export Options -->
                <div class="flex gap-4 flex-wrap justify-center">
                    <button onclick="downloadEnhancedCSV()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium">
                        üìÑ Download Enhanced CSV
                    </button>
                    <button onclick="downloadSuccessfulOnly()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        ‚úÖ Download Successful Only
                    </button>
                    <button onclick="downloadFailedOnly()" class="bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-colors font-medium">
                        ‚ùå Download Failed Only
                    </button>
                    <button onclick="copyResultsSummary()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                        üìã Copy Summary
                    </button>
                </div>
            </div>

            <!-- JavaScript for Address Geocoder -->
            <script>
                let geocoderMode = 'zip'; // 'zip' or 'city' or 'county'
                let csvData = null;
                let headers = [];
                let processedData = [];
                let geocodingInProgress = false;
                let stopRequested = false;
                let targetColumnIndex = -1; // Track which column index we're using for results

                function selectMode(mode) {
                    geocoderMode = mode;

                    // Update UI for all three modes
                    document.getElementById('zip-mode').className = mode === 'zip' ? 'border-2 border-blue-500 bg-blue-50 rounded-lg p-4 cursor-pointer' : 'border-2 border-gray-300 bg-gray-50 rounded-lg p-4 cursor-pointer';
                    document.getElementById('city-mode').className = mode === 'city' ? 'border-2 border-blue-500 bg-blue-50 rounded-lg p-4 cursor-pointer' : 'border-2 border-gray-300 bg-gray-50 rounded-lg p-4 cursor-pointer';
                    document.getElementById('county-mode').className = mode === 'county' ? 'border-2 border-blue-500 bg-blue-50 rounded-lg p-4 cursor-pointer' : 'border-2 border-gray-300 bg-gray-50 rounded-lg p-4 cursor-pointer';

                    // Update inner circles
                    document.querySelector('#zip-mode .w-4').className = mode === 'zip' ? 'w-4 h-4 border-2 border-blue-500 rounded-full mr-3 bg-blue-500' : 'w-4 h-4 border-2 border-gray-300 rounded-full mr-3';
                    document.querySelector('#city-mode .w-4').className = mode === 'city' ? 'w-4 h-4 border-2 border-blue-500 rounded-full mr-3 bg-blue-500' : 'w-4 h-4 border-2 border-gray-300 rounded-full mr-3';
                    document.querySelector('#county-mode .w-4').className = mode === 'county' ? 'w-4 h-4 border-2 border-blue-500 rounded-full mr-3 bg-blue-500' : 'w-4 h-4 border-2 border-gray-300 rounded-full mr-3';

                    // Update upload description
                    let description = '';
                    if (mode === 'zip') {
                        description = 'Upload CSV with addresses to find ZIP codes';
                    } else if (mode === 'city') {
                        description = 'Upload CSV with ZIP codes to find cities';
                    } else if (mode === 'county') {
                        description = 'Upload CSV with address + county to find city + ZIP code';
                    }
                    document.getElementById('upload-description').textContent = description;

                    // Update column mapping visibility
                    if (csvData) {
                        updateColumnMapping();
                    }
                }

                function clearGeocoder() {
                    // Reset file input
                    document.getElementById('geocoder-file').value = '';

                    // Clear data
                    csvData = null;
                    headers = [];
                    processedData = [];

                    // Hide sections
                    document.getElementById('file-info').classList.add('hidden');
                    document.getElementById('column-mapping').classList.add('hidden');
                    document.getElementById('processing-section').classList.add('hidden');
                    document.getElementById('geocoder-results-section').classList.add('hidden');

                    // Reset mode to ZIP
                    selectMode('zip');

                    // Reset processing state
                    geocodingInProgress = false;
                    stopRequested = false;
                }

                function handleGeocoderUpload() {
                    const fileInput = document.getElementById('geocoder-file');
                    const file = fileInput.files[0];

                    if (!file) return;

                    // Show file info
                    document.getElementById('file-name').textContent = file.name;
                    document.getElementById('file-size').textContent = `(${(file.size / 1024).toFixed(1)} KB)`;
                    document.getElementById('file-info').classList.remove('hidden');

                    // Read CSV
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const csvText = e.target.result;
                            const lines = csvText.split('\n').filter(line => line.trim());

                            if (lines.length < 2) {
                                alert('CSV must have at least a header row and one data row');
                                return;
                            }

                            // Parse CSV
                            headers = parseCSVRow(lines[0]);
                            csvData = lines.slice(1).map(line => parseCSVRow(line));

                            // Update file info
                            document.getElementById('file-rows').textContent = `${csvData.length} rows`;

                            // Show column mapping
                            updateColumnMapping();
                            document.getElementById('column-mapping').classList.remove('hidden');

                        } catch (error) {
                            alert(`Error reading CSV: ${error.message}`);
                        }
                    };

                    reader.readAsText(file);
                }

                function parseCSVRow(row) {
                    const result = [];
                    let current = '';
                    let inQuotes = false;

                    for (let i = 0; i < row.length; i++) {
                        const char = row[i];

                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            result.push(current.trim());
                            current = '';
                        } else {
                            current += char;
                        }
                    }

                    result.push(current.trim());
                    return result;
                }

                function updateColumnMapping() {
                    const zipMapping = document.getElementById('zip-mapping');
                    const cityMapping = document.getElementById('city-mapping');
                    const countyMapping = document.getElementById('county-mapping');

                    // Show/hide appropriate mapping
                    if (geocoderMode === 'zip') {
                        zipMapping.classList.remove('hidden');
                        cityMapping.classList.add('hidden');
                        countyMapping.classList.add('hidden');
                        populateColumnSelects(['address-col', 'city-col', 'state-col']);
                    } else if (geocoderMode === 'city') {
                        zipMapping.classList.add('hidden');
                        cityMapping.classList.remove('hidden');
                        countyMapping.classList.add('hidden');
                        populateColumnSelects(['zip-col', 'address-col-city']);
                    } else if (geocoderMode === 'county') {
                        zipMapping.classList.add('hidden');
                        cityMapping.classList.add('hidden');
                        countyMapping.classList.remove('hidden');
                        populateColumnSelects(['address-col-county', 'county-col', 'state-col-county']);
                    }

                    updatePreview();
                    checkProcessingReady();
                }

                function populateColumnSelects(selectIds) {
                    selectIds.forEach(selectId => {
                        const select = document.getElementById(selectId);
                        select.innerHTML = '<option value="">Select column...</option>';

                        headers.forEach((header, index) => {
                            const option = document.createElement('option');
                            option.value = index;
                            option.textContent = header;
                            select.appendChild(option);
                        });

                        // Add change listener
                        select.onchange = () => {
                            updatePreview();
                            checkProcessingReady();
                        };
                    });
                }

                function updatePreview() {
                    const previewTable = document.getElementById('preview-table');

                    // Clear previous content
                    previewTable.innerHTML = '';

                    // Create header row
                    const headerRow = document.createElement('tr');
                    headerRow.className = 'bg-gray-50';
                    headers.forEach(header => {
                        const th = document.createElement('th');
                        th.className = 'px-3 py-2 text-left border font-medium';
                        th.textContent = header;
                        headerRow.appendChild(th);
                    });
                    previewTable.appendChild(headerRow);

                    // Add first 3 data rows
                    csvData.slice(0, 3).forEach(row => {
                        const tr = document.createElement('tr');
                        row.forEach(cell => {
                            const td = document.createElement('td');
                            td.className = 'px-3 py-2 border text-sm';
                            td.textContent = cell || '';
                            tr.appendChild(td);
                        });
                        previewTable.appendChild(tr);
                    });
                }

                function checkProcessingReady() {
                    const processBtn = document.getElementById('process-geocoding');

                    if (geocoderMode === 'zip') {
                        const addressCol = document.getElementById('address-col').value;
                        const cityCol = document.getElementById('city-col').value;
                        const stateCol = document.getElementById('state-col').value;

                        processBtn.disabled = !(addressCol && cityCol && stateCol);
                    } else if (geocoderMode === 'city') {
                        const zipCol = document.getElementById('zip-col').value;
                        processBtn.disabled = !zipCol;
                    } else if (geocoderMode === 'county') {
                        const addressCol = document.getElementById('address-col-county').value;
                        const countyCol = document.getElementById('county-col').value;
                        const stateCol = document.getElementById('state-col-county').value;

                        processBtn.disabled = !(addressCol && countyCol && stateCol);
                    }
                }

                async function startGeocoding() {
                    if (geocodingInProgress) return;

                    geocodingInProgress = true;
                    stopRequested = false;
                    processedData = [];

                    // Show processing section
                    document.getElementById('processing-section').classList.remove('hidden');
                    document.getElementById('geocoder-results-section').classList.add('hidden');

                    // Initialize progress
                    updateProgress(0, 0, 0, 0);

                    const startTime = Date.now();

                    try {
                        if (geocoderMode === 'zip') {
                            await processZipCodeLookup();
                        } else if (geocoderMode === 'city') {
                            await processCityLookup();
                        } else if (geocoderMode === 'county') {
                            await processCountyLookup();
                        }
                    } catch (error) {
                        console.error('Geocoding error:', error);
                        alert(`Processing error: ${error.message}`);
                    }

                    // Complete processing
                    geocodingInProgress = false;
                    document.getElementById('processing-section').classList.add('hidden');
                    showResults();
                }

                async function processZipCodeLookup() {
                    const addressCol = parseInt(document.getElementById('address-col').value);
                    const cityCol = parseInt(document.getElementById('city-col').value);
                    const stateCol = parseInt(document.getElementById('state-col').value);

                    console.log('ZIP processing started:', { addressCol, cityCol, stateCol, dataLength: csvData.length });

                    // Find existing ZIP column or determine where to add new one
                    let zipCol = -1;
                    const zipPatterns = ['zip', 'zipcode', 'zip code', 'postal', 'postal code'];
                    for (let i = 0; i < headers.length; i++) {
                        if (zipPatterns.some(pattern => headers[i].toLowerCase().includes(pattern))) {
                            zipCol = i;
                            break;
                        }
                    }

                    // If no ZIP column exists, add one
                    if (zipCol === -1) {
                        zipCol = headers.length;
                        headers.push('ZIP_Code');
                        console.log('Added new ZIP_Code column at index:', zipCol);
                    } else {
                        console.log('Using existing ZIP column at index:', zipCol, 'Column name:', headers[zipCol]);
                    }

                    // Store the target column index for success checking
                    targetColumnIndex = zipCol;

                    let successful = 0;
                    let failed = 0;

                    for (let i = 0; i < csvData.length; i++) {
                        if (stopRequested) break;

                        const row = [...csvData[i]];
                        const address = row[addressCol] || '';
                        const city = row[cityCol] || '';
                        const state = row[stateCol] || '';

                        // Ensure row has enough columns
                        while (row.length <= zipCol) {
                            row.push('');
                        }

                        try {
                            const zipCode = await lookupZipCode(address, city, state);
                            console.log(`ZIP Row ${i} success:`, `Address: "${address}", City: "${city}", State: "${state}", Result: "${zipCode}"`);
                            row[zipCol] = zipCode; // Update existing column instead of pushing new
                            successful++;
                        } catch (error) {
                            console.log(`ZIP Row ${i} failed:`, `Address: "${address}", City: "${city}", State: "${state}", Error: "${error.message}"`);
                            row[zipCol] = ''; // Update existing column instead of pushing new
                            failed++;
                        }

                        processedData.push(row);
                        console.log(`ZIP Row ${i} processed:`, { row, length: row.length });
                        updateProgress(i + 1, successful, failed, csvData.length);

                        // Rate limiting - don't overwhelm the service
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }

                    console.log('ZIP processing completed:', { successful, failed, processedDataLength: processedData.length });
                }

                async function processCityLookup() {
                    const zipCol = parseInt(document.getElementById('zip-col').value);
                    const addressColCity = document.getElementById('address-col-city').value;
                    const addressCol = addressColCity ? parseInt(addressColCity) : null;

                    // Find existing city column
                    let cityCol = -1;
                    const cityPatterns = ['city', 'town', 'municipality'];
                    for (let i = 0; i < headers.length; i++) {
                        if (cityPatterns.some(pattern => headers[i].toLowerCase().includes(pattern))) {
                            cityCol = i;
                            break;
                        }
                    }

                    // Find existing state column
                    let stateCol = -1;
                    const statePatterns = ['state', 'st', 'province'];
                    for (let i = 0; i < headers.length; i++) {
                        if (statePatterns.some(pattern => headers[i].toLowerCase().includes(pattern))) {
                            stateCol = i;
                            break;
                        }
                    }

                    // Add columns if they don't exist
                    if (cityCol === -1) {
                        cityCol = headers.length;
                        headers.push('City');
                        console.log('Added new City column at index:', cityCol);
                    } else {
                        console.log('Using existing City column at index:', cityCol, 'Column name:', headers[cityCol]);
                    }

                    if (stateCol === -1) {
                        stateCol = headers.length;
                        headers.push('State');
                        console.log('Added new State column at index:', stateCol);
                    } else {
                        console.log('Using existing State column at index:', stateCol, 'Column name:', headers[stateCol]);
                    }

                    // Store target column indexes for success checking (city is primary for this mode)
                    targetColumnIndex = cityCol;

                    let successful = 0;
                    let failed = 0;

                    for (let i = 0; i < csvData.length; i++) {
                        if (stopRequested) break;

                        const row = [...csvData[i]];
                        const zipCode = row[zipCol] || '';
                        const address = addressCol ? (row[addressCol] || '') : '';

                        // Ensure row has enough columns
                        while (row.length <= Math.max(cityCol, stateCol)) {
                            row.push('');
                        }

                        try {
                            const location = await lookupCityState(zipCode, address);
                            row[cityCol] = location.city;
                            row[stateCol] = location.state;
                            successful++;
                        } catch (error) {
                            row[cityCol] = '';
                            row[stateCol] = '';
                            failed++;
                        }

                        processedData.push(row);
                        updateProgress(i + 1, successful, failed, csvData.length);

                        // Rate limiting
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                }

                async function processCountyLookup() {
                    const addressCol = parseInt(document.getElementById('address-col-county').value);
                    const countyCol = parseInt(document.getElementById('county-col').value);
                    const stateColCounty = parseInt(document.getElementById('state-col-county').value);

                    console.log('County processing started:', { addressCol, countyCol, stateColCounty, dataLength: csvData.length });

                    // Find existing city column
                    let cityCol = -1;
                    const cityPatterns = ['city', 'town', 'municipality'];
                    for (let i = 0; i < headers.length; i++) {
                        if (cityPatterns.some(pattern => headers[i].toLowerCase().includes(pattern))) {
                            cityCol = i;
                            break;
                        }
                    }

                    // Find existing ZIP column
                    let zipCol = -1;
                    const zipPatterns = ['zip', 'zipcode', 'zip code', 'postal', 'postal code'];
                    for (let i = 0; i < headers.length; i++) {
                        if (zipPatterns.some(pattern => headers[i].toLowerCase().includes(pattern))) {
                            zipCol = i;
                            break;
                        }
                    }

                    // Add columns if they don't exist
                    if (cityCol === -1) {
                        cityCol = headers.length;
                        headers.push('City');
                        console.log('Added new City column at index:', cityCol);
                    } else {
                        console.log('Using existing City column at index:', cityCol, 'Column name:', headers[cityCol]);
                    }

                    if (zipCol === -1) {
                        zipCol = headers.length;
                        headers.push('ZIP_Code');
                        console.log('Added new ZIP_Code column at index:', zipCol);
                    } else {
                        console.log('Using existing ZIP column at index:', zipCol, 'Column name:', headers[zipCol]);
                    }

                    // Store target column indexes for success checking (both city and ZIP for county mode)
                    targetColumnIndex = zipCol; // Use ZIP as primary for success checking

                    let successful = 0;
                    let failed = 0;

                    for (let i = 0; i < csvData.length; i++) {
                        if (stopRequested) break;

                        const row = [...csvData[i]];
                        const address = row[addressCol] || '';
                        const county = row[countyCol] || '';
                        const state = row[stateColCounty] || '';

                        console.log(`Processing row ${i}:`, { address, county, state });

                        // Ensure row has enough columns
                        while (row.length <= Math.max(cityCol, zipCol)) {
                            row.push('');
                        }

                        try {
                            const location = await lookupCityZipFromCounty(address, county, state);
                            console.log(`Row ${i} success:`, location);
                            row[cityCol] = location.city;
                            row[zipCol] = location.zipCode;
                            successful++;
                        } catch (error) {
                            console.log(`Row ${i} failed:`, error.message);
                            row[cityCol] = '';
                            row[zipCol] = '';
                            failed++;
                        }

                        processedData.push(row);
                        updateProgress(i + 1, successful, failed, csvData.length);

                        // Rate limiting
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }

                    console.log('County processing completed:', { successful, failed, processedDataLength: processedData.length });
                }

                function updateProgress(processed, successful, failed, total) {
                    const percentage = total > 0 ? (processed / total) * 100 : 0;
                    const successRate = processed > 0 ? (successful / processed) * 100 : 0;

                    document.getElementById('geocoding-progress').style.width = percentage + '%';
                    document.getElementById('progress-status').textContent = `Processing ${processed} of ${total}...`;
                    document.getElementById('total-processed').textContent = processed.toLocaleString();
                    document.getElementById('successful-geocodes').textContent = successful.toLocaleString();
                    document.getElementById('failed-geocodes').textContent = failed.toLocaleString();
                    document.getElementById('success-rate').textContent = successRate.toFixed(1) + '%';

                    // Calculate speed (per minute)
                    const timeElapsed = (Date.now() - window.geocodingStartTime) / 1000 / 60; // minutes
                    const speed = timeElapsed > 0 ? Math.round(processed / timeElapsed) : 0;
                    document.getElementById('processing-speed').textContent = speed + '/min';
                }

                function stopGeocoding() {
                    stopRequested = true;
                    document.getElementById('progress-status').textContent = 'Stopping...';
                }

                // Real geocoding functions using actual APIs
                async function lookupZipCode(address, city, state) {
                    // Skip Census Bureau API for localhost (CORS blocked)
                    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                        console.log('Skipping Census API due to CORS restrictions on localhost');
                    } else {
                        // Try Census Bureau first (only when not on localhost)
                        try {
                            const censusResult = await geocodeWithCensus(address, city, state);
                            if (censusResult) return censusResult;
                        } catch (e) {
                            console.log('Census API failed:', e.message);
                        }
                    }

                    // Try Nominatim (usually works from localhost)
                    try {
                        const nominatimResult = await geocodeWithNominatim(address, city, state);
                        if (nominatimResult) return nominatimResult;
                    } catch (e) {
                        console.log('Nominatim API failed:', e.message);
                    }

                    return null;
                }

                async function geocodeWithCensus(address, city, state) {
                    const fullAddress = `${address}, ${city}, ${state}`;
                    const url = `https://geocoding.geo.census.gov/geocoder/locations/onelineaddress?address=${encodeURIComponent(fullAddress)}&benchmark=Public_AR_Current&format=json`;

                    try {
                        const response = await fetch(url, {
                            mode: 'cors',
                            headers: {
                                'Accept': 'application/json',
                            }
                        });
                        if (!response.ok) throw new Error('Census API failed');
                    } catch (corsError) {
                        console.log('Census API CORS blocked, skipping');
                        throw new Error('Census API blocked by CORS');
                    }

                    const data = await response.json();
                    if (data?.result?.addressMatches?.length > 0) {
                        const match = data.result.addressMatches[0];
                        const zip = match.addressComponents?.zip;
                        if (zip) return zip.substring(0, 5);
                    }

                    return null;
                }

                async function geocodeWithNominatim(address, city, state) {
                    const fullAddress = `${address}, ${city}, ${state}, United States`;
                    const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(fullAddress)}&format=json&addressdetails=1&limit=1&countrycodes=us`;

                    const response = await fetch(url);
                    if (!response.ok) throw new Error('Nominatim API failed');

                    const data = await response.json();
                    if (data?.length > 0) {
                        const postcode = data[0].address?.postcode;
                        if (postcode) {
                            const zip = postcode.split('-')[0];
                            if (zip.length === 5 && /^\d{5}$/.test(zip)) {
                                return zip;
                            }
                        }
                    }

                    return null;
                }

                async function lookupCityState(zipCode, address) {
                    // Try reverse geocoding with ZIPPOPOTAM.US API
                    try {
                        const response = await fetch(`https://api.zippopotam.us/us/${zipCode}`);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.places && data.places.length > 0) {
                                const place = data.places[0];
                                return {
                                    city: place['place name'],
                                    state: place['state abbreviation']
                                };
                            }
                        }
                    } catch (e) {
                        console.log('Zippopotam API failed:', e.message);
                    }

                    // Fallback: Try GeoNames API if available
                    try {
                        const response = await fetch(`http://api.geonames.org/postalCodeLookupJSON?postalcode=${zipCode}&country=US&username=demo`);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.postalcodes && data.postalcodes.length > 0) {
                                const postal = data.postalcodes[0];
                                return {
                                    city: postal.placeName,
                                    state: postal.adminCode1
                                };
                            }
                        }
                    } catch (e) {
                        console.log('GeoNames API failed:', e.message);
                    }

                    return null;
                }

                async function lookupCityZipFromCounty(address, county, state) {
                    // Try to geocode using county information
                    // First attempt: combine address with county and state
                    try {
                        const countyAddress = `${address}, ${county}, ${state}`;
                        const result = await geocodeWithCensus(countyAddress, '', '');
                        if (result) {
                            // Get city info from reverse geocoding
                            try {
                                const cityState = await lookupCityState(result, address);
                                return {
                                    city: cityState.city,
                                    zipCode: result
                                };
                            } catch (e) {
                                // If reverse lookup fails, try to extract city from address
                                const addressParts = address.split(',');
                                const potentialCity = addressParts.length > 1 ? addressParts[addressParts.length - 1].trim() : 'Unknown';
                                return {
                                    city: potentialCity,
                                    zipCode: result
                                };
                            }
                        }
                    } catch (e) {
                        console.log('County geocoding with Census failed:', e.message);
                    }

                    // Second attempt: Try with Nominatim using county
                    try {
                        const countyAddress = `${address}, ${county}, ${state}, United States`;
                        const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(countyAddress)}&format=json&addressdetails=1&limit=1&countrycodes=us`;

                        const response = await fetch(url);
                        if (response.ok) {
                            const data = await response.json();
                            if (data?.length > 0) {
                                const result = data[0];
                                const postcode = result.address?.postcode;
                                const city = result.address?.city || result.address?.town || result.address?.village;

                                if (postcode && city) {
                                    const zip = postcode.split('-')[0];
                                    if (zip.length === 5 && /^\d{5}$/.test(zip)) {
                                        return {
                                            city: city,
                                            zipCode: zip
                                        };
                                    }
                                }
                            }
                        }
                    } catch (e) {
                        console.log('County geocoding with Nominatim failed:', e.message);
                    }

                    // Fallback: Try to extract city from address and use a default ZIP
                    const addressParts = address.split(',');
                    if (addressParts.length > 1) {
                        const potentialCity = addressParts[addressParts.length - 1].trim();
                        return {
                            city: potentialCity,
                            zipCode: '00000'
                        };
                    }

                    return null;
                }

                function showResults() {
                    console.log('showResults called:', {
                        geocoderMode,
                        processedDataLength: processedData.length,
                        processedData: processedData,
                        headers: headers
                    });

                    const successful = processedData.filter(row => {
                        let isSuccessful = false;
                        if (geocoderMode === 'zip') {
                            // Use the actual target column index instead of assuming last column
                            isSuccessful = targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        } else if (geocoderMode === 'city') {
                            // For city mode, check the target column (which is city column)
                            isSuccessful = targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        } else if (geocoderMode === 'county') {
                            // For county mode, check the target column (which is ZIP column)
                            isSuccessful = targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        }

                        console.log('Row success check:', `Mode: ${geocoderMode}, TargetCol: ${targetColumnIndex}, Value: "${targetColumnIndex >= 0 ? row[targetColumnIndex] : 'N/A'}", Success: ${isSuccessful}`);

                        return isSuccessful;
                    }).length;

                    console.log('Success calculation:', `Total: ${processedData.length}, Successful: ${successful}, Failed: ${processedData.length - successful}`);

                    const failed = processedData.length - successful;
                    const successRate = processedData.length > 0 ? (successful / processedData.length) * 100 : 0;

                    // Update summary stats
                    document.getElementById('final-success-count').textContent = successful.toLocaleString();
                    document.getElementById('final-failed-count').textContent = failed.toLocaleString();
                    document.getElementById('final-success-rate').textContent = successRate.toFixed(1) + '%';

                    // Update results preview
                    console.log('Calling updateResultsPreview...');
                    updateResultsPreview();

                    // Show results section
                    console.log('Making results section visible...');
                    const resultsSection = document.getElementById('geocoder-results-section');
                    console.log('Results section element:', resultsSection);
                    resultsSection.classList.remove('hidden');
                    console.log('Results section classes after show:', resultsSection.className);
                }

                function updateResultsPreview() {
                    console.log('updateResultsPreview called');
                    const previewTable = document.getElementById('results-preview');
                    console.log('Preview table element:', previewTable);
                    if (!previewTable) {
                        console.error('ERROR: results-preview table element not found!');
                        return;
                    }
                    previewTable.innerHTML = '';
                    console.log('Table cleared, building preview...');

                    // Create header row
                    console.log('Creating header row with headers:', headers);
                    const headerRow = document.createElement('tr');
                    headerRow.className = 'bg-gray-50';
                    headers.forEach(header => {
                        const th = document.createElement('th');
                        th.className = 'px-3 py-2 text-left border font-medium text-xs';
                        th.textContent = header;
                        headerRow.appendChild(th);
                    });
                    previewTable.appendChild(headerRow);
                    console.log('Header row added to table');

                    // Add first 5 processed rows
                    console.log('Adding data rows:', processedData.slice(0, 5));
                    processedData.slice(0, 5).forEach((row, rowIndex) => {
                        console.log(`Building row ${rowIndex}:`, row);
                        const tr = document.createElement('tr');
                        row.forEach((cell, index) => {
                            const td = document.createElement('td');
                            td.className = 'px-3 py-2 border text-xs';
                            td.textContent = cell || '';

                            // Highlight new columns
                            if (index >= headers.length - (geocoderMode === 'zip' ? 1 : 2)) {
                                td.className += ' bg-green-50 font-semibold';
                            }

                            tr.appendChild(td);
                        });
                        previewTable.appendChild(tr);
                        console.log(`Row ${rowIndex} added to table`);
                    });
                    console.log('updateResultsPreview completed successfully');
                }

                function downloadEnhancedCSV() {
                    downloadCSV(processedData, 'enhanced_addresses.csv');
                }

                function downloadSuccessfulOnly() {
                    const successful = processedData.filter(row => {
                        if (geocoderMode === 'zip') {
                            return targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        } else {
                            // For city and county modes, use target column
                            return targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        }
                    });
                    downloadCSV(successful, 'successful_geocodes.csv');
                }

                function downloadFailedOnly() {
                    const failed = processedData.filter(row => {
                        if (geocoderMode === 'zip') {
                            return targetColumnIndex < 0 || !row[targetColumnIndex] || row[targetColumnIndex] === '';
                        } else {
                            // For city and county modes, use target column
                            return targetColumnIndex < 0 || !row[targetColumnIndex] || row[targetColumnIndex] === '';
                        }
                    });
                    downloadCSV(failed, 'failed_geocodes.csv');
                }

                function downloadCSV(data, filename) {
                    let csvContent = headers.join(',') + '\n';
                    data.forEach(row => {
                        csvContent += row.map(cell => `"${cell}"`).join(',') + '\n';
                    });

                    const blob = new Blob([csvContent], { type: 'text/csv' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                }

                function copyResultsSummary() {
                    const successful = processedData.filter(row => {
                        if (geocoderMode === 'zip') {
                            return targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        } else {
                            // For city and county modes, use target column
                            return targetColumnIndex >= 0 && row[targetColumnIndex] && row[targetColumnIndex] !== '';
                        }
                    }).length;

                    const failed = processedData.length - successful;
                    const successRate = processedData.length > 0 ? (successful / processedData.length) * 100 : 0;

                    const summary = `Address Geocoding Results:

Mode: ${geocoderMode === 'zip' ? 'ZIP Code Lookup' : 'City Lookup'}
Total Processed: ${processedData.length.toLocaleString()}
Successful: ${successful.toLocaleString()}
Failed: ${failed.toLocaleString()}
Success Rate: ${successRate.toFixed(1)}%

Generated by Enriched Property Solutions LLC - Address Geocoder`;

                    navigator.clipboard.writeText(summary).then(() => {
                        alert('Results summary copied to clipboard!');
                    });
                }

                // Initialize
                window.geocodingStartTime = Date.now();

                // Tab switching functionality
                window.switchTab = function(tabName) {
                    // Hide all content areas
                    const contentAreas = document.querySelectorAll('.tab-content');
                    contentAreas.forEach(area => {
                        area.classList.add('hidden');
                    });

                    // Remove active state from all tabs
                    const tabs = document.querySelectorAll('[id^="tab-"]');
                    tabs.forEach(tab => {
                        tab.classList.remove('tab-active');
                        tab.classList.add('tab-inactive');
                    });

                    // Show selected content area
                    const selectedContent = document.getElementById(`content-${tabName}`);
                    if (selectedContent) {
                        selectedContent.classList.remove('hidden');
                    }

                    // Add active state to selected tab
                    const selectedTab = document.getElementById(`tab-${tabName}`);
                    if (selectedTab) {
                        selectedTab.classList.remove('tab-inactive');
                        selectedTab.classList.add('tab-active');
                    }
                }

                // Initialize with first tab active on page load
                document.addEventListener('DOMContentLoaded', function() {
                    window.switchTab('deal-analysis');
                });
            </script>
        </div>

        <div id="content-coming-soon-2" class="tab-content hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">AI Property Assessment & Prompt Generator</h2>
                <p class="text-gray-600">Fill out this comprehensive property assessment form to generate an AI-ready prompt and get accurate repair cost estimates.</p>
            </div>

            <!-- AI Property Assessment & Prompt Generator -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                    <!-- Property Details -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Property Details</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Square Footage</label>
                            <input type="number" id="aiSqft" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="1500" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Year Built</label>
                            <input type="number" id="aiYearBuilt" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="1995" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Number of Stories</label>
                            <input type="number" id="aiStories" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="2" min="1" max="4" onchange="updateAICalculator()">
                        </div>
                    </div>

                    <!-- Room Counts -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Room Counts</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Bedrooms Needing Repair</label>
                            <input type="number" id="aiBedrooms" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="3" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Bathrooms Needing Repair</label>
                            <input type="number" step="0.5" id="aiBathrooms" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="2.5" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Windows Needing Replacement</label>
                            <input type="number" id="aiWindows" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="12" min="0" onchange="updateAICalculator()">
                        </div>
                    </div>

                    <!-- Major Systems -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Major Systems</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">HVAC Units Needing Repair/Replace</label>
                            <input type="number" id="aiHvacUnits" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="2" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Water Heaters Needing Replace</label>
                            <input type="number" id="aiWaterHeaters" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="1" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Electrical Panels Needing Update</label>
                            <input type="number" id="aiElectricalPanels" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="1" min="0" onchange="updateAICalculator()">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <!-- Structural & Exterior -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Structural & Exterior</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Roof Repair Percentage (%)</label>
                            <input type="number" id="aiRoofPercent" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="25" min="0" max="100" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Foundation Issues (Linear Feet)</label>
                            <input type="number" id="aiFoundationFeet" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="50" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Siding Repair (Sq Ft)</label>
                            <input type="number" id="aiSidingSqft" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="200" min="0" onchange="updateAICalculator()">
                        </div>
                    </div>

                    <!-- Interior -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Interior</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Flooring Replacement (Sq Ft)</label>
                            <input type="number" id="aiFlooringSqft" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="800" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Interior Paint (Rooms)</label>
                            <input type="number" id="aiPaintRooms" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="8" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Doors Needing Replace</label>
                            <input type="number" id="aiDoors" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="6" min="0" onchange="updateAICalculator()">
                        </div>
                    </div>

                    <!-- Appliances & Fixtures -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Appliances & Fixtures</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Kitchen Appliances Needed</label>
                            <input type="number" id="aiAppliances" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="4" min="0" max="10" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Light Fixtures Needing Replace</label>
                            <input type="number" id="aiLightFixtures" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="8" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Plumbing Fixtures Needing Replace</label>
                            <input type="number" id="aiPlumbingFixtures" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="5" min="0" onchange="updateAICalculator()">
                        </div>
                    </div>

                    <!-- Outdoor & Other -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Outdoor & Other</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Deck/Patio Repair (Sq Ft)</label>
                            <input type="number" id="aiDeckSqft" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="300" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Landscaping Areas (Sq Ft)</label>
                            <input type="number" id="aiLandscapingSqft" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="500" min="0" onchange="updateAICalculator()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Garage Door Repair/Replace</label>
                            <input type="number" id="aiGarageDoors" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="1" min="0" max="3" onchange="updateAICalculator()">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- AI Prompt Output -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-3">üéØ Generated AI Prompt</h4>
                        <textarea id="aiPromptOutput" class="w-full h-32 px-3 py-2 border border-gray-300 rounded-md text-sm bg-white" readonly placeholder="Fill out the assessment form to generate an AI-ready prompt..."></textarea>
                        <div class="mt-3 flex space-x-2">
                            <button onclick="copyAIPrompt()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors text-sm">Copy Prompt</button>
                            <a href="#" id="chatGPTLink" target="_blank" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors text-sm no-underline">Send to ChatGPT</a>
                        </div>
                    </div>

                    <!-- Smart Calculator Results -->
                    <div class="bg-green-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-3">üßÆ Smart Repair Calculator</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Structural & Exterior:</span>
                                <span class="font-medium" id="aiStructuralCost">$0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Interior Repairs:</span>
                                <span class="font-medium" id="aiInteriorCost">$0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Systems & Mechanical:</span>
                                <span class="font-medium" id="aiSystemsCost">$0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Appliances & Fixtures:</span>
                                <span class="font-medium" id="aiAppliancesCost">$0</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Labor & Permits:</span>
                                <span class="font-medium" id="aiLaborCost">$0</span>
                            </div>
                            <hr class="my-2">
                            <div class="flex justify-between">
                                <span class="font-semibold">Subtotal:</span>
                                <span class="font-semibold" id="aiSubtotal">$0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Contingency (15%):</span>
                                <span class="font-semibold" id="aiContingency">$0</span>
                            </div>
                            <hr class="my-2 border-gray-400">
                            <div class="flex justify-between text-lg">
                                <span class="font-bold text-green-800">Total Estimate:</span>
                                <span class="font-bold text-green-800" id="aiTotalEstimate">$0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="content-contracts-generator" class="tab-content hidden">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">üìÑ Real Estate Contract Generator</h2>
                <p class="text-gray-600">Generate professional Purchase & Sale Agreements and Assignment of Contract documents</p>
            </div>

            <!-- Important Legal Disclaimer -->
            <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <svg class="w-5 h-5 text-red-400 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-red-800">Legal Disclaimer</h3>
                        <p class="text-sm text-red-700 mt-1">
                            <strong>FOR EXAMPLE PURPOSES ONLY!</strong> Always seek the advice of a real estate attorney in your state before using any contract. This tool generates example documents only.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Contract Type Selection -->
            <div class="mb-6 bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-4">Select Contract Type</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="border rounded-lg p-4 cursor-pointer hover:bg-gray-50 transition-colors" onclick="selectContract('purchase')" id="purchase-card">
                        <div class="flex items-center mb-2">
                            <input type="radio" name="contractType" value="purchase" id="purchase-radio" class="mr-3">
                            <h4 class="font-medium">Purchase and Sale Agreement</h4>
                        </div>
                        <p class="text-sm text-gray-600">Contract between buyer and seller for property purchase</p>
                    </div>
                    <div class="border rounded-lg p-4 cursor-pointer hover:bg-gray-50 transition-colors" onclick="selectContract('assignment')" id="assignment-card">
                        <div class="flex items-center mb-2">
                            <input type="radio" name="contractType" value="assignment" id="assignment-radio" class="mr-3">
                            <h4 class="font-medium">Assignment of Contract</h4>
                        </div>
                        <p class="text-sm text-gray-600">Assign purchase rights to another buyer (wholesaling)</p>
                    </div>
                </div>
            </div>

            <!-- Purchase and Sale Agreement Form -->
            <div id="purchase-form" class="hidden bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-6">Purchase and Sale Agreement Details</h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Left Column -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Contract Date & Parties</h4>

                        <div class="grid grid-cols-3 gap-2">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Day</label>
                                <input type="number" id="contractDay" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="15" min="1" max="31">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Month</label>
                                <select id="contractMonth" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                    <option value="">Month</option>
                                    <option value="January">January</option>
                                    <option value="February">February</option>
                                    <option value="March">March</option>
                                    <option value="April">April</option>
                                    <option value="May">May</option>
                                    <option value="June">June</option>
                                    <option value="July">July</option>
                                    <option value="August">August</option>
                                    <option value="September">September</option>
                                    <option value="October">October</option>
                                    <option value="November">November</option>
                                    <option value="December">December</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Year</label>
                                <input type="number" id="contractYear" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="2025" min="2020" max="2030">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Seller(s)</label>
                            <input type="text" id="sellers" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="John Doe and Jane Doe">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Buyer(s)</label>
                            <input type="text" id="buyers" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="ABC Investments LLC">
                        </div>

                        <h4 class="font-medium text-gray-900 border-b pb-2 mt-6">Property Information</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Street Address</label>
                            <input type="text" id="streetAddress" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="123 Main Street">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">City, State, Zip</label>
                            <input type="text" id="cityStateZip" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="Dallas, TX 75001">
                        </div>

                    </div>

                    <!-- Right Column -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Financial Terms</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Total Deposit (Earnest Money)</label>
                            <input type="number" id="totalDeposit" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="5000" step="0.01">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Cash Due to Seller at Closing</label>
                            <input type="number" id="cashDue" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="195000" step="0.01">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Total Purchase Price</label>
                            <input type="number" id="totalPrice" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="200000" step="0.01">
                        </div>

                        <h4 class="font-medium text-gray-900 border-b pb-2 mt-6">Closing Details</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Closing Date</label>
                            <input type="date" id="closingDate" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Closing Location</label>
                            <input type="text" id="closingLocation" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="ABC Title Company">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Inspection Period (Days)</label>
                            <input type="number" id="inspectionDays" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="7" min="0" max="30">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">State (for governing law)</label>
                            <select id="purchaseState" class="w-full px-3 py-2 border border-gray-300 rounded-md" onchange="updateClosingLanguage()">
                                <option value="">Select State</option>
                                <option value="Alabama">Alabama</option>
                                <option value="Alaska">Alaska</option>
                                <option value="Arizona">Arizona</option>
                                <option value="Arkansas">Arkansas</option>
                                <option value="California">California</option>
                                <option value="Colorado">Colorado</option>
                                <option value="Connecticut">Connecticut - Attorney State</option>
                                <option value="Delaware">Delaware - Attorney State</option>
                                <option value="Florida">Florida</option>
                                <option value="Georgia">Georgia - Attorney State</option>
                                <option value="Hawaii">Hawaii</option>
                                <option value="Idaho">Idaho</option>
                                <option value="Illinois">Illinois</option>
                                <option value="Indiana">Indiana</option>
                                <option value="Iowa">Iowa</option>
                                <option value="Kansas">Kansas</option>
                                <option value="Kentucky">Kentucky</option>
                                <option value="Louisiana">Louisiana</option>
                                <option value="Maine">Maine</option>
                                <option value="Maryland">Maryland</option>
                                <option value="Massachusetts">Massachusetts - Attorney State</option>
                                <option value="Michigan">Michigan</option>
                                <option value="Minnesota">Minnesota</option>
                                <option value="Mississippi">Mississippi</option>
                                <option value="Missouri">Missouri</option>
                                <option value="Montana">Montana</option>
                                <option value="Nebraska">Nebraska</option>
                                <option value="Nevada">Nevada</option>
                                <option value="New Hampshire">New Hampshire</option>
                                <option value="New Jersey">New Jersey</option>
                                <option value="New Mexico">New Mexico</option>
                                <option value="New York">New York - Attorney State</option>
                                <option value="North Carolina">North Carolina - Attorney State</option>
                                <option value="North Dakota">North Dakota</option>
                                <option value="Ohio">Ohio</option>
                                <option value="Oklahoma">Oklahoma</option>
                                <option value="Oregon">Oregon</option>
                                <option value="Pennsylvania">Pennsylvania</option>
                                <option value="Rhode Island">Rhode Island</option>
                                <option value="South Carolina">South Carolina - Attorney State</option>
                                <option value="South Dakota">South Dakota</option>
                                <option value="Tennessee">Tennessee</option>
                                <option value="Texas">Texas</option>
                                <option value="Utah">Utah</option>
                                <option value="Vermont">Vermont - Attorney State</option>
                                <option value="Virginia">Virginia</option>
                                <option value="Washington">Washington</option>
                                <option value="West Virginia">West Virginia - Attorney State</option>
                                <option value="Wisconsin">Wisconsin</option>
                                <option value="Wyoming">Wyoming</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Additional Terms (Optional)</label>
                            <textarea id="additionalTerms" class="w-full px-3 py-2 border border-gray-300 rounded-md" rows="4" placeholder="Any additional terms and conditions..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Assignment of Contract Form -->
            <div id="assignment-form" class="hidden bg-white rounded-lg shadow p-6 mb-6">
                <h3 class="text-lg font-semibold mb-6">Assignment of Contract Details</h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Left Column -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Assignment Parties</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Assignor (You)</label>
                            <input type="text" id="assignor" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="ABC Investments LLC">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Assignee (New Buyer)</label>
                            <input type="text" id="assignee" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="XYZ Properties Inc">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Original Seller</label>
                            <input type="text" id="originalSeller" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="John Doe">
                        </div>

                        <h4 class="font-medium text-gray-900 border-b pb-2 mt-6">Property Information</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Property Address</label>
                            <input type="text" id="assignmentPropertyAddress" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="123 Main Street, Dallas, TX 75001">
                        </div>

                    </div>

                    <!-- Right Column -->
                    <div class="space-y-4">
                        <h4 class="font-medium text-gray-900 border-b pb-2">Financial Terms</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Assignment Deposit</label>
                            <input type="number" id="assignmentDeposit" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="1000" step="0.01">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Total Assignment Fee</label>
                            <input type="number" id="assignmentFee" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="15000" step="0.01">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Assignment Fee at Closing</label>
                            <input type="number" id="assignmentFeeAtClosing" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="15000" step="0.01">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Original Purchase Price</label>
                            <input type="number" id="originalPurchasePrice" class="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="200000" step="0.01">
                        </div>

                        <h4 class="font-medium text-gray-900 border-b pb-2 mt-6">Closing Details</h4>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Closing Deadline</label>
                            <input type="date" id="assignmentClosingDate" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Deposit Deadline</label>
                            <input type="date" id="depositDeadline" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">State (for governing law)</label>
                            <select id="assignmentState" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                <option value="">Select State</option>
                                <option value="Alabama">Alabama</option>
                                <option value="Alaska">Alaska</option>
                                <option value="Arizona">Arizona</option>
                                <option value="Arkansas">Arkansas</option>
                                <option value="California">California</option>
                                <option value="Colorado">Colorado</option>
                                <option value="Connecticut">Connecticut - Attorney State</option>
                                <option value="Delaware">Delaware - Attorney State</option>
                                <option value="Florida">Florida</option>
                                <option value="Georgia">Georgia - Attorney State</option>
                                <option value="Hawaii">Hawaii</option>
                                <option value="Idaho">Idaho</option>
                                <option value="Illinois">Illinois</option>
                                <option value="Indiana">Indiana</option>
                                <option value="Iowa">Iowa</option>
                                <option value="Kansas">Kansas</option>
                                <option value="Kentucky">Kentucky</option>
                                <option value="Louisiana">Louisiana</option>
                                <option value="Maine">Maine</option>
                                <option value="Maryland">Maryland</option>
                                <option value="Massachusetts">Massachusetts - Attorney State</option>
                                <option value="Michigan">Michigan</option>
                                <option value="Minnesota">Minnesota</option>
                                <option value="Mississippi">Mississippi</option>
                                <option value="Missouri">Missouri</option>
                                <option value="Montana">Montana</option>
                                <option value="Nebraska">Nebraska</option>
                                <option value="Nevada">Nevada</option>
                                <option value="New Hampshire">New Hampshire</option>
                                <option value="New Jersey">New Jersey</option>
                                <option value="New Mexico">New Mexico</option>
                                <option value="New York">New York - Attorney State</option>
                                <option value="North Carolina">North Carolina - Attorney State</option>
                                <option value="North Dakota">North Dakota</option>
                                <option value="Ohio">Ohio</option>
                                <option value="Oklahoma">Oklahoma</option>
                                <option value="Oregon">Oregon</option>
                                <option value="Pennsylvania">Pennsylvania</option>
                                <option value="Rhode Island">Rhode Island</option>
                                <option value="South Carolina">South Carolina - Attorney State</option>
                                <option value="South Dakota">South Dakota</option>
                                <option value="Tennessee">Tennessee</option>
                                <option value="Texas">Texas</option>
                                <option value="Utah">Utah</option>
                                <option value="Vermont">Vermont - Attorney State</option>
                                <option value="Virginia">Virginia</option>
                                <option value="Washington">Washington</option>
                                <option value="West Virginia">West Virginia - Attorney State</option>
                                <option value="Wisconsin">Wisconsin</option>
                                <option value="Wyoming">Wyoming</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Generate Button and Preview -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold">Generate Contract</h3>
                    <button onclick="generateContract()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        üìÑ Generate DOCX
                    </button>
                </div>

                <!-- Contract Preview -->
                <div id="contractPreview" class="hidden">
                    <h4 class="font-medium text-gray-900 mb-3">Document Preview</h4>
                    <div class="bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto">
                        <pre id="previewContent" class="text-sm whitespace-pre-wrap font-mono"></pre>
                    </div>
                </div>
            </div>
        </div>

        <div id="content-rental-calculator" class="tab-content hidden">
            <style>
                .rental-calc-container {
                    max-width: 1200px;
                    margin: 0 auto;
                    background: rgba(255, 255, 255, 0.95);
                    border-radius: 20px;
                    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                    overflow: hidden;
                }

                .rental-calc-header {
                    background: linear-gradient(135deg, #2c3e50, #34495e);
                    color: white;
                    padding: 30px;
                    text-align: center;
                }

                .rental-calc-header h1 {
                    font-size: 2.5em;
                    margin-bottom: 10px;
                    font-weight: 300;
                }

                .rental-calc-header p {
                    opacity: 0.9;
                    font-size: 1.1em;
                }

                .rental-main-content {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 0;
                    min-height: 600px;
                }

                .rental-inputs-section, .rental-results-section {
                    padding: 40px;
                }

                .rental-inputs-section {
                    background: #f8f9fa;
                    border-right: 1px solid #e9ecef;
                }

                .rental-section-title {
                    font-size: 1.4em;
                    color: #2c3e50;
                    margin-bottom: 25px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }

                .rental-section-title::before {
                    content: '';
                    width: 4px;
                    height: 25px;
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    border-radius: 2px;
                }

                .rental-input-group {
                    background: white;
                    border-radius: 12px;
                    padding: 25px;
                    margin-bottom: 25px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
                    border-left: 4px solid transparent;
                    transition: all 0.3s ease;
                }

                .rental-input-group:hover {
                    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
                    border-left-color: #667eea;
                }

                .rental-input-group h3 {
                    color: #2c3e50;
                    margin-bottom: 20px;
                    font-size: 1.2em;
                    font-weight: 600;
                }

                .rental-form-row {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 15px;
                    margin-bottom: 15px;
                }

                .rental-form-field {
                    display: flex;
                    flex-direction: column;
                }

                .rental-form-field.full-width {
                    grid-column: 1 / -1;
                }

                .rental-form-field label {
                    font-weight: 500;
                    color: #495057;
                    margin-bottom: 6px;
                    font-size: 0.95em;
                }

                .rental-form-field input[type="number"] {
                    padding: 12px 15px;
                    border: 2px solid #e9ecef;
                    border-radius: 8px;
                    font-size: 16px;
                    transition: all 0.3s ease;
                    background: #fff;
                }

                .rental-form-field input[type="number"]:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                }

                .rental-results-section {
                    background: white;
                }

                .rental-result-card {
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    color: white;
                    padding: 25px;
                    border-radius: 15px;
                    margin-bottom: 20px;
                    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
                }

                .rental-result-card h3 {
                    font-size: 1.1em;
                    margin-bottom: 10px;
                    opacity: 0.9;
                    font-weight: 400;
                }

                .rental-result-card .value {
                    font-size: 2.2em;
                    font-weight: 700;
                    margin-bottom: 5px;
                }

                .rental-result-card .subtitle {
                    opacity: 0.8;
                    font-size: 0.9em;
                }

                .rental-metrics-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 20px;
                    margin-bottom: 25px;
                }

                .rental-metric-item {
                    background: #f8f9fa;
                    padding: 20px;
                    border-radius: 12px;
                    text-align: center;
                    border: 2px solid transparent;
                    transition: all 0.3s ease;
                }

                .rental-metric-item:hover {
                    border-color: #667eea;
                    background: white;
                }

                .rental-metric-item .label {
                    font-size: 0.9em;
                    color: #6c757d;
                    margin-bottom: 8px;
                    font-weight: 500;
                }

                .rental-metric-item .value {
                    font-size: 1.5em;
                    font-weight: 700;
                    color: #2c3e50;
                }

                .rental-cap-rate-indicator {
                    text-align: center;
                    padding: 20px;
                    border-radius: 12px;
                    margin-top: 20px;
                    font-weight: 600;
                    transition: all 0.3s ease;
                }

                .rental-cap-rate-excellent {
                    background: linear-gradient(135deg, #00c851, #007e33);
                    color: white;
                }

                .rental-cap-rate-good {
                    background: linear-gradient(135deg, #ffbb33, #ff8800);
                    color: white;
                }

                .rental-cap-rate-fair {
                    background: linear-gradient(135deg, #ff4444, #cc0000);
                    color: white;
                }

                .rental-breakdown {
                    background: #f8f9fa;
                    border-radius: 12px;
                    padding: 25px;
                    margin-top: 25px;
                }

                .rental-breakdown h4 {
                    color: #2c3e50;
                    margin-bottom: 15px;
                    font-size: 1.1em;
                }

                .rental-breakdown-item {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 8px 0;
                    border-bottom: 1px solid #e9ecef;
                }

                .rental-breakdown-item:last-child {
                    border-bottom: none;
                    font-weight: 600;
                    color: #2c3e50;
                }

                @media (max-width: 768px) {
                    .rental-main-content {
                        grid-template-columns: 1fr;
                    }

                    .rental-inputs-section {
                        border-right: none;
                        border-bottom: 1px solid #e9ecef;
                    }

                    .rental-form-row {
                        grid-template-columns: 1fr;
                    }

                    .rental-metrics-grid {
                        grid-template-columns: 1fr;
                    }

                    .rental-calc-header h1 {
                        font-size: 2em;
                    }
                }
            </style>

            <div class="rental-calc-container">
                <div class="rental-calc-header">
                    <h1>Rental Profit Calculator</h1>
                    <p>Analyze NOI, Cap Rate & Cash Flow for Investment Properties</p>
                </div>

                <div class="rental-main-content">
                    <div class="rental-inputs-section">
                        <h2 class="rental-section-title">Property Analysis</h2>

                        <div class="rental-input-group">
                            <h3>Property Information</h3>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalPurchasePrice">Purchase Price ($)</label>
                                    <input type="number" id="rentalPurchasePrice" value="300000" min="0">
                                </div>
                                <div class="rental-form-field">
                                    <label for="rentalDownPayment">Down Payment ($)</label>
                                    <input type="number" id="rentalDownPayment" value="60000" min="0">
                                </div>
                            </div>
                        </div>

                        <div class="rental-input-group">
                            <h3>Income</h3>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalMonthlyRent">Monthly Rent ($)</label>
                                    <input type="number" id="rentalMonthlyRent" value="2500" min="0">
                                </div>
                                <div class="rental-form-field">
                                    <label for="rentalOtherIncome">Other Monthly Income ($)</label>
                                    <input type="number" id="rentalOtherIncome" value="0" min="0">
                                </div>
                            </div>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalVacancyRate">Vacancy Rate (%)</label>
                                    <input type="number" id="rentalVacancyRate" value="5" min="0" max="100" step="0.1">
                                </div>
                            </div>
                        </div>

                        <div class="rental-input-group">
                            <h3>Operating Expenses (Annual)</h3>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalPropertyTaxes">Property Taxes ($)</label>
                                    <input type="number" id="rentalPropertyTaxes" value="3600" min="0">
                                </div>
                                <div class="rental-form-field">
                                    <label for="rentalInsurance">Insurance ($)</label>
                                    <input type="number" id="rentalInsurance" value="1200" min="0">
                                </div>
                            </div>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalMaintenance">Maintenance & Repairs ($)</label>
                                    <input type="number" id="rentalMaintenance" value="2400" min="0">
                                </div>
                                <div class="rental-form-field">
                                    <label for="rentalManagement">Property Management ($)</label>
                                    <input type="number" id="rentalManagement" value="1800" min="0">
                                </div>
                            </div>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalUtilities">Utilities (Owner Paid) ($)</label>
                                    <input type="number" id="rentalUtilities" value="0" min="0">
                                </div>
                                <div class="rental-form-field">
                                    <label for="rentalHoaFees">HOA Fees ($)</label>
                                    <input type="number" id="rentalHoaFees" value="0" min="0">
                                </div>
                            </div>
                            <div class="rental-form-row">
                                <div class="rental-form-field">
                                    <label for="rentalOtherExpenses">Other Expenses ($)</label>
                                    <input type="number" id="rentalOtherExpenses" value="600" min="0">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="rental-results-section">
                        <h2 class="rental-section-title">Analysis Results</h2>

                        <div class="rental-result-card">
                            <h3>Net Operating Income (NOI)</h3>
                            <div class="value" id="rentalNoiResult">$19,200</div>
                            <div class="subtitle">Annual cash flow before debt service</div>
                        </div>

                        <div class="rental-metrics-grid">
                            <div class="rental-metric-item">
                                <div class="label">Cap Rate</div>
                                <div class="value" id="rentalCapRateResult">6.40%</div>
                            </div>
                            <div class="rental-metric-item">
                                <div class="label">Cash-on-Cash Return</div>
                                <div class="value" id="rentalCocResult">32.00%</div>
                            </div>
                            <div class="rental-metric-item">
                                <div class="label">Monthly Cash Flow</div>
                                <div class="value" id="rentalMonthlyCashFlow">$1,600</div>
                            </div>
                            <div class="rental-metric-item">
                                <div class="label">Annual Gross Income</div>
                                <div class="value" id="rentalGrossIncome">$28,500</div>
                            </div>
                        </div>

                        <div id="rentalCapRateIndicator" class="rental-cap-rate-indicator rental-cap-rate-good">
                            Good Investment Opportunity
                        </div>

                        <div class="rental-breakdown">
                            <h4>Income Breakdown</h4>
                            <div class="rental-breakdown-item">
                                <span>Gross Rental Income:</span>
                                <span id="rentalGrossRentalIncome">$28,500</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Vacancy Loss:</span>
                                <span id="rentalVacancyLoss">($1,425)</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Effective Gross Income:</span>
                                <span id="rentalEffectiveGrossIncome">$27,075</span>
                            </div>
                        </div>

                        <div class="rental-breakdown">
                            <h4>Expense Breakdown</h4>
                            <div class="rental-breakdown-item">
                                <span>Property Taxes:</span>
                                <span id="rentalTaxesDisplay">$3,600</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Insurance:</span>
                                <span id="rentalInsuranceDisplay">$1,200</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Maintenance:</span>
                                <span id="rentalMaintenanceDisplay">$2,400</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Management:</span>
                                <span id="rentalManagementDisplay">$1,800</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Other Expenses:</span>
                                <span id="rentalOtherExpensesDisplay">$600</span>
                            </div>
                            <div class="rental-breakdown-item">
                                <span>Total Operating Expenses:</span>
                                <span id="rentalTotalExpenses">$9,600</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                function formatRentalCurrency(amount) {
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(amount);
                }

                function formatRentalPercentage(rate) {
                    return (rate * 100).toFixed(2) + '%';
                }

                function updateRentalCapRateIndicator(capRate) {
                    const indicator = document.getElementById('rentalCapRateIndicator');
                    const rate = capRate * 100;

                    if (rate >= 8) {
                        indicator.className = 'rental-cap-rate-indicator rental-cap-rate-excellent';
                        indicator.textContent = 'Excellent Investment Opportunity';
                    } else if (rate >= 6) {
                        indicator.className = 'rental-cap-rate-indicator rental-cap-rate-good';
                        indicator.textContent = 'Good Investment Opportunity';
                    } else {
                        indicator.className = 'rental-cap-rate-indicator rental-cap-rate-fair';
                        indicator.textContent = 'Fair Investment - Consider Carefully';
                    }
                }

                function calculateRentalMetrics() {
                    // Get input values
                    const purchasePrice = parseFloat(document.getElementById('rentalPurchasePrice').value) || 0;
                    const downPayment = parseFloat(document.getElementById('rentalDownPayment').value) || 0;
                    const monthlyRent = parseFloat(document.getElementById('rentalMonthlyRent').value) || 0;
                    const otherIncome = parseFloat(document.getElementById('rentalOtherIncome').value) || 0;
                    const vacancyRate = parseFloat(document.getElementById('rentalVacancyRate').value) / 100 || 0;

                    // Operating expenses
                    const propertyTaxes = parseFloat(document.getElementById('rentalPropertyTaxes').value) || 0;
                    const insurance = parseFloat(document.getElementById('rentalInsurance').value) || 0;
                    const maintenance = parseFloat(document.getElementById('rentalMaintenance').value) || 0;
                    const management = parseFloat(document.getElementById('rentalManagement').value) || 0;
                    const utilities = parseFloat(document.getElementById('rentalUtilities').value) || 0;
                    const hoaFees = parseFloat(document.getElementById('rentalHoaFees').value) || 0;
                    const otherExpenses = parseFloat(document.getElementById('rentalOtherExpenses').value) || 0;

                    // Calculations
                    const annualRent = monthlyRent * 12;
                    const annualOtherIncome = otherIncome * 12;
                    const grossRentalIncome = annualRent + annualOtherIncome;
                    const vacancyLoss = grossRentalIncome * vacancyRate;
                    const effectiveGrossIncome = grossRentalIncome - vacancyLoss;

                    const totalOperatingExpenses = propertyTaxes + insurance + maintenance + management + utilities + hoaFees + otherExpenses;
                    const noi = effectiveGrossIncome - totalOperatingExpenses;

                    const capRate = purchasePrice > 0 ? noi / purchasePrice : 0;
                    const cashOnCashReturn = downPayment > 0 ? noi / downPayment : 0;
                    const monthlyCashFlow = noi / 12;

                    // Update display
                    document.getElementById('rentalNoiResult').textContent = formatRentalCurrency(noi);
                    document.getElementById('rentalCapRateResult').textContent = formatRentalPercentage(capRate);
                    document.getElementById('rentalCocResult').textContent = formatRentalPercentage(cashOnCashReturn);
                    document.getElementById('rentalMonthlyCashFlow').textContent = formatRentalCurrency(monthlyCashFlow);
                    document.getElementById('rentalGrossIncome').textContent = formatRentalCurrency(effectiveGrossIncome);

                    // Income breakdown
                    document.getElementById('rentalGrossRentalIncome').textContent = formatRentalCurrency(grossRentalIncome);
                    document.getElementById('rentalVacancyLoss').textContent = formatRentalCurrency(-vacancyLoss);
                    document.getElementById('rentalEffectiveGrossIncome').textContent = formatRentalCurrency(effectiveGrossIncome);

                    // Expense breakdown
                    document.getElementById('rentalTaxesDisplay').textContent = formatRentalCurrency(propertyTaxes);
                    document.getElementById('rentalInsuranceDisplay').textContent = formatRentalCurrency(insurance);
                    document.getElementById('rentalMaintenanceDisplay').textContent = formatRentalCurrency(maintenance);
                    document.getElementById('rentalManagementDisplay').textContent = formatRentalCurrency(management);
                    document.getElementById('rentalOtherExpensesDisplay').textContent = formatRentalCurrency(utilities + hoaFees + otherExpenses);
                    document.getElementById('rentalTotalExpenses').textContent = formatRentalCurrency(totalOperatingExpenses);

                    // Update cap rate indicator
                    updateRentalCapRateIndicator(capRate);
                }

                // Add event listeners to all rental calculator input fields
                document.addEventListener('DOMContentLoaded', function() {
                    const rentalInputs = document.querySelectorAll('#content-rental-calculator input[type="number"]');
                    rentalInputs.forEach(input => {
                        input.addEventListener('input', calculateRentalMetrics);
                    });

                    // Initial calculation
                    calculateRentalMetrics();
                });
            </script>
        </div>

        <div id="content-seller-finance" class="tab-content hidden">
            <style>
                .seller-finance-container {
                    max-width: 1200px;
                    margin: 0 auto;
                    background: rgba(255, 255, 255, 0.95);
                    border-radius: 20px;
                    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                    overflow: hidden;
                }

                .seller-finance-header {
                    background: linear-gradient(135deg, #1a472a, #2d7431);
                    color: white;
                    padding: 30px;
                    text-align: center;
                }

                .seller-finance-header h1 {
                    font-size: 2.5em;
                    margin-bottom: 10px;
                    font-weight: 300;
                }

                .seller-finance-header p {
                    opacity: 0.9;
                    font-size: 1.1em;
                }

                .seller-finance-main-content {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 0;
                    min-height: 600px;
                }

                .seller-finance-inputs-section, .seller-finance-results-section {
                    padding: 40px;
                }

                .seller-finance-inputs-section {
                    background: #f8f9fa;
                    border-right: 1px solid #e9ecef;
                }

                .seller-finance-section-title {
                    font-size: 1.4em;
                    color: #1a472a;
                    margin-bottom: 25px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }

                .seller-finance-section-title::before {
                    content: '';
                    width: 4px;
                    height: 25px;
                    background: linear-gradient(135deg, #22c55e, #16a34a);
                    border-radius: 2px;
                }

                .seller-finance-input-group {
                    background: white;
                    border-radius: 12px;
                    padding: 25px;
                    margin-bottom: 25px;
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
                    border-left: 4px solid transparent;
                    transition: all 0.3s ease;
                }

                .seller-finance-input-group:hover {
                    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
                    border-left-color: #22c55e;
                }

                .seller-finance-input-group h3 {
                    color: #1a472a;
                    margin-bottom: 20px;
                    font-size: 1.2em;
                    font-weight: 600;
                }

                .seller-finance-form-row {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 15px;
                    margin-bottom: 15px;
                }

                .seller-finance-form-field {
                    display: flex;
                    flex-direction: column;
                }

                .seller-finance-form-field.full-width {
                    grid-column: 1 / -1;
                }

                .seller-finance-form-field label {
                    font-weight: 500;
                    color: #495057;
                    margin-bottom: 6px;
                    font-size: 0.95em;
                }

                .seller-finance-form-field input[type="number"],
                .seller-finance-form-field select {
                    padding: 12px 15px;
                    border: 2px solid #e9ecef;
                    border-radius: 8px;
                    font-size: 16px;
                    transition: all 0.3s ease;
                    background: #fff;
                }

                .seller-finance-form-field input[type="number"]:focus,
                .seller-finance-form-field select:focus {
                    outline: none;
                    border-color: #22c55e;
                    box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
                }

                .seller-finance-results-section {
                    background: white;
                }

                .seller-finance-result-card {
                    background: linear-gradient(135deg, #22c55e, #16a34a);
                    color: white;
                    padding: 25px;
                    border-radius: 15px;
                    margin-bottom: 20px;
                    box-shadow: 0 8px 20px rgba(34, 197, 94, 0.3);
                }

                .seller-finance-result-card h3 {
                    font-size: 1.1em;
                    margin-bottom: 10px;
                    opacity: 0.9;
                    font-weight: 400;
                }

                .seller-finance-result-card .value {
                    font-size: 2.2em;
                    font-weight: 700;
                    margin-bottom: 5px;
                }

                .seller-finance-result-card .subtitle {
                    opacity: 0.8;
                    font-size: 0.9em;
                }

                .seller-finance-metrics-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 20px;
                    margin-bottom: 25px;
                }

                .seller-finance-metric-item {
                    background: #f8f9fa;
                    padding: 20px;
                    border-radius: 12px;
                    text-align: center;
                    border: 2px solid transparent;
                    transition: all 0.3s ease;
                }

                .seller-finance-metric-item:hover {
                    border-color: #22c55e;
                    background: white;
                }

                .seller-finance-metric-item .label {
                    font-size: 0.9em;
                    color: #6c757d;
                    margin-bottom: 8px;
                    font-weight: 500;
                }

                .seller-finance-metric-item .value {
                    font-size: 1.5em;
                    font-weight: 700;
                    color: #1a472a;
                }

                .seller-finance-comparison {
                    background: #f8f9fa;
                    border-radius: 12px;
                    padding: 25px;
                    margin-top: 25px;
                }

                .seller-finance-comparison h4 {
                    color: #1a472a;
                    margin-bottom: 15px;
                    font-size: 1.1em;
                }

                .seller-finance-comparison-item {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 8px 0;
                    border-bottom: 1px solid #e9ecef;
                }

                .seller-finance-comparison-item:last-child {
                    border-bottom: none;
                    font-weight: 600;
                    color: #1a472a;
                }

                .seller-finance-zero-interest {
                    background: #e8f5e8;
                    border: 2px solid #22c55e;
                    border-radius: 12px;
                    padding: 25px;
                    margin-top: 25px;
                }

                .seller-finance-zero-interest h4 {
                    color: #1a472a;
                    margin-bottom: 15px;
                    font-size: 1.1em;
                }

                .seller-finance-zero-interest-scenario {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 8px 0;
                    border-bottom: 1px solid #d1fae5;
                    font-weight: 600;
                }

                .seller-finance-zero-interest-scenario:last-of-type {
                    border-bottom: none;
                }

                .seller-finance-zero-interest-benefits {
                    margin-top: 15px;
                    padding-top: 15px;
                    border-top: 1px solid #d1fae5;
                }

                .seller-finance-amortization {
                    background: white;
                    border-radius: 12px;
                    padding: 25px;
                    margin-top: 25px;
                    border: 1px solid #e9ecef;
                }

                .seller-finance-amortization h4 {
                    color: #1a472a;
                    margin-bottom: 15px;
                    font-size: 1.1em;
                }

                .seller-finance-amortization-table {
                    width: 100%;
                    border-collapse: collapse;
                    font-size: 0.9em;
                }

                .seller-finance-amortization-table th,
                .seller-finance-amortization-table td {
                    padding: 8px 12px;
                    text-align: right;
                    border-bottom: 1px solid #e9ecef;
                }

                .seller-finance-amortization-table th {
                    background: #f8f9fa;
                    font-weight: 600;
                    color: #1a472a;
                }

                @media (max-width: 768px) {
                    .seller-finance-main-content {
                        grid-template-columns: 1fr;
                    }

                    .seller-finance-inputs-section {
                        border-right: none;
                        border-bottom: 1px solid #e9ecef;
                    }

                    .seller-finance-form-row {
                        grid-template-columns: 1fr;
                    }

                    .seller-finance-metrics-grid {
                        grid-template-columns: 1fr;
                    }

                    .seller-finance-header h1 {
                        font-size: 2em;
                    }
                }
            </style>

            <div class="seller-finance-container">
                <div class="seller-finance-header">
                    <h1>Seller Finance Calculator</h1>
                    <p>Analyze Deal Structure, Payments & ROI for Owner Financing</p>
                </div>

                <!-- Mode Toggle -->
                <div style="background: white; padding: 20px; border-bottom: 1px solid #e9ecef; text-align: center;">
                    <div style="display: inline-flex; background: #f8f9fa; border-radius: 25px; padding: 4px; margin-bottom: 10px;">
                        <button id="sf-detailed-mode" onclick="switchSellerFinanceMode('detailed')" style="padding: 8px 20px; border: none; border-radius: 20px; background: #22c55e; color: white; font-weight: 500; cursor: pointer; transition: all 0.3s;">
                            üìä Terms Mode
                        </button>
                        <button id="sf-simple-mode" onclick="switchSellerFinanceMode('simple')" style="padding: 8px 20px; border: none; border-radius: 20px; background: transparent; color: #6c757d; font-weight: 500; cursor: pointer; transition: all 0.3s;">
                            üí∞ Payment Mode
                        </button>
                    </div>
                    <div style="font-size: 0.9em; color: #6c757d;">
                        <span id="sf-mode-description">Configure all loan terms manually for complete control</span>
                    </div>
                </div>

                <div class="seller-finance-main-content">
                    <!-- Terms Mode Inputs -->
                    <div class="seller-finance-inputs-section" id="sf-detailed-inputs">
                        <h2 class="seller-finance-section-title">Terms Configuration</h2>

                        <div class="seller-finance-input-group">
                            <h3>Property & Financing Terms</h3>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfPropertyPrice">Property Price ($)</label>
                                    <input type="number" id="sfPropertyPrice" value="400000" min="0">
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfDownPayment">Down Payment ($)</label>
                                    <input type="number" id="sfDownPayment" value="100000" min="0">
                                </div>
                            </div>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfInterestRate">Interest Rate (%)</label>
                                    <input type="number" id="sfInterestRate" value="6.5" min="0" max="20" step="0.1">
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfLoanTerm">Loan Term (Years)</label>
                                    <input type="number" id="sfLoanTerm" value="25" min="1" max="30">
                                </div>
                            </div>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfPaymentFreq">Payment Frequency</label>
                                    <select id="sfPaymentFreq">
                                        <option value="monthly">Monthly</option>
                                        <option value="quarterly">Quarterly</option>
                                        <option value="annually">Annually</option>
                                    </select>
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfAmortization">Amortization (Years)</label>
                                    <input type="number" id="sfAmortization" value="25" min="5" max="30">
                                </div>
                            </div>
                        </div>

                        <div class="seller-finance-input-group">
                            <h3>Advanced Terms</h3>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfBalloonPayment">Balloon Payment ($)</label>
                                    <input type="number" id="sfBalloonPayment" value="0" min="0">
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfInterestOnlyMonths">Interest-Only Period (Months)</label>
                                    <input type="number" id="sfInterestOnlyMonths" value="0" min="0" max="60">
                                </div>
                            </div>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfPrepaymentPenalty">Prepayment Penalty (%)</label>
                                    <input type="number" id="sfPrepaymentPenalty" value="0" min="0" max="5" step="0.1">
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfLateFee">Late Fee ($)</label>
                                    <input type="number" id="sfLateFee" value="50" min="0">
                                </div>
                            </div>
                        </div>

                        <div class="seller-finance-input-group">
                            <h3>Comparison Analysis</h3>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfMarketRate">Market Interest Rate (%)</label>
                                    <input type="number" id="sfMarketRate" value="7.5" min="0" max="15" step="0.1">
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfCashDiscount">Cash Sale Discount (%)</label>
                                    <input type="number" id="sfCashDiscount" value="5" min="0" max="20" step="0.5">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Mode Inputs -->
                    <div class="seller-finance-inputs-section" id="sf-simple-inputs" style="display: none;">
                        <h2 class="seller-finance-section-title">Payment-Based Calculator</h2>

                        <div class="seller-finance-input-group">
                            <h3>Deal Inputs</h3>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfSimplePurchasePrice">Purchase Price ($)</label>
                                    <input type="number" id="sfSimplePurchasePrice" value="400000" min="0" onchange="calculateFromSimpleMode()">
                                </div>
                                <div class="seller-finance-form-field">
                                    <label for="sfSimpleMonthlyPayment">Desired Monthly Payment ($)</label>
                                    <input type="number" id="sfSimpleMonthlyPayment" value="2456" min="0" onchange="calculateFromSimpleMode()">
                                </div>
                            </div>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label for="sfSimpleOptionalDown">Down Payment ($ - Optional)</label>
                                    <input type="number" id="sfSimpleOptionalDown" value="" min="0" placeholder="Leave blank to auto-calculate" onchange="calculateFromSimpleMode()">
                                    <div style="font-size: 0.8em; color: #6c757d; margin-top: 4px;">Leave blank to test multiple down payment options</div>
                                </div>
                                <div class="seller-finance-form-field">
                                    <!-- Empty for spacing -->
                                </div>
                            </div>
                        </div>

                        <div class="seller-finance-input-group">
                            <h3>Auto-Calculated Loan Terms</h3>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label>Optimal Down Payment</label>
                                    <div style="padding: 12px 15px; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; font-weight: 600; color: #22c55e;">
                                        <span id="sfCalculatedDownPayment">$100,000 (25%)</span>
                                    </div>
                                </div>
                                <div class="seller-finance-form-field">
                                    <label>Calculated Interest Rate</label>
                                    <div style="padding: 12px 15px; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; font-weight: 600; color: #22c55e;">
                                        <span id="sfCalculatedRate">6.5%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field">
                                    <label>Optimal Loan Term</label>
                                    <div style="padding: 12px 15px; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; font-weight: 600; color: #22c55e;">
                                        <span id="sfCalculatedLoanTerm">25 years</span>
                                    </div>
                                </div>
                                <div class="seller-finance-form-field">
                                    <label>Financed Amount</label>
                                    <div style="padding: 12px 15px; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; font-weight: 600; color: #22c55e;">
                                        <span id="sfCalculatedFinanced">$300,000</span>
                                    </div>
                                </div>
                            </div>
                            <div class="seller-finance-form-row">
                                <div class="seller-finance-form-field full-width">
                                    <label>Deal Assessment</label>
                                    <div id="sfDealViability" style="padding: 12px 15px; background: #d1fae5; border: 2px solid #22c55e; border-radius: 8px; font-weight: 600; color: #16a34a;">
                                        ‚úÖ Deal looks good! Terms are competitive.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="seller-finance-input-group">
                            <h3>Multiple Scenarios</h3>
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                <div style="font-weight: 600; margin-bottom: 10px; color: #1a472a;">Best Options for Your Deal:</div>
                                <div id="sfScenarios" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                                    <div style="padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #22c55e;">
                                        <div style="font-weight: 500;">20% Down, 30yr</div>
                                        <div style="color: #6c757d;">6.2% @ $2,456/mo</div>
                                    </div>
                                    <div style="padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #3b82f6;">
                                        <div style="font-weight: 500;">25% Down, 25yr</div>
                                        <div style="color: #6c757d;">6.5% @ $2,456/mo</div>
                                    </div>
                                    <div style="padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #f59e0b;">
                                        <div style="font-weight: 500;">30% Down, 20yr</div>
                                        <div style="color: #6c757d;">6.8% @ $2,456/mo</div>
                                    </div>
                                    <div style="padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #8b5cf6;">
                                        <div style="font-weight: 500;">15% Down, 30yr</div>
                                        <div style="color: #6c757d;">6.0% @ $2,456/mo</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 20px; padding: 15px; background: #fffbeb; border: 1px solid #fbbf24; border-radius: 8px;">
                            <div style="font-weight: 600; color: #92400e; margin-bottom: 8px;">üí° How Payment Mode Works:</div>
                            <div style="font-size: 0.9em; color: #92400e; line-height: 1.4;">
                                Just enter <strong>purchase price</strong> and <strong>desired monthly payment</strong>. Optionally specify a down payment. The calculator automatically tests different scenarios to find the optimal combination that achieves your target payment, showing you the best option plus alternatives.
                            </div>
                        </div>
                    </div>

                    <div class="seller-finance-results-section">
                        <h2 class="seller-finance-section-title">Analysis Results</h2>

                        <div class="seller-finance-result-card">
                            <h3>Monthly Payment</h3>
                            <div class="value" id="sfMonthlyPayment">$2,456</div>
                            <div class="subtitle">Principal & Interest</div>
                        </div>

                        <div class="seller-finance-metrics-grid">
                            <div class="seller-finance-metric-item">
                                <div class="label">Seller IRR</div>
                                <div class="value" id="sfSellerIRR">8.2%</div>
                            </div>
                            <div class="seller-finance-metric-item">
                                <div class="label">Total Interest Received</div>
                                <div class="value" id="sfTotalInterest">$174,720</div>
                            </div>
                            <div class="seller-finance-metric-item">
                                <div class="label">Financed Amount</div>
                                <div class="value" id="sfFinancedAmount">$320,000</div>
                            </div>
                            <div class="seller-finance-metric-item">
                                <div class="label">Final Balloon</div>
                                <div class="value" id="sfFinalBalloon">$265,432</div>
                            </div>
                        </div>

                        <div class="seller-finance-comparison">
                            <h4>vs. Cash Sale Comparison</h4>
                            <div class="seller-finance-comparison-item">
                                <span>Cash Sale Amount (after discount):</span>
                                <span id="sfCashSaleAmount">$380,000</span>
                            </div>
                            <div class="seller-finance-comparison-item">
                                <span>Total Seller Finance Returns:</span>
                                <span id="sfTotalReturns">$494,720</span>
                            </div>
                            <div class="seller-finance-comparison-item">
                                <span>Additional Income vs Cash:</span>
                                <span id="sfAdditionalIncome">$114,720</span>
                            </div>
                        </div>

                        <div class="seller-finance-zero-interest">
                            <h4>üí° 0% Interest Option</h4>
                            <div class="seller-finance-zero-interest-content">
                                <div class="seller-finance-zero-interest-scenario">
                                    <span>Required Down Payment for 0% Interest:</span>
                                    <span id="sfZeroInterestDown">Calculate to see requirements</span>
                                </div>
                                <div class="seller-finance-zero-interest-scenario">
                                    <span>Loan Term for 0% Interest:</span>
                                    <span id="sfZeroInterestTerm">Calculate to see requirements</span>
                                </div>
                                <div class="seller-finance-zero-interest-benefits">
                                    <div style="font-size: 0.9em; color: #666; margin-top: 8px;">
                                        <strong>Benefits:</strong> Simpler structure, no interest calculations, pure principal payments, easier for sellers to understand
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="seller-finance-amortization">
                            <h4>First Year Amortization Schedule</h4>
                            <table class="seller-finance-amortization-table">
                                <thead>
                                    <tr>
                                        <th>Month</th>
                                        <th>Payment</th>
                                        <th>Interest</th>
                                        <th>Principal</th>
                                        <th>Balance</th>
                                    </tr>
                                </thead>
                                <tbody id="sfAmortizationTable">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                function formatSFCurrency(amount) {
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(amount);
                }

                function formatSFPercentage(rate) {
                    return (rate * 100).toFixed(2) + '%';
                }

                function calculateMonthlyPayment(principal, annualRate, years, amortizationYears) {
                    const monthlyRate = annualRate / 12 / 100;
                    const numPayments = amortizationYears * 12;

                    if (monthlyRate === 0) {
                        return principal / numPayments;
                    }

                    return principal * (monthlyRate * Math.pow(1 + monthlyRate, numPayments)) /
                           (Math.pow(1 + monthlyRate, numPayments) - 1);
                }

                function calculateRemainingBalance(principal, monthlyPayment, monthlyRate, paymentsMode) {
                    if (monthlyRate === 0) {
                        return principal - (monthlyPayment * paymentsMode);
                    }

                    return principal * Math.pow(1 + monthlyRate, paymentsMode) -
                           monthlyPayment * ((Math.pow(1 + monthlyRate, paymentsMode) - 1) / monthlyRate);
                }

                function calculateIRR(cashFlows) {
                    if (cashFlows.length < 2) return 0;

                    // Check if we have both positive and negative cash flows
                    const hasPositive = cashFlows.some(cf => cf > 0);
                    const hasNegative = cashFlows.some(cf => cf < 0);
                    if (!hasPositive || !hasNegative) return 0;

                    // Simple bisection method - more reliable than Newton-Raphson
                    let lowRate = -0.99;
                    let highRate = 5.0;
                    let tolerance = 0.0001;

                    function npv(rate) {
                        let result = 0;
                        for (let i = 0; i < cashFlows.length; i++) {
                            result += cashFlows[i] / Math.pow(1 + rate, i);
                        }
                        return result;
                    }

                    // Bisection method
                    for (let iteration = 0; iteration < 100; iteration++) {
                        const midRate = (lowRate + highRate) / 2;
                        const midNPV = npv(midRate);

                        if (Math.abs(midNPV) < tolerance) {
                            return midRate;
                        }

                        if (npv(lowRate) * midNPV < 0) {
                            highRate = midRate;
                        } else {
                            lowRate = midRate;
                        }

                        if (Math.abs(highRate - lowRate) < tolerance) {
                            return (lowRate + highRate) / 2;
                        }
                    }

                    return 0; // Failed to converge
                }

                function generateAmortizationSchedule(principal, monthlyPayment, monthlyRate, months) {
                    const schedule = [];
                    let balance = principal;

                    for (let month = 1; month <= months; month++) {
                        const interestPayment = balance * monthlyRate;
                        const principalPayment = monthlyPayment - interestPayment;
                        balance -= principalPayment;

                        schedule.push({
                            month: month,
                            payment: monthlyPayment,
                            interest: interestPayment,
                            principal: principalPayment,
                            balance: Math.max(0, balance)
                        });
                    }

                    return schedule;
                }

                function calculateSellerFinanceMetrics() {
                    // Get input values
                    const propertyPrice = parseFloat(document.getElementById('sfPropertyPrice').value) || 0;
                    const downPayment = parseFloat(document.getElementById('sfDownPayment').value) || 0;
                    const interestRate = parseFloat(document.getElementById('sfInterestRate').value) || 0;
                    const loanTerm = parseFloat(document.getElementById('sfLoanTerm').value) || 0;
                    const amortizationYears = parseFloat(document.getElementById('sfAmortization').value) || 30;
                    const balloonPayment = parseFloat(document.getElementById('sfBalloonPayment').value) || 0;
                    const cashDiscount = parseFloat(document.getElementById('sfCashDiscount').value) || 0;

                    // Basic calculations
                    const financedAmount = propertyPrice - downPayment;
                    const monthlyRate = interestRate / 12 / 100;
                    const amortizationMonths = amortizationYears * 12;
                    const loanTermMonths = loanTerm * 12;

                    // Check if we're in Payment Mode (simple mode is visible)
                    const isPaymentMode = document.getElementById('sf-simple-inputs').style.display !== 'none';
                    let monthlyPayment = 0;

                    if (isPaymentMode) {
                        // In Payment Mode, use the desired payment from the input
                        monthlyPayment = parseFloat(document.getElementById('sfSimpleMonthlyPayment').value) || 0;
                    } else {
                        // In Terms Mode, calculate monthly payment based on loan terms
                        if (monthlyRate > 0) {
                            monthlyPayment = financedAmount * (monthlyRate * Math.pow(1 + monthlyRate, amortizationMonths)) /
                                           (Math.pow(1 + monthlyRate, amortizationMonths) - 1);
                        } else {
                            monthlyPayment = financedAmount / amortizationMonths;
                        }
                    }

                    // Calculate remaining balance at end of loan term (for balloon)
                    let remainingBalance = 0;
                    if (loanTermMonths < amortizationMonths) {
                        // There will be a balloon payment
                        if (monthlyRate > 0) {
                            remainingBalance = financedAmount *
                                             (Math.pow(1 + monthlyRate, amortizationMonths) - Math.pow(1 + monthlyRate, loanTermMonths)) /
                                             (Math.pow(1 + monthlyRate, amortizationMonths) - 1);
                        } else {
                            remainingBalance = financedAmount - (monthlyPayment * loanTermMonths);
                        }
                    }

                    const finalBalloon = Math.max(balloonPayment, remainingBalance);

                    // Total calculations
                    const totalMonthlyPayments = monthlyPayment * loanTermMonths;
                    const totalReceived = downPayment + totalMonthlyPayments + finalBalloon;
                    const totalInterest = totalReceived - propertyPrice;

                    // Cash sale comparison
                    const cashSaleAmount = propertyPrice * (1 - cashDiscount / 100);
                    const additionalIncome = totalReceived - cashSaleAmount;

                    // IRR calculation - treat seller as making a loan investment
                    let sellerIRR = 0;

                    if (loanTermMonths > 0 && financedAmount > 0) {
                        // From seller's perspective: they "lend" the financed amount and receive payments
                        const cashFlows = [];

                        // Period 0: Seller "invests" the financed amount (what they're not getting in cash)
                        cashFlows.push(-financedAmount);

                        // Monthly payments received
                        for (let i = 1; i <= loanTermMonths; i++) {
                            cashFlows.push(monthlyPayment);
                        }

                        // Add balloon to final payment if any
                        if (finalBalloon > 0) {
                            cashFlows[cashFlows.length - 1] += finalBalloon;
                        }

                        // Calculate monthly IRR and annualize
                        const monthlyIRR = calculateIRR(cashFlows);
                        if (monthlyIRR > -0.99 && monthlyIRR < 10) {
                            sellerIRR = Math.pow(1 + monthlyIRR, 12) - 1;
                        }
                    }

                    // Update display
                    document.getElementById('sfMonthlyPayment').textContent = formatSFCurrency(monthlyPayment);
                    document.getElementById('sfSellerIRR').textContent = formatSFPercentage(sellerIRR);
                    document.getElementById('sfTotalInterest').textContent = formatSFCurrency(totalInterest);
                    document.getElementById('sfFinancedAmount').textContent = formatSFCurrency(financedAmount);
                    document.getElementById('sfFinalBalloon').textContent = formatSFCurrency(finalBalloon);

                    // Comparison
                    document.getElementById('sfCashSaleAmount').textContent = formatSFCurrency(cashSaleAmount);
                    document.getElementById('sfTotalReturns').textContent = formatSFCurrency(totalReceived);
                    document.getElementById('sfAdditionalIncome').textContent = formatSFCurrency(additionalIncome);

                    // Generate amortization table for first 12 months
                    const schedule = generateAmortizationSchedule(financedAmount, monthlyPayment, monthlyRate, 12);
                    const tableBody = document.getElementById('sfAmortizationTable');
                    tableBody.innerHTML = '';

                    schedule.forEach(row => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${row.month}</td>
                            <td>${formatSFCurrency(row.payment)}</td>
                            <td>${formatSFCurrency(row.interest)}</td>
                            <td>${formatSFCurrency(row.principal)}</td>
                            <td>${formatSFCurrency(row.balance)}</td>
                        `;
                        tableBody.appendChild(tr);
                    });

                    // Calculate 0% interest scenario for Terms Mode
                    if (!isPaymentMode && propertyPrice > 0) {
                        // In Terms Mode, use current monthly payment to calculate 0% scenario
                        calculateZeroInterestScenario(propertyPrice, monthlyPayment);
                    }
                }

                // Mode switching functionality
                function switchSellerFinanceMode(mode) {
                    const detailedMode = document.getElementById('sf-detailed-mode');
                    const simpleMode = document.getElementById('sf-simple-mode');
                    const detailedInputs = document.getElementById('sf-detailed-inputs');
                    const simpleInputs = document.getElementById('sf-simple-inputs');
                    const modeDescription = document.getElementById('sf-mode-description');

                    if (mode === 'simple') {
                        // Switch to payment mode
                        simpleMode.style.background = '#22c55e';
                        simpleMode.style.color = 'white';
                        detailedMode.style.background = 'transparent';
                        detailedMode.style.color = '#6c757d';

                        detailedInputs.style.display = 'none';
                        simpleInputs.style.display = 'block';

                        modeDescription.textContent = 'Enter purchase price and desired payment - we\'ll calculate optimal terms';

                        // Calculate from payment mode
                        calculateFromSimpleMode();
                    } else {
                        // Switch to terms mode
                        detailedMode.style.background = '#22c55e';
                        detailedMode.style.color = 'white';
                        simpleMode.style.background = 'transparent';
                        simpleMode.style.color = '#6c757d';

                        detailedInputs.style.display = 'block';
                        simpleInputs.style.display = 'none';

                        modeDescription.textContent = 'Configure all loan terms manually for complete control';

                        // Calculate from terms mode
                        calculateSellerFinanceMetrics();
                    }
                }

                // Simple mode calculation - reverse engineer optimal terms
                function calculateFromSimpleMode() {
                    const purchasePrice = parseFloat(document.getElementById('sfSimplePurchasePrice').value) || 0;
                    const monthlyPayment = parseFloat(document.getElementById('sfSimpleMonthlyPayment').value) || 0;
                    const optionalDownPayment = document.getElementById('sfSimpleOptionalDown').value.trim();

                    if (purchasePrice <= 0 || monthlyPayment <= 0) {
                        document.getElementById('sfCalculatedRate').textContent = '0.0%';
                        document.getElementById('sfCalculatedFinanced').textContent = '$0';
                        document.getElementById('sfCalculatedDownPayment').textContent = '$0 (0%)';
                        document.getElementById('sfCalculatedLoanTerm').textContent = '0 years';
                        updateDealViability(0, 0);
                        return;
                    }

                    try {
                        let scenarios = [];

                        // Check if user specified a down payment
                        if (optionalDownPayment && optionalDownPayment !== '') {
                            const specificDownPayment = parseFloat(optionalDownPayment);
                            const downPercent = (specificDownPayment / purchasePrice * 100);

                            // Test different loan terms with the specified down payment
                            scenarios = [
                                { downPayment: specificDownPayment, downPercent: downPercent, termYears: 20 },
                                { downPayment: specificDownPayment, downPercent: downPercent, termYears: 25 },
                                { downPayment: specificDownPayment, downPercent: downPercent, termYears: 30 }
                            ];
                        } else {
                            // Test multiple down payment scenarios
                            scenarios = [
                                { downPercent: 15, termYears: 30 },
                                { downPercent: 20, termYears: 30 },
                                { downPercent: 25, termYears: 25 },
                                { downPercent: 25, termYears: 30 },
                                { downPercent: 30, termYears: 20 },
                                { downPercent: 30, termYears: 25 }
                            ].map(s => ({
                                ...s,
                                downPayment: purchasePrice * (s.downPercent / 100)
                            }));
                        }

                        let bestScenario = null;
                        let bestRate = 99;
                        const viableScenarios = [];

                        scenarios.forEach(scenario => {
                            const financedAmount = purchasePrice - scenario.downPayment;
                            const requiredRate = findRequiredInterestRate(financedAmount, monthlyPayment, scenario.termYears * 12);

                            if (requiredRate > 0 && requiredRate < 20) { // Reasonable rate range
                                viableScenarios.push({
                                    ...scenario,
                                    financedAmount,
                                    requiredRate
                                });

                                // Track best (lowest rate) scenario
                                if (requiredRate < bestRate) {
                                    bestRate = requiredRate;
                                    bestScenario = {
                                        ...scenario,
                                        financedAmount,
                                        requiredRate
                                    };
                                }
                            }
                        });

                        if (bestScenario) {
                            // Update displays with best scenario
                            document.getElementById('sfCalculatedRate').textContent = bestScenario.requiredRate.toFixed(2) + '%';
                            document.getElementById('sfCalculatedFinanced').textContent = formatSFCurrency(bestScenario.financedAmount);
                            document.getElementById('sfCalculatedDownPayment').textContent =
                                formatSFCurrency(bestScenario.downPayment) + ` (${bestScenario.downPercent.toFixed(1)}%)`;
                            document.getElementById('sfCalculatedLoanTerm').textContent = bestScenario.termYears + ' years';

                            // Update detailed mode fields with best scenario
                            document.getElementById('sfPropertyPrice').value = purchasePrice;
                            document.getElementById('sfDownPayment').value = bestScenario.downPayment;
                            document.getElementById('sfInterestRate').value = bestScenario.requiredRate.toFixed(2);
                            document.getElementById('sfLoanTerm').value = bestScenario.termYears;
                            document.getElementById('sfAmortization').value = bestScenario.termYears;
                            document.getElementById('sfBalloonPayment').value = 0;

                            // Update scenarios display
                            updateScenariosDisplay(viableScenarios, monthlyPayment);

                            // Check deal viability
                            updateDealViability(bestScenario.requiredRate, bestScenario.financedAmount);

                            // Run the full calculation to update results
                            calculateSellerFinanceMetrics();

                            // Calculate 0% interest scenario
                            calculateZeroInterestScenario(purchasePrice, monthlyPayment);
                        } else {
                            // No viable scenarios found
                            document.getElementById('sfCalculatedRate').textContent = 'N/A';
                            document.getElementById('sfCalculatedFinanced').textContent = 'N/A';
                            document.getElementById('sfCalculatedDownPayment').textContent = 'N/A';
                            document.getElementById('sfCalculatedLoanTerm').textContent = 'N/A';

                            const viabilityDiv = document.getElementById('sfDealViability');
                            viabilityDiv.style.background = '#fee2e2';
                            viabilityDiv.style.borderColor = '#ef4444';
                            viabilityDiv.style.color = '#dc2626';
                            viabilityDiv.innerHTML = '‚ùå Payment too low for viable seller financing terms';

                            // Clear scenarios
                            document.getElementById('sfScenarios').innerHTML =
                                '<div style="grid-column: 1/-1; text-align: center; color: #6c757d; padding: 20px;">No viable scenarios found with current inputs</div>';

                            // Still calculate 0% interest scenario even when no viable scenarios found
                            calculateZeroInterestScenario(purchasePrice, monthlyPayment);
                        }
                    } catch (error) {
                        console.error('Error in calculateFromSimpleMode:', error);
                    }
                }

                // Update scenarios display
                function updateScenariosDisplay(scenarios, monthlyPayment) {
                    const scenariosDiv = document.getElementById('sfScenarios');

                    // Sort by interest rate (best first)
                    scenarios.sort((a, b) => a.requiredRate - b.requiredRate);

                    // Take top 4 scenarios
                    const topScenarios = scenarios.slice(0, 4);

                    let html = '';
                    const colors = ['#22c55e', '#3b82f6', '#f59e0b', '#8b5cf6'];

                    topScenarios.forEach((scenario, index) => {
                        const color = colors[index] || '#6b7280';
                        html += `
                            <div style="padding: 8px; background: white; border-radius: 6px; border-left: 3px solid ${color};">
                                <div style="font-weight: 500;">${scenario.downPercent}% Down, ${scenario.termYears}yr</div>
                                <div style="color: #6c757d;">${scenario.requiredRate.toFixed(1)}% @ ${formatSFCurrency(monthlyPayment)}/mo</div>
                            </div>
                        `;
                    });

                    // Fill remaining slots if needed
                    while (topScenarios.length < 4) {
                        html += `
                            <div style="padding: 8px; background: #f8f9fa; border-radius: 6px; border-left: 3px solid #e5e5e5;">
                                <div style="color: #9ca3af; font-weight: 500;">-</div>
                                <div style="color: #9ca3af;">No scenario</div>
                            </div>
                        `;
                        topScenarios.push({});
                    }

                    scenariosDiv.innerHTML = html;
                }

                // Find required interest rate using binary search
                function findRequiredInterestRate(principal, payment, periods, balloon = 0) {
                    if (principal <= 0 || payment <= 0 || periods <= 0) return 0;

                    let lowRate = 0.01; // 1%
                    let highRate = 30.0; // 30%
                    let tolerance = 0.01;
                    let maxIterations = 100;
                    let iteration = 0;

                    while (iteration < maxIterations && (highRate - lowRate) > tolerance) {
                        let testRate = (lowRate + highRate) / 2;
                        let monthlyRate = testRate / 100 / 12;

                        let calculatedPayment;
                        if (balloon > 0) {
                            // With balloon payment
                            let pvBalloon = balloon / Math.pow(1 + monthlyRate, periods);
                            let remainingPrincipal = principal - pvBalloon;
                            calculatedPayment = remainingPrincipal * (monthlyRate * Math.pow(1 + monthlyRate, periods)) / (Math.pow(1 + monthlyRate, periods) - 1);
                        } else {
                            // Standard amortizing loan
                            calculatedPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, periods)) / (Math.pow(1 + monthlyRate, periods) - 1);
                        }

                        if (calculatedPayment < payment) {
                            lowRate = testRate;
                        } else {
                            highRate = testRate;
                        }
                        iteration++;
                    }

                    return (lowRate + highRate) / 2;
                }

                // Update deal viability assessment
                function updateDealViability(calculatedRate, financedAmount) {
                    const viabilityDiv = document.getElementById('sfDealViability');
                    const marketRate = 7.5; // Typical market rate for comparison

                    if (calculatedRate <= 0) {
                        viabilityDiv.style.background = '#fee2e2';
                        viabilityDiv.style.borderColor = '#ef4444';
                        viabilityDiv.style.color = '#dc2626';
                        viabilityDiv.innerHTML = '‚ùå Invalid parameters - check your inputs';
                    } else if (calculatedRate < 3.0) {
                        viabilityDiv.style.background = '#fee2e2';
                        viabilityDiv.style.borderColor = '#ef4444';
                        viabilityDiv.style.color = '#dc2626';
                        viabilityDiv.innerHTML = '‚ö†Ô∏è Rate too low - may not be realistic for seller';
                    } else if (calculatedRate > 15.0) {
                        viabilityDiv.style.background = '#fee2e2';
                        viabilityDiv.style.borderColor = '#ef4444';
                        viabilityDiv.style.color = '#dc2626';
                        viabilityDiv.innerHTML = '‚ùå Rate too high - buyer unlikely to accept';
                    } else if (calculatedRate <= marketRate) {
                        viabilityDiv.style.background = '#d1fae5';
                        viabilityDiv.style.borderColor = '#22c55e';
                        viabilityDiv.style.color = '#16a34a';
                        viabilityDiv.innerHTML = `‚úÖ Excellent! Rate is ${(marketRate - calculatedRate).toFixed(1)}% below market`;
                    } else if (calculatedRate <= marketRate + 2) {
                        viabilityDiv.style.background = '#fef3c7';
                        viabilityDiv.style.borderColor = '#f59e0b';
                        viabilityDiv.style.color = '#d97706';
                        viabilityDiv.innerHTML = `‚ö†Ô∏è Rate is ${(calculatedRate - marketRate).toFixed(1)}% above market - still workable`;
                    } else {
                        viabilityDiv.style.background = '#fee2e2';
                        viabilityDiv.style.borderColor = '#ef4444';
                        viabilityDiv.style.color = '#dc2626';
                        viabilityDiv.innerHTML = `‚ùå Rate is ${(calculatedRate - marketRate).toFixed(1)}% above market - too expensive`;
                    }
                }

                // Calculate 0% interest scenario suggestions
                function calculateZeroInterestScenario(purchasePrice, targetMonthlyPayment) {
                    if (purchasePrice <= 0 || targetMonthlyPayment <= 0) {
                        document.getElementById('sfZeroInterestDown').textContent = 'Enter valid inputs';
                        document.getElementById('sfZeroInterestTerm').textContent = 'Enter valid inputs';
                        return;
                    }

                    // Calculate minimum down payment needed for various loan terms at 0% interest
                    const termOptions = [10, 15, 20, 25, 30]; // years
                    let bestOption = null;
                    let lowestDownPayment = purchasePrice; // Start with 100% down as worst case

                    termOptions.forEach(termYears => {
                        const termMonths = termYears * 12;
                        // At 0% interest, monthly payment = financed amount / months
                        const maxFinancedAmount = targetMonthlyPayment * termMonths;
                        const requiredDownPayment = purchasePrice - maxFinancedAmount;
                        const downPercent = (requiredDownPayment / purchasePrice) * 100;

                        // Only consider realistic scenarios (down payment between 0% and 100%)
                        if (requiredDownPayment >= 0 && requiredDownPayment <= purchasePrice) {
                            if (requiredDownPayment < lowestDownPayment) {
                                lowestDownPayment = requiredDownPayment;
                                bestOption = {
                                    downPayment: requiredDownPayment,
                                    downPercent: downPercent,
                                    termYears: termYears,
                                    financedAmount: maxFinancedAmount
                                };
                            }
                        }
                    });

                    if (bestOption) {
                        // Display the best 0% interest option
                        document.getElementById('sfZeroInterestDown').textContent =
                            `${formatSFCurrency(bestOption.downPayment)} (${bestOption.downPercent.toFixed(1)}%)`;
                        document.getElementById('sfZeroInterestTerm').textContent =
                            `${bestOption.termYears} years (${formatSFCurrency(bestOption.financedAmount)} financed)`;
                    } else {
                        // No viable 0% interest scenario
                        const maxFinanceableAt30yr = targetMonthlyPayment * 30 * 12;
                        const minDownFor0Percent = purchasePrice - maxFinanceableAt30yr;

                        if (minDownFor0Percent > purchasePrice) {
                            document.getElementById('sfZeroInterestDown').textContent =
                                'Payment too low for 0% financing';
                            document.getElementById('sfZeroInterestTerm').textContent =
                                'Consider higher monthly payment';
                        } else {
                            document.getElementById('sfZeroInterestDown').textContent =
                                `${formatSFCurrency(minDownFor0Percent)} (${((minDownFor0Percent/purchasePrice)*100).toFixed(1)}%)`;
                            document.getElementById('sfZeroInterestTerm').textContent =
                                '30 years (maximum term)';
                        }
                    }
                }

                // Add event listeners to all seller finance input fields
                document.addEventListener('DOMContentLoaded', function() {
                    const sellerFinanceInputs = document.querySelectorAll('#content-seller-finance input, #content-seller-finance select');
                    sellerFinanceInputs.forEach(input => {
                        input.addEventListener('input', calculateSellerFinanceMetrics);
                        input.addEventListener('change', calculateSellerFinanceMetrics);
                    });

                    // Initial calculation
                    calculateSellerFinanceMetrics();
                });
            </script>
        </div>

        <!-- Land Value Estimator Tab -->
        <div id="content-land-value" class="tab-content hidden">
            <style>
                .land-value-container {
                    max-width: 1400px;
                    margin: 0 auto;
                    background: rgba(255, 255, 255, 0.98);
                    border-radius: 20px;
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
                    overflow: hidden;
                }

                .land-value-header {
                    background: linear-gradient(135deg, #1e3a1f, #2c5f2d);
                    color: white;
                    padding: 40px;
                    text-align: center;
                }

                .land-value-header h1 {
                    font-size: 2.8em;
                    margin-bottom: 10px;
                    font-weight: 300;
                }

                .land-value-header p {
                    opacity: 0.9;
                    font-size: 1.2em;
                }

                .land-value-main-content {
                    display: grid;
                    grid-template-columns: 1.2fr 1fr;
                    gap: 0;
                    min-height: 700px;
                }

                .land-value-inputs-section {
                    background: #f8f9fa;
                    border-right: 1px solid #e9ecef;
                    padding: 40px;
                    overflow-y: auto;
                    max-height: 800px;
                }

                .land-value-results-section {
                    padding: 40px;
                    background: white;
                }

                .land-value-section-title {
                    font-size: 1.5em;
                    color: #2c5f2d;
                    margin-bottom: 30px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }

                .land-value-section-title::before {
                    content: '';
                    width: 5px;
                    height: 30px;
                    background: linear-gradient(135deg, #2c5f2d, #97bc62);
                    border-radius: 3px;
                }

                .land-value-input-group {
                    background: white;
                    border-radius: 12px;
                    padding: 25px;
                    margin-bottom: 25px;
                    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.06);
                    border-left: 4px solid transparent;
                    transition: all 0.3s ease;
                }

                .land-value-input-group:hover {
                    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
                    border-left-color: #2c5f2d;
                }

                .land-value-input-group h3 {
                    color: #2c5f2d;
                    margin-bottom: 20px;
                    font-size: 1.2em;
                    font-weight: 600;
                }

                .land-value-form-row {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 15px;
                    margin-bottom: 15px;
                }

                .land-value-form-field {
                    display: flex;
                    flex-direction: column;
                }

                .land-value-form-field.full-width {
                    grid-column: 1 / -1;
                }

                .land-value-form-field label {
                    font-weight: 500;
                    color: #495057;
                    margin-bottom: 6px;
                    font-size: 0.95em;
                }

                .land-value-form-field input[type="number"],
                .land-value-form-field select {
                    padding: 12px 15px;
                    border: 2px solid #e9ecef;
                    border-radius: 8px;
                    font-size: 16px;
                    transition: all 0.3s ease;
                    background: white;
                }

                .land-value-form-field input[type="number"]:focus,
                .land-value-form-field select:focus {
                    outline: none;
                    border-color: #2c5f2d;
                    box-shadow: 0 0 0 3px rgba(44, 95, 45, 0.1);
                }

                .land-value-slider-container {
                    margin-top: 10px;
                }

                .land-value-form-field input[type="range"] {
                    width: 100%;
                    height: 6px;
                    border-radius: 3px;
                    background: #e9ecef;
                    outline: none;
                    -webkit-appearance: none;
                }

                .land-value-form-field input[type="range"]::-webkit-slider-thumb {
                    -webkit-appearance: none;
                    appearance: none;
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    background: #2c5f2d;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }

                .land-value-form-field input[type="range"]::-webkit-slider-thumb:hover {
                    background: #1e3a1f;
                    transform: scale(1.2);
                }

                .land-value-value-display {
                    text-align: center;
                    font-weight: 600;
                    color: #2c5f2d;
                    margin-top: 5px;
                }

                .land-value-result-hero {
                    background: linear-gradient(135deg, #2c5f2d, #97bc62);
                    color: white;
                    padding: 35px;
                    border-radius: 15px;
                    margin-bottom: 30px;
                    box-shadow: 0 10px 30px rgba(44, 95, 45, 0.3);
                    text-align: center;
                }

                .land-value-result-hero h3 {
                    font-size: 1.2em;
                    margin-bottom: 15px;
                    opacity: 0.9;
                    font-weight: 400;
                }

                .land-value-result-hero .value-range {
                    font-size: 2.5em;
                    font-weight: 700;
                    margin-bottom: 10px;
                }

                .land-value-result-hero .per-unit {
                    font-size: 1.2em;
                    opacity: 0.9;
                }

                .land-value-confidence-bar {
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 10px;
                    height: 10px;
                    margin-top: 15px;
                    overflow: hidden;
                }

                .land-value-confidence-fill {
                    height: 100%;
                    background: white;
                    border-radius: 10px;
                    transition: width 0.5s ease;
                }

                .land-value-metrics-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 20px;
                    margin-bottom: 30px;
                }

                .land-value-metric-card {
                    background: #f8f9fa;
                    padding: 20px;
                    border-radius: 12px;
                    text-align: center;
                    border: 2px solid transparent;
                    transition: all 0.3s ease;
                }

                .land-value-metric-card:hover {
                    border-color: #2c5f2d;
                    background: white;
                    transform: translateY(-2px);
                }

                .land-value-metric-card .label {
                    font-size: 0.9em;
                    color: #6c757d;
                    margin-bottom: 10px;
                    font-weight: 500;
                }

                .land-value-metric-card .value {
                    font-size: 1.8em;
                    font-weight: 700;
                    color: #2c5f2d;
                }

                .land-value-drivers {
                    background: #f8f9fa;
                    border-radius: 12px;
                    padding: 25px;
                    margin-bottom: 25px;
                }

                .land-value-drivers h4 {
                    color: #2c5f2d;
                    margin-bottom: 20px;
                    font-size: 1.1em;
                }

                .land-value-driver-item {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 0;
                    border-bottom: 1px solid #e9ecef;
                }

                .land-value-driver-item:last-child {
                    border-bottom: none;
                }

                .land-value-driver-impact {
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 0.85em;
                    font-weight: 600;
                }

                .land-value-impact-positive {
                    background: #d4edda;
                    color: #155724;
                }

                .land-value-impact-negative {
                    background: #f8d7da;
                    color: #721c24;
                }

                .land-value-impact-neutral {
                    background: #d1ecf1;
                    color: #0c5460;
                }

                .land-value-development-scenario {
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    color: white;
                    border-radius: 12px;
                    padding: 25px;
                    margin-top: 25px;
                }

                .land-value-development-scenario h4 {
                    margin-bottom: 15px;
                    font-size: 1.1em;
                }

                .land-value-scenario-stat {
                    display: flex;
                    justify-content: space-between;
                    padding: 8px 0;
                    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
                }

                .land-value-scenario-stat:last-child {
                    border-bottom: none;
                    font-weight: 600;
                }

                .land-value-toggle-unit {
                    background: white;
                    border: 2px solid #2c5f2d;
                    color: #2c5f2d;
                    padding: 8px 20px;
                    border-radius: 20px;
                    cursor: pointer;
                    font-weight: 600;
                    transition: all 0.3s ease;
                    margin-bottom: 15px;
                    display: inline-block;
                }

                .land-value-toggle-unit:hover {
                    background: #2c5f2d;
                    color: white;
                }

                @media (max-width: 1024px) {
                    .land-value-main-content {
                        grid-template-columns: 1fr;
                    }

                    .land-value-inputs-section {
                        border-right: none;
                        border-bottom: 1px solid #e9ecef;
                        max-height: none;
                    }

                    .land-value-metrics-grid {
                        grid-template-columns: 1fr;
                    }
                }

                @media (max-width: 768px) {
                    .land-value-form-row {
                        grid-template-columns: 1fr;
                    }

                    .land-value-header h1 {
                        font-size: 2em;
                    }
                }
            </style>

            <div class="land-value-container">
                <div class="land-value-header">
                    <h1>Land Value Estimator</h1>
                    <p>Comprehensive Property Valuation & Development Analysis</p>
                </div>

                <div class="land-value-main-content">
                    <div class="land-value-inputs-section">
                        <h2 class="land-value-section-title">Property Information</h2>

                        <div class="land-value-input-group">
                            <h3>Basic Details</h3>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landLotSize">Lot Size</label>
                                    <input type="number" id="landLotSize" value="5" min="0" step="0.01" onchange="calculateLandValue()">
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landSizeUnit">Unit</label>
                                    <select id="landSizeUnit" onchange="calculateLandValue()">
                                        <option value="acres">Acres</option>
                                        <option value="sqft">Square Feet</option>
                                    </select>
                                </div>
                            </div>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field full-width">
                                    <label for="landZipCode">Zip Code (Optional)</label>
                                    <input type="number" id="landZipCode" placeholder="12345" onchange="calculateLandValue()">
                                </div>
                            </div>
                        </div>

                        <div class="land-value-input-group">
                            <h3>Zoning & Development</h3>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landZoning">Zoning Type</label>
                                    <select id="landZoning" onchange="calculateLandValue()">
                                        <option value="residential">Residential</option>
                                        <option value="commercial">Commercial</option>
                                        <option value="agricultural">Agricultural</option>
                                        <option value="industrial">Industrial</option>
                                        <option value="mixed">Mixed Use</option>
                                    </select>
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landDensity">Density (units/acre)</label>
                                    <input type="number" id="landDensity" value="4" min="0" step="0.1" onchange="calculateLandValue()">
                                </div>
                            </div>
                        </div>

                        <div class="land-value-input-group">
                            <h3>Physical Characteristics</h3>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landTopography">Topography</label>
                                    <select id="landTopography" onchange="calculateLandValue()">
                                        <option value="flat">Flat</option>
                                        <option value="gentle">Gentle Slope</option>
                                        <option value="moderate">Moderate Slope</option>
                                        <option value="steep">Steep/Hilly</option>
                                    </select>
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landRoadAccess">Road Access</label>
                                    <select id="landRoadAccess" onchange="calculateLandValue()">
                                        <option value="paved">Paved Road</option>
                                        <option value="gravel">Gravel Road</option>
                                        <option value="dirt">Dirt Road</option>
                                        <option value="none">No Direct Access</option>
                                    </select>
                                </div>
                            </div>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landFrontage">Road Frontage (feet)</label>
                                    <input type="number" id="landFrontage" value="200" min="0" onchange="calculateLandValue()">
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landShape">Lot Shape</label>
                                    <select id="landShape" onchange="calculateLandValue()">
                                        <option value="regular">Regular/Rectangular</option>
                                        <option value="irregular">Irregular</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="land-value-input-group">
                            <h3>Utilities & Infrastructure</h3>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landWater">Water Available</label>
                                    <select id="landWater" onchange="calculateLandValue()">
                                        <option value="municipal">Municipal Water</option>
                                        <option value="well">Well Required</option>
                                        <option value="none">None Available</option>
                                    </select>
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landSewer">Sewer System</label>
                                    <select id="landSewer" onchange="calculateLandValue()">
                                        <option value="municipal">Municipal Sewer</option>
                                        <option value="septic">Septic Required</option>
                                        <option value="none">None Available</option>
                                    </select>
                                </div>
                            </div>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landElectric">Electric Available</label>
                                    <select id="landElectric" onchange="calculateLandValue()">
                                        <option value="yes">Yes</option>
                                        <option value="no">No</option>
                                    </select>
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landGas">Natural Gas</label>
                                    <select id="landGas" onchange="calculateLandValue()">
                                        <option value="yes">Yes</option>
                                        <option value="no">No</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="land-value-input-group">
                            <h3>Market Comparables</h3>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field full-width">
                                    <label for="landAvgPricePerAcre">Avg. Price/Acre in Area ($)</label>
                                    <input type="number" id="landAvgPricePerAcre" value="50000" min="0" step="1000" onchange="calculateLandValue()">
                                </div>
                            </div>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landMarketCondition">Market Conditions</label>
                                    <select id="landMarketCondition" onchange="calculateLandValue()">
                                        <option value="hot">Hot Market</option>
                                        <option value="stable" selected>Stable</option>
                                        <option value="cooling">Cooling</option>
                                        <option value="slow">Slow/Buyer's Market</option>
                                    </select>
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landDaysOnMarket">Avg. Days on Market</label>
                                    <input type="number" id="landDaysOnMarket" value="90" min="0" onchange="calculateLandValue()">
                                </div>
                            </div>
                        </div>

                        <div class="land-value-input-group">
                            <h3>Location Quality</h3>
                            <div class="land-value-form-field full-width">
                                <label for="landLocationQuality">Location Multiplier</label>
                                <div class="land-value-slider-container">
                                    <input type="range" id="landLocationQuality" min="70" max="150" value="100" step="5" oninput="updateLandLocationDisplay(); calculateLandValue()">
                                    <div class="land-value-value-display" id="landLocationValue">1.00x (Average)</div>
                                </div>
                            </div>
                        </div>

                        <div class="land-value-input-group">
                            <h3>Special Factors</h3>
                            <div class="land-value-form-row">
                                <div class="land-value-form-field">
                                    <label for="landFloodZone">In Flood Zone</label>
                                    <select id="landFloodZone" onchange="calculateLandValue()">
                                        <option value="no">No</option>
                                        <option value="yes">Yes</option>
                                    </select>
                                </div>
                                <div class="land-value-form-field">
                                    <label for="landWetlands">Wetlands Present</label>
                                    <select id="landWetlands" onchange="calculateLandValue()">
                                        <option value="no">No</option>
                                        <option value="partial">Partial</option>
                                        <option value="significant">Significant</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="land-value-results-section">
                        <h2 class="land-value-section-title">Valuation Results</h2>

                        <button class="land-value-toggle-unit" id="landToggleUnit" onclick="toggleLandDisplayUnit()">Show per Sq Ft</button>

                        <div class="land-value-result-hero">
                            <h3>Estimated Land Value</h3>
                            <div class="value-range" id="landValueRange">$200,000 - $275,000</div>
                            <div class="per-unit" id="landPerUnit">$40,000 - $55,000 per acre</div>
                            <div style="margin-top: 15px; opacity: 0.9;">
                                <div style="font-size: 0.9em; margin-bottom: 5px;">Confidence Score</div>
                                <div class="land-value-confidence-bar">
                                    <div class="land-value-confidence-fill" id="landConfidenceBar" style="width: 75%;"></div>
                                </div>
                                <div style="margin-top: 5px; font-size: 0.9em;" id="landConfidenceText">75% - Good Data Quality</div>
                            </div>
                        </div>

                        <div class="land-value-metrics-grid">
                            <div class="land-value-metric-card">
                                <div class="label">Base Market Value</div>
                                <div class="value" id="landBaseValue">$250,000</div>
                            </div>
                            <div class="land-value-metric-card">
                                <div class="label">Adjusted Value</div>
                                <div class="value" id="landAdjustedValue">$237,500</div>
                            </div>
                            <div class="land-value-metric-card">
                                <div class="label">Value per Acre</div>
                                <div class="value" id="landValuePerAcre">$47,500</div>
                            </div>
                            <div class="land-value-metric-card">
                                <div class="label">Buildable Lots</div>
                                <div class="value" id="landBuildableLots">20</div>
                            </div>
                        </div>

                        <div class="land-value-drivers">
                            <h4>Value Impact Factors</h4>
                            <div class="land-value-driver-item">
                                <span>Location Quality</span>
                                <span class="land-value-driver-impact land-value-impact-neutral" id="landLocationImpact">Neutral</span>
                            </div>
                            <div class="land-value-driver-item">
                                <span>Utilities Available</span>
                                <span class="land-value-driver-impact land-value-impact-positive" id="landUtilitiesImpact">+15%</span>
                            </div>
                            <div class="land-value-driver-item">
                                <span>Road Access</span>
                                <span class="land-value-driver-impact land-value-impact-positive" id="landAccessImpact">Good</span>
                            </div>
                            <div class="land-value-driver-item">
                                <span>Topography</span>
                                <span class="land-value-driver-impact land-value-impact-neutral" id="landTopoImpact">Neutral</span>
                            </div>
                            <div class="land-value-driver-item">
                                <span>Zoning Potential</span>
                                <span class="land-value-driver-impact land-value-impact-positive" id="landZoningImpact">+10%</span>
                            </div>
                        </div>

                        <div class="land-value-development-scenario">
                            <h4>Development Potential Analysis</h4>
                            <div class="land-value-scenario-stat">
                                <span>Potential Buildable Lots:</span>
                                <span id="landDevLots">20 lots</span>
                            </div>
                            <div class="land-value-scenario-stat">
                                <span>Est. Infrastructure Cost:</span>
                                <span id="landInfraCost">$80,000</span>
                            </div>
                            <div class="land-value-scenario-stat">
                                <span>Developed Lot Value:</span>
                                <span id="landLotValue">$25,000 each</span>
                            </div>
                            <div class="land-value-scenario-stat">
                                <span>Total Development Value:</span>
                                <span id="landTotalDevValue">$500,000</span>
                            </div>
                            <div class="land-value-scenario-stat">
                                <span>Potential ROI:</span>
                                <span id="landDevROI">110%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                let landDisplayInSqFt = false;

                function formatLandCurrency(amount) {
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(amount);
                }

                function landAcreToSqFt(acres) {
                    return acres * 43560;
                }

                function landSqFtToAcre(sqft) {
                    return sqft / 43560;
                }

                function getLandSizeInAcres() {
                    const size = parseFloat(document.getElementById('landLotSize').value) || 0;
                    const unit = document.getElementById('landSizeUnit').value;
                    return unit === 'acres' ? size : landSqFtToAcre(size);
                }

                function updateLandLocationDisplay() {
                    const value = document.getElementById('landLocationQuality').value;
                    const multiplier = (value / 100).toFixed(2);
                    let label = 'Average';
                    if (value >= 130) label = 'Excellent';
                    else if (value >= 110) label = 'Above Average';
                    else if (value <= 80) label = 'Below Average';

                    document.getElementById('landLocationValue').textContent = `${multiplier}x (${label})`;
                }

                function toggleLandDisplayUnit() {
                    landDisplayInSqFt = !landDisplayInSqFt;
                    const btn = document.getElementById('landToggleUnit');
                    btn.textContent = landDisplayInSqFt ? 'Show per Acre' : 'Show per Sq Ft';
                    calculateLandValue();
                }

                function calculateLandValue() {
                    // Get inputs
                    const lotSizeAcres = getLandSizeInAcres();
                    const avgPricePerAcre = parseFloat(document.getElementById('landAvgPricePerAcre').value) || 0;
                    const locationMult = parseFloat(document.getElementById('landLocationQuality').value) / 100;
                    const zoning = document.getElementById('landZoning').value;
                    const topography = document.getElementById('landTopography').value;
                    const roadAccess = document.getElementById('landRoadAccess').value;
                    const water = document.getElementById('landWater').value;
                    const sewer = document.getElementById('landSewer').value;
                    const electric = document.getElementById('landElectric').value;
                    const gas = document.getElementById('landGas').value;
                    const marketCondition = document.getElementById('landMarketCondition').value;
                    const floodZone = document.getElementById('landFloodZone').value;
                    const wetlands = document.getElementById('landWetlands').value;
                    const density = parseFloat(document.getElementById('landDensity').value) || 0;
                    const frontage = parseFloat(document.getElementById('landFrontage').value) || 0;
                    const shape = document.getElementById('landShape').value;

                    // Base calculation
                    let baseValue = lotSizeAcres * avgPricePerAcre;
                    let adjustmentFactor = 1.0;

                    // Location adjustment
                    adjustmentFactor *= locationMult;

                    // Topography adjustment
                    const topoAdjustments = {
                        'flat': 1.1,
                        'gentle': 1.0,
                        'moderate': 0.9,
                        'steep': 0.75
                    };
                    adjustmentFactor *= topoAdjustments[topography];

                    // Road access adjustment
                    const roadAdjustments = {
                        'paved': 1.1,
                        'gravel': 1.0,
                        'dirt': 0.9,
                        'none': 0.7
                    };
                    adjustmentFactor *= roadAdjustments[roadAccess];

                    // Utilities adjustment
                    let utilitiesBonus = 0;
                    if (water === 'municipal') utilitiesBonus += 0.05;
                    else if (water === 'well') utilitiesBonus += 0.02;

                    if (sewer === 'municipal') utilitiesBonus += 0.05;
                    else if (sewer === 'septic') utilitiesBonus += 0.02;

                    if (electric === 'yes') utilitiesBonus += 0.03;
                    if (gas === 'yes') utilitiesBonus += 0.02;

                    adjustmentFactor *= (1 + utilitiesBonus);

                    // Zoning adjustment
                    const zoningAdjustments = {
                        'residential': 1.0,
                        'commercial': 1.3,
                        'agricultural': 0.8,
                        'industrial': 1.2,
                        'mixed': 1.15
                    };
                    adjustmentFactor *= zoningAdjustments[zoning];

                    // Market condition adjustment
                    const marketAdjustments = {
                        'hot': 1.15,
                        'stable': 1.0,
                        'cooling': 0.95,
                        'slow': 0.85
                    };
                    adjustmentFactor *= marketAdjustments[marketCondition];

                    // Flood zone penalty
                    if (floodZone === 'yes') adjustmentFactor *= 0.85;

                    // Wetlands penalty
                    const wetlandPenalties = {
                        'no': 1.0,
                        'partial': 0.95,
                        'significant': 0.8
                    };
                    adjustmentFactor *= wetlandPenalties[wetlands];

                    // Shape adjustment
                    if (shape === 'irregular') adjustmentFactor *= 0.95;

                    // Size premium/discount (larger parcels often have lower per-acre value)
                    if (lotSizeAcres > 20) {
                        adjustmentFactor *= 0.9;
                    } else if (lotSizeAcres > 50) {
                        adjustmentFactor *= 0.85;
                    }

                    // Calculate final values
                    const adjustedValue = baseValue * adjustmentFactor;
                    const lowEstimate = adjustedValue * 0.85;
                    const highEstimate = adjustedValue * 1.15;

                    // Development potential
                    const buildableLots = Math.floor(lotSizeAcres * density);
                    const infraCostPerLot = 4000;
                    const totalInfraCost = buildableLots * infraCostPerLot;
                    const avgLotValue = adjustedValue / (buildableLots || 1) * 1.5;
                    const totalDevValue = buildableLots * avgLotValue;
                    const devROI = ((totalDevValue - adjustedValue - totalInfraCost) / adjustedValue) * 100;

                    // Confidence score
                    let confidence = 50;
                    if (avgPricePerAcre > 0) confidence += 20;
                    if (frontage > 0) confidence += 10;
                    if (electric === 'yes') confidence += 10;
                    if (marketCondition !== '') confidence += 10;

                    // Update display
                    const perAcreValue = adjustedValue / lotSizeAcres;
                    const perSqFtValue = perAcreValue / 43560;

                    document.getElementById('landValueRange').textContent =
                        `${formatLandCurrency(lowEstimate)} - ${formatLandCurrency(highEstimate)}`;

                    if (landDisplayInSqFt && lotSizeAcres > 0) {
                        const lowPerSqFt = (lowEstimate / landAcreToSqFt(lotSizeAcres)).toFixed(2);
                        const highPerSqFt = (highEstimate / landAcreToSqFt(lotSizeAcres)).toFixed(2);
                        document.getElementById('landPerUnit').textContent =
                            `$${lowPerSqFt} - $${highPerSqFt} per sq ft`;
                    } else if (lotSizeAcres > 0) {
                        const lowPerAcre = (lowEstimate / lotSizeAcres).toFixed(0);
                        const highPerAcre = (highEstimate / lotSizeAcres).toFixed(0);
                        document.getElementById('landPerUnit').textContent =
                            `${formatLandCurrency(lowPerAcre)} - ${formatLandCurrency(highPerAcre)} per acre`;
                    }

                    document.getElementById('landBaseValue').textContent = formatLandCurrency(baseValue);
                    document.getElementById('landAdjustedValue').textContent = formatLandCurrency(adjustedValue);
                    document.getElementById('landValuePerAcre').textContent = formatLandCurrency(perAcreValue);
                    document.getElementById('landBuildableLots').textContent = buildableLots;

                    // Confidence
                    document.getElementById('landConfidenceBar').style.width = confidence + '%';
                    let confidenceLabel = 'Limited Data';
                    if (confidence >= 80) confidenceLabel = 'Excellent Data';
                    else if (confidence >= 60) confidenceLabel = 'Good Data';
                    document.getElementById('landConfidenceText').textContent = `${confidence}% - ${confidenceLabel}`;

                    // Value drivers
                    document.getElementById('landLocationImpact').textContent =
                        locationMult >= 1.1 ? '+' + ((locationMult - 1) * 100).toFixed(0) + '%' :
                        locationMult <= 0.9 ? ((locationMult - 1) * 100).toFixed(0) + '%' : 'Neutral';
                    document.getElementById('landLocationImpact').className =
                        'land-value-driver-impact ' + (locationMult >= 1.1 ? 'land-value-impact-positive' :
                        locationMult <= 0.9 ? 'land-value-impact-negative' : 'land-value-impact-neutral');

                    const utilTotal = (utilitiesBonus * 100).toFixed(0);
                    document.getElementById('landUtilitiesImpact').textContent = '+' + utilTotal + '%';
                    document.getElementById('landUtilitiesImpact').className =
                        'land-value-driver-impact ' + (utilitiesBonus > 0.1 ? 'land-value-impact-positive' : 'land-value-impact-neutral');

                    document.getElementById('landAccessImpact').textContent =
                        roadAccess === 'paved' ? 'Excellent' :
                        roadAccess === 'gravel' ? 'Good' :
                        roadAccess === 'dirt' ? 'Fair' : 'Poor';
                    document.getElementById('landAccessImpact').className =
                        'land-value-driver-impact ' + (roadAccess === 'paved' ? 'land-value-impact-positive' :
                        roadAccess === 'none' ? 'land-value-impact-negative' : 'land-value-impact-neutral');

                    document.getElementById('landTopoImpact').textContent =
                        topography === 'flat' ? '+10%' :
                        topography === 'gentle' ? 'Neutral' :
                        topography === 'moderate' ? '-10%' : '-25%';
                    document.getElementById('landTopoImpact').className =
                        'land-value-driver-impact ' + (topography === 'flat' ? 'land-value-impact-positive' :
                        topography === 'steep' ? 'land-value-impact-negative' : 'land-value-impact-neutral');

                    const zoningBonus = ((zoningAdjustments[zoning] - 1) * 100).toFixed(0);
                    document.getElementById('landZoningImpact').textContent =
                        zoningBonus >= 0 ? '+' + zoningBonus + '%' : zoningBonus + '%';
                    document.getElementById('landZoningImpact').className =
                        'land-value-driver-impact ' + (zoningBonus >= 10 ? 'land-value-impact-positive' : 'land-value-impact-neutral');

                    // Development scenario
                    document.getElementById('landDevLots').textContent = buildableLots + ' lots';
                    document.getElementById('landInfraCost').textContent = formatLandCurrency(totalInfraCost);
                    document.getElementById('landLotValue').textContent = formatLandCurrency(avgLotValue) + ' each';
                    document.getElementById('landTotalDevValue').textContent = formatLandCurrency(totalDevValue);
                    document.getElementById('landDevROI').textContent = devROI.toFixed(0) + '%';
                }

                // Initialize land value calculator
                document.addEventListener('DOMContentLoaded', function() {
                    updateLandLocationDisplay();
                    calculateLandValue();
                });
            </script>
        </div>

        <!-- Novation Calculator Tab -->
        <div id="content-novation-calculator" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üî¨ Novation Calculator</h2>
                <button onclick="clearNovationCalculator()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear Calculator
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>What is Novation?</strong> A novation replaces an existing obligation with a new one. In real estate, this involves taking over the seller's existing mortgage payments while securing the property through a separate purchase agreement.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Column: Property & Loan Details -->
                <div class="space-y-6">
                    <!-- Property Information -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üè† Property Information</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Address</label>
                                <input type="text" id="novation-property-address" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="123 Main St, City, State">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Current Market Value</label>
                                <input type="number" id="novation-market-value" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="250000" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Estimated Repair Costs</label>
                                <input type="number" id="novation-repair-costs" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="15000" onchange="calculateNovation()">
                            </div>
                        </div>
                    </div>

                    <!-- Existing Loan Details -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üí∞ Existing Loan Details</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Current Loan Balance</label>
                                <input type="number" id="novation-loan-balance" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="180000" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Monthly Payment (P&I)</label>
                                <input type="number" id="novation-monthly-payment" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="1250" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Interest Rate (%)</label>
                                <input type="number" id="novation-interest-rate" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="3.5" step="0.1" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Years Remaining</label>
                                <input type="number" id="novation-years-remaining" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="25" onchange="calculateNovation()">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Financial Analysis -->
                <div class="space-y-6">
                    <!-- Deal Analysis -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üìä Deal Analysis</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-700">Market Value:</span>
                                <span class="text-lg font-bold text-gray-900" id="novation-display-market-value">$0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-700">Loan Balance:</span>
                                <span class="text-lg font-bold text-red-600" id="novation-display-loan-balance">$0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-medium text-gray-700">Repair Costs:</span>
                                <span class="text-lg font-bold text-red-600" id="novation-display-repair-costs">$0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-green-50 border border-green-200 rounded-lg">
                                <span class="font-semibold text-green-800">Instant Equity:</span>
                                <span class="text-xl font-bold text-green-600" id="novation-instant-equity">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Cash Flow -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üíµ Monthly Cash Flow</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Expected Monthly Rent</label>
                                <input type="number" id="novation-monthly-rent" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="1800" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Taxes (Monthly)</label>
                                <input type="number" id="novation-property-taxes" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="300" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Insurance (Monthly)</label>
                                <input type="number" id="novation-insurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="150" onchange="calculateNovation()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Maintenance/Vacancy (Monthly)</label>
                                <input type="number" id="novation-maintenance" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="200" onchange="calculateNovation()">
                            </div>

                            <div class="border-t pt-4">
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-2">
                                    <span class="font-medium text-gray-700">Monthly Income:</span>
                                    <span class="text-lg font-bold text-green-600" id="novation-monthly-income">$0</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-2">
                                    <span class="font-medium text-gray-700">Monthly Expenses:</span>
                                    <span class="text-lg font-bold text-red-600" id="novation-monthly-expenses">$0</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                    <span class="font-semibold text-blue-800">Net Cash Flow:</span>
                                    <span class="text-xl font-bold" id="novation-net-cash-flow">$0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Key Metrics -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üìà Key Metrics</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center p-3 bg-gray-50 rounded-lg">
                                <div class="text-2xl font-bold text-blue-600" id="novation-cash-on-cash">0%</div>
                                <div class="text-sm text-gray-600">Cash-on-Cash ROI</div>
                            </div>
                            <div class="text-center p-3 bg-gray-50 rounded-lg">
                                <div class="text-2xl font-bold text-green-600" id="novation-cap-rate">0%</div>
                                <div class="text-sm text-gray-600">Cap Rate</div>
                            </div>
                            <div class="text-center p-3 bg-gray-50 rounded-lg">
                                <div class="text-2xl font-bold text-purple-600" id="novation-ltv">0%</div>
                                <div class="text-sm text-gray-600">Loan-to-Value</div>
                            </div>
                            <div class="text-center p-3 bg-gray-50 rounded-lg">
                                <div class="text-2xl font-bold text-orange-600" id="novation-dscr">0.00</div>
                                <div class="text-sm text-gray-600">Debt Service Coverage</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Risk Assessment -->
            <div class="mt-8 bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-yellow-800">‚ö†Ô∏è Risk Assessment & Legal Considerations</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-yellow-800 mb-2">Key Risks:</h4>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>‚Ä¢ Due-on-sale clause may trigger loan acceleration</li>
                            <li>‚Ä¢ Original borrower remains liable for the debt</li>
                            <li>‚Ä¢ Insurance and title complications</li>
                            <li>‚Ä¢ Potential violations of lender agreements</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-yellow-800 mb-2">Recommended Actions:</h4>
                        <ul class="text-sm text-yellow-700 space-y-1">
                            <li>‚Ä¢ Consult with real estate attorney</li>
                            <li>‚Ä¢ Review all loan documents carefully</li>
                            <li>‚Ä¢ Consider proper insurance coverage</li>
                            <li>‚Ä¢ Establish clear agreements with seller</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Export Options -->
            <div class="mt-6 flex justify-center">
                <button onclick="exportNovationAnalysis()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    üìÑ Export Analysis Report
                </button>
            </div>

            <!-- JavaScript for Novation Calculator -->
            <script>
                function calculateNovation() {
                    // Get input values
                    const marketValue = parseFloat(document.getElementById('novation-market-value').value) || 0;
                    const repairCosts = parseFloat(document.getElementById('novation-repair-costs').value) || 0;
                    const loanBalance = parseFloat(document.getElementById('novation-loan-balance').value) || 0;
                    const monthlyPayment = parseFloat(document.getElementById('novation-monthly-payment').value) || 0;
                    const interestRate = parseFloat(document.getElementById('novation-interest-rate').value) || 0;
                    const yearsRemaining = parseFloat(document.getElementById('novation-years-remaining').value) || 0;
                    const monthlyRent = parseFloat(document.getElementById('novation-monthly-rent').value) || 0;
                    const propertyTaxes = parseFloat(document.getElementById('novation-property-taxes').value) || 0;
                    const insurance = parseFloat(document.getElementById('novation-insurance').value) || 0;
                    const maintenance = parseFloat(document.getElementById('novation-maintenance').value) || 0;

                    // Calculate instant equity
                    const instantEquity = marketValue - loanBalance - repairCosts;

                    // Calculate monthly cash flow
                    const monthlyIncome = monthlyRent;
                    const monthlyExpenses = monthlyPayment + propertyTaxes + insurance + maintenance;
                    const netCashFlow = monthlyIncome - monthlyExpenses;

                    // Calculate key metrics
                    const annualCashFlow = netCashFlow * 12;
                    const totalInvestment = repairCosts; // Assuming minimal down payment in novation
                    const cashOnCashROI = totalInvestment > 0 ? (annualCashFlow / totalInvestment) * 100 : 0;
                    const capRate = marketValue > 0 ? (annualCashFlow / marketValue) * 100 : 0;
                    const ltv = marketValue > 0 ? (loanBalance / marketValue) * 100 : 0;
                    const dscr = monthlyPayment > 0 ? monthlyIncome / monthlyPayment : 0;

                    // Update displays
                    document.getElementById('novation-display-market-value').textContent = '$' + marketValue.toLocaleString();
                    document.getElementById('novation-display-loan-balance').textContent = '$' + loanBalance.toLocaleString();
                    document.getElementById('novation-display-repair-costs').textContent = '$' + repairCosts.toLocaleString();
                    document.getElementById('novation-instant-equity').textContent = '$' + instantEquity.toLocaleString();

                    document.getElementById('novation-monthly-income').textContent = '$' + monthlyIncome.toLocaleString();
                    document.getElementById('novation-monthly-expenses').textContent = '$' + monthlyExpenses.toLocaleString();

                    // Color code cash flow
                    const cashFlowElement = document.getElementById('novation-net-cash-flow');
                    cashFlowElement.textContent = '$' + netCashFlow.toLocaleString();
                    if (netCashFlow > 0) {
                        cashFlowElement.className = 'text-xl font-bold text-green-600';
                    } else {
                        cashFlowElement.className = 'text-xl font-bold text-red-600';
                    }

                    document.getElementById('novation-cash-on-cash').textContent = cashOnCashROI.toFixed(1) + '%';
                    document.getElementById('novation-cap-rate').textContent = capRate.toFixed(1) + '%';
                    document.getElementById('novation-ltv').textContent = ltv.toFixed(1) + '%';
                    document.getElementById('novation-dscr').textContent = dscr.toFixed(2);
                }

                function clearNovationCalculator() {
                    // Clear all input fields
                    const inputs = document.querySelectorAll('#content-novation-calculator input');
                    inputs.forEach(input => input.value = '');

                    // Reset all displays
                    document.getElementById('novation-display-market-value').textContent = '$0';
                    document.getElementById('novation-display-loan-balance').textContent = '$0';
                    document.getElementById('novation-display-repair-costs').textContent = '$0';
                    document.getElementById('novation-instant-equity').textContent = '$0';
                    document.getElementById('novation-monthly-income').textContent = '$0';
                    document.getElementById('novation-monthly-expenses').textContent = '$0';
                    document.getElementById('novation-net-cash-flow').textContent = '$0';
                    document.getElementById('novation-net-cash-flow').className = 'text-xl font-bold';
                    document.getElementById('novation-cash-on-cash').textContent = '0%';
                    document.getElementById('novation-cap-rate').textContent = '0%';
                    document.getElementById('novation-ltv').textContent = '0%';
                    document.getElementById('novation-dscr').textContent = '0.00';
                }

                function exportNovationAnalysis() {
                    const propertyAddress = document.getElementById('novation-property-address').value || 'Property Address Not Specified';
                    const marketValue = parseFloat(document.getElementById('novation-market-value').value) || 0;
                    const loanBalance = parseFloat(document.getElementById('novation-loan-balance').value) || 0;
                    const repairCosts = parseFloat(document.getElementById('novation-repair-costs').value) || 0;
                    const monthlyRent = parseFloat(document.getElementById('novation-monthly-rent').value) || 0;
                    const monthlyPayment = parseFloat(document.getElementById('novation-monthly-payment').value) || 0;

                    const instantEquity = marketValue - loanBalance - repairCosts;
                    const monthlyIncome = monthlyRent;
                    const monthlyExpenses = monthlyPayment +
                        (parseFloat(document.getElementById('novation-property-taxes').value) || 0) +
                        (parseFloat(document.getElementById('novation-insurance').value) || 0) +
                        (parseFloat(document.getElementById('novation-maintenance').value) || 0);
                    const netCashFlow = monthlyIncome - monthlyExpenses;

                    const reportContent = `NOVATION DEAL ANALYSIS REPORT
Generated: ${new Date().toLocaleDateString()}

PROPERTY INFORMATION
Address: ${propertyAddress}
Market Value: $${marketValue.toLocaleString()}
Repair Costs: $${repairCosts.toLocaleString()}

EXISTING LOAN DETAILS
Current Balance: $${loanBalance.toLocaleString()}
Monthly Payment: $${monthlyPayment.toLocaleString()}
Interest Rate: ${document.getElementById('novation-interest-rate').value}%
Years Remaining: ${document.getElementById('novation-years-remaining').value}

FINANCIAL ANALYSIS
Instant Equity: $${instantEquity.toLocaleString()}
Monthly Rent: $${monthlyIncome.toLocaleString()}
Total Monthly Expenses: $${monthlyExpenses.toLocaleString()}
Net Cash Flow: $${netCashFlow.toLocaleString()}

KEY METRICS
Cash-on-Cash ROI: ${document.getElementById('novation-cash-on-cash').textContent}
Cap Rate: ${document.getElementById('novation-cap-rate').textContent}
Loan-to-Value: ${document.getElementById('novation-ltv').textContent}
Debt Service Coverage: ${document.getElementById('novation-dscr').textContent}

RISK DISCLAIMER
This analysis is for educational purposes only. Novation strategies involve significant legal and financial risks including potential due-on-sale clause violations. Always consult with qualified legal and financial professionals before proceeding.

Generated by Enriched Property Solutions LLC - Wholesaling Tools`;

                    const blob = new Blob([reportContent], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Novation_Analysis_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }
            </script>
        </div>

        <!-- Motivated Seller Lead Scorer Tab -->
        <div id="content-lead-scorer" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üéØ Motivated Seller Lead Scorer</h2>
                <button onclick="clearLeadScorer()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear Scorer
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>How it works:</strong> This tool analyzes multiple data points to score leads based on seller motivation and deal potential. Higher scores indicate better prospects for wholesale deals.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column: Property Information -->
                <div class="space-y-6">
                    <!-- Basic Property Info -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üè† Property Information</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Address</label>
                                <input type="text" id="lead-property-address" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="123 Main St, City, State">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Type</label>
                                <select id="lead-property-type" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Type</option>
                                    <option value="single-family">Single Family Home</option>
                                    <option value="multi-family">Multi-Family (2-4 units)</option>
                                    <option value="condo">Condominium</option>
                                    <option value="townhouse">Townhouse</option>
                                    <option value="vacant-land">Vacant Land</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Estimated Value</label>
                                <input type="number" id="lead-estimated-value" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="250000" onchange="calculateLeadScore()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Year Built</label>
                                <input type="number" id="lead-year-built" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="1995" onchange="calculateLeadScore()">
                            </div>
                        </div>
                    </div>

                    <!-- Distress Indicators -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚ö†Ô∏è Distress Indicators</h3>
                        <div class="space-y-3">
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-foreclosure" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Pre-foreclosure/NOD filed</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-tax-liens" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Tax liens/delinquent taxes</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-code-violations" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Code violations</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-vacant" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Property appears vacant</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-probate" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Probate/estate sale</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-divorce" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Divorce proceeding</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="lead-bankruptcy" class="mr-2" onchange="calculateLeadScore()">
                                <span class="text-sm">Bankruptcy filing</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Middle Column: Market & Timing -->
                <div class="space-y-6">
                    <!-- Market Factors -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üìä Market Factors</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Days on Market (if listed)</label>
                                <input type="number" id="lead-days-on-market" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="0" onchange="calculateLeadScore()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Number of Price Reductions</label>
                                <input type="number" id="lead-price-reductions" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="0" onchange="calculateLeadScore()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Neighborhood Condition</label>
                                <select id="lead-neighborhood" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Condition</option>
                                    <option value="excellent">Excellent</option>
                                    <option value="good">Good</option>
                                    <option value="average">Average</option>
                                    <option value="declining">Declining</option>
                                    <option value="poor">Poor</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Condition</label>
                                <select id="lead-property-condition" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Condition</option>
                                    <option value="excellent">Excellent</option>
                                    <option value="good">Good</option>
                                    <option value="fair">Fair</option>
                                    <option value="poor">Poor</option>
                                    <option value="distressed">Distressed</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Seller Motivation -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üí≠ Seller Motivation</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Urgency Level</label>
                                <select id="lead-urgency" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Urgency</option>
                                    <option value="immediate">Immediate (< 30 days)</option>
                                    <option value="urgent">Urgent (1-3 months)</option>
                                    <option value="moderate">Moderate (3-6 months)</option>
                                    <option value="flexible">Flexible (6+ months)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Seller Situation</label>
                                <select id="lead-seller-situation" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Situation</option>
                                    <option value="job-loss">Job loss/income reduction</option>
                                    <option value="relocation">Job relocation</option>
                                    <option value="medical">Medical emergency</option>
                                    <option value="inheritance">Inherited property</option>
                                    <option value="investment">Investment property</option>
                                    <option value="downsizing">Downsizing</option>
                                    <option value="retirement">Retirement</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Flexibility on Price</label>
                                <select id="lead-price-flexibility" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Flexibility</option>
                                    <option value="very-flexible">Very flexible</option>
                                    <option value="somewhat-flexible">Somewhat flexible</option>
                                    <option value="firm">Price is firm</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Competition & Score -->
                <div class="space-y-6">
                    <!-- Competition Analysis -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üèÉ Competition Analysis</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Other Wholesaler Activity</label>
                                <select id="lead-competition" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Level</option>
                                    <option value="none">No competition detected</option>
                                    <option value="low">Low competition</option>
                                    <option value="moderate">Moderate competition</option>
                                    <option value="high">High competition</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Previous Contact Attempts</label>
                                <input type="number" id="lead-contact-attempts" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="0" onchange="calculateLeadScore()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Lead Source</label>
                                <select id="lead-source" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateLeadScore()">
                                    <option value="">Select Source</option>
                                    <option value="public-records">Public records</option>
                                    <option value="direct-mail">Direct mail response</option>
                                    <option value="cold-call">Cold call</option>
                                    <option value="referral">Referral</option>
                                    <option value="online">Online marketing</option>
                                    <option value="networking">Networking</option>
                                    <option value="driving-for-dollars">Driving for dollars</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Lead Score Display -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üéØ Lead Score</h3>
                        <div class="text-center mb-6">
                            <div class="text-6xl font-bold mb-2" id="lead-total-score">0</div>
                            <div class="text-lg font-medium text-gray-600" id="lead-score-rating">No Rating</div>
                            <div class="w-full bg-gray-200 rounded-full h-4 mt-4">
                                <div class="h-4 rounded-full transition-all duration-500" id="lead-score-bar" style="width: 0%; background: linear-gradient(to right, #ef4444, #f59e0b, #10b981);"></div>
                            </div>
                        </div>

                        <!-- Score Breakdown -->
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Distress Factors:</span>
                                <span class="font-semibold" id="distress-score">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Market Factors:</span>
                                <span class="font-semibold" id="market-score">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Motivation:</span>
                                <span class="font-semibold" id="motivation-score">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Competition:</span>
                                <span class="font-semibold" id="competition-score">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Priority Actions -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚ö° Priority Actions</h3>
                        <div id="priority-actions" class="space-y-2 text-sm">
                            <p class="text-gray-500">Complete the form to see recommended actions</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Score Interpretation Guide -->
            <div class="mt-8 bg-gray-50 border border-gray-200 rounded-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üìã Score Interpretation Guide</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="text-center p-4 bg-red-100 rounded-lg">
                        <div class="text-2xl font-bold text-red-600">0-25</div>
                        <div class="text-sm font-medium text-red-800">Low Priority</div>
                        <div class="text-xs text-red-600 mt-1">Follow up in 30+ days</div>
                    </div>
                    <div class="text-center p-4 bg-yellow-100 rounded-lg">
                        <div class="text-2xl font-bold text-yellow-600">26-50</div>
                        <div class="text-sm font-medium text-yellow-800">Medium Priority</div>
                        <div class="text-xs text-yellow-600 mt-1">Follow up in 2-3 weeks</div>
                    </div>
                    <div class="text-center p-4 bg-blue-100 rounded-lg">
                        <div class="text-2xl font-bold text-blue-600">51-75</div>
                        <div class="text-sm font-medium text-blue-800">High Priority</div>
                        <div class="text-xs text-blue-600 mt-1">Follow up in 1 week</div>
                    </div>
                    <div class="text-center p-4 bg-green-100 rounded-lg">
                        <div class="text-2xl font-bold text-green-600">76-100</div>
                        <div class="text-sm font-medium text-green-800">Urgent</div>
                        <div class="text-xs text-green-600 mt-1">Contact immediately</div>
                    </div>
                </div>
            </div>

            <!-- Export Options -->
            <div class="mt-6 flex justify-center gap-4">
                <button onclick="exportLeadScore()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    üìÑ Export Lead Report
                </button>
                <button onclick="addToFollowUp()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium">
                    üìÖ Add to Follow-up List
                </button>
            </div>

            <!-- JavaScript for Lead Scorer -->
            <script>
                function calculateLeadScore() {
                    let totalScore = 0;
                    let distressScore = 0;
                    let marketScore = 0;
                    let motivationScore = 0;
                    let competitionScore = 0;

                    // Distress Indicators (0-30 points)
                    if (document.getElementById('lead-foreclosure').checked) distressScore += 8;
                    if (document.getElementById('lead-tax-liens').checked) distressScore += 6;
                    if (document.getElementById('lead-code-violations').checked) distressScore += 4;
                    if (document.getElementById('lead-vacant').checked) distressScore += 5;
                    if (document.getElementById('lead-probate').checked) distressScore += 7;
                    if (document.getElementById('lead-divorce').checked) distressScore += 6;
                    if (document.getElementById('lead-bankruptcy').checked) distressScore += 8;

                    // Market Factors (0-25 points)
                    const daysOnMarket = parseInt(document.getElementById('lead-days-on-market').value) || 0;
                    if (daysOnMarket > 180) marketScore += 8;
                    else if (daysOnMarket > 90) marketScore += 5;
                    else if (daysOnMarket > 30) marketScore += 3;

                    const priceReductions = parseInt(document.getElementById('lead-price-reductions').value) || 0;
                    marketScore += Math.min(priceReductions * 3, 9);

                    const neighborhood = document.getElementById('lead-neighborhood').value;
                    const neighborhoodScores = { 'poor': 5, 'declining': 4, 'average': 2, 'good': 1, 'excellent': 0 };
                    marketScore += neighborhoodScores[neighborhood] || 0;

                    const propertyCondition = document.getElementById('lead-property-condition').value;
                    const conditionScores = { 'distressed': 6, 'poor': 4, 'fair': 2, 'good': 1, 'excellent': 0 };
                    marketScore += conditionScores[propertyCondition] || 0;

                    // Seller Motivation (0-30 points)
                    const urgency = document.getElementById('lead-urgency').value;
                    const urgencyScores = { 'immediate': 12, 'urgent': 8, 'moderate': 4, 'flexible': 1 };
                    motivationScore += urgencyScores[urgency] || 0;

                    const situation = document.getElementById('lead-seller-situation').value;
                    const situationScores = {
                        'job-loss': 10, 'medical': 9, 'inheritance': 8, 'relocation': 6,
                        'investment': 5, 'downsizing': 4, 'retirement': 3, 'other': 2
                    };
                    motivationScore += situationScores[situation] || 0;

                    const flexibility = document.getElementById('lead-price-flexibility').value;
                    const flexibilityScores = { 'very-flexible': 8, 'somewhat-flexible': 4, 'firm': 1 };
                    motivationScore += flexibilityScores[flexibility] || 0;

                    // Competition Analysis (0-15 points)
                    const competition = document.getElementById('lead-competition').value;
                    const competitionScores = { 'none': 8, 'low': 5, 'moderate': 2, 'high': 0 };
                    competitionScore += competitionScores[competition] || 0;

                    const contactAttempts = parseInt(document.getElementById('lead-contact-attempts').value) || 0;
                    if (contactAttempts === 0) competitionScore += 4;
                    else if (contactAttempts <= 2) competitionScore += 2;

                    const source = document.getElementById('lead-source').value;
                    const sourceScores = {
                        'referral': 3, 'direct-mail': 2, 'networking': 2, 'public-records': 1,
                        'driving-for-dollars': 1, 'online': 1, 'cold-call': 0
                    };
                    competitionScore += sourceScores[source] || 0;

                    // Calculate total score
                    totalScore = distressScore + marketScore + motivationScore + competitionScore;

                    // Update displays
                    document.getElementById('lead-total-score').textContent = totalScore;
                    document.getElementById('distress-score').textContent = distressScore;
                    document.getElementById('market-score').textContent = marketScore;
                    document.getElementById('motivation-score').textContent = motivationScore;
                    document.getElementById('competition-score').textContent = competitionScore;

                    // Update score rating and color
                    let rating = '';
                    let color = '';
                    if (totalScore >= 76) {
                        rating = 'URGENT - Contact Immediately';
                        color = 'text-green-600';
                    } else if (totalScore >= 51) {
                        rating = 'HIGH PRIORITY';
                        color = 'text-blue-600';
                    } else if (totalScore >= 26) {
                        rating = 'MEDIUM PRIORITY';
                        color = 'text-yellow-600';
                    } else {
                        rating = 'LOW PRIORITY';
                        color = 'text-red-600';
                    }

                    document.getElementById('lead-score-rating').textContent = rating;
                    document.getElementById('lead-score-rating').className = `text-lg font-medium ${color}`;
                    document.getElementById('lead-total-score').className = `text-6xl font-bold mb-2 ${color}`;

                    // Update progress bar
                    const percentage = Math.min(totalScore, 100);
                    document.getElementById('lead-score-bar').style.width = percentage + '%';

                    // Update priority actions
                    updatePriorityActions(totalScore, distressScore, motivationScore);
                }

                function updatePriorityActions(totalScore, distressScore, motivationScore) {
                    const actionsDiv = document.getElementById('priority-actions');
                    let actions = [];

                    if (totalScore >= 76) {
                        actions.push('üö® Call within 24 hours');
                        actions.push('üìß Send immediate follow-up email');
                        actions.push('üè† Schedule property visit ASAP');
                        if (distressScore > 15) actions.push('‚ö° Consider cash offer');
                    } else if (totalScore >= 51) {
                        actions.push('üìû Call within 3-5 days');
                        actions.push('üì¨ Send targeted direct mail');
                        actions.push('üîç Research comparable sales');
                        if (motivationScore > 15) actions.push('üí∞ Prepare multiple offer scenarios');
                    } else if (totalScore >= 26) {
                        actions.push('üìÖ Schedule follow-up in 2 weeks');
                        actions.push('üìä Monitor for status changes');
                        actions.push('üéØ Add to nurture campaign');
                    } else {
                        actions.push('üìà Re-evaluate in 30+ days');
                        actions.push('üîÑ Add to long-term follow-up');
                        actions.push('üìù Look for trigger events');
                    }

                    actionsDiv.innerHTML = actions.map(action => `<p class="flex items-center text-sm"><span class="mr-2">${action.split(' ')[0]}</span>${action.substring(2)}</p>`).join('');
                }

                function clearLeadScorer() {
                    // Clear all inputs
                    const inputs = document.querySelectorAll('#content-lead-scorer input, #content-lead-scorer select');
                    inputs.forEach(input => {
                        if (input.type === 'checkbox') {
                            input.checked = false;
                        } else {
                            input.value = '';
                        }
                    });

                    // Reset displays
                    document.getElementById('lead-total-score').textContent = '0';
                    document.getElementById('lead-score-rating').textContent = 'No Rating';
                    document.getElementById('lead-score-rating').className = 'text-lg font-medium text-gray-600';
                    document.getElementById('lead-total-score').className = 'text-6xl font-bold mb-2';
                    document.getElementById('distress-score').textContent = '0';
                    document.getElementById('market-score').textContent = '0';
                    document.getElementById('motivation-score').textContent = '0';
                    document.getElementById('competition-score').textContent = '0';
                    document.getElementById('lead-score-bar').style.width = '0%';
                    document.getElementById('priority-actions').innerHTML = '<p class="text-gray-500">Complete the form to see recommended actions</p>';
                }

                function exportLeadScore() {
                    const address = document.getElementById('lead-property-address').value || 'Address Not Specified';
                    const totalScore = document.getElementById('lead-total-score').textContent;
                    const rating = document.getElementById('lead-score-rating').textContent;

                    const reportContent = `MOTIVATED SELLER LEAD SCORE REPORT
Generated: ${new Date().toLocaleDateString()}

PROPERTY INFORMATION
Address: ${address}
Property Type: ${document.getElementById('lead-property-type').value}
Estimated Value: $${(document.getElementById('lead-estimated-value').value || 0).toLocaleString()}
Year Built: ${document.getElementById('lead-year-built').value}

LEAD SCORE ANALYSIS
Total Score: ${totalScore}/100
Priority Rating: ${rating}

SCORE BREAKDOWN
Distress Factors: ${document.getElementById('distress-score').textContent}
Market Factors: ${document.getElementById('market-score').textContent}
Seller Motivation: ${document.getElementById('motivation-score').textContent}
Competition Analysis: ${document.getElementById('competition-score').textContent}

PRIORITY ACTIONS
${Array.from(document.querySelectorAll('#priority-actions p')).map(p => p.textContent).join('\n')}

NEXT STEPS
${totalScore >= 76 ? 'URGENT: Contact immediately within 24 hours' :
  totalScore >= 51 ? 'HIGH: Follow up within 1 week' :
  totalScore >= 26 ? 'MEDIUM: Follow up within 2-3 weeks' :
  'LOW: Follow up in 30+ days'}

Generated by Enriched Property Solutions LLC - Lead Scorer Tool`;

                    const blob = new Blob([reportContent], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Lead_Score_${address.replace(/[^a-zA-Z0-9]/g, '_')}_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }

                function addToFollowUp() {
                    const address = document.getElementById('lead-property-address').value || 'Address Not Specified';
                    const score = document.getElementById('lead-total-score').textContent;
                    const rating = document.getElementById('lead-score-rating').textContent;

                    alert(`Lead Added to Follow-up List!\n\nProperty: ${address}\nScore: ${score}/100\nPriority: ${rating}\n\nThis feature can be integrated with your CRM system.`);
                }
            </script>
        </div>

        <!-- Hedge Fund Package Calculator Tab -->
        <div id="content-hedge-fund-calculator" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üè¶ Hedge Fund Package Calculator</h2>
                <button onclick="clearHedgeFundCalculator()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear Calculator
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>Institutional Package Builder:</strong> Structure property portfolios for hedge fund and institutional investor presentations. Calculate volume discounts, due diligence timelines, and ROI projections that meet institutional investment criteria.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Left Column: Portfolio Configuration -->
                <div class="space-y-6">
                    <!-- Package Overview -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üì¶ Portfolio Package Overview</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Package Name</label>
                                <input type="text" id="hf-package-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Southeast Residential Portfolio Q4-2024">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Target Market</label>
                                <select id="hf-target-market" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateHedgeFund()">
                                    <option value="">Select Market</option>
                                    <option value="southeast">Southeast Markets</option>
                                    <option value="midwest">Midwest Markets</option>
                                    <option value="southwest">Southwest Markets</option>
                                    <option value="northeast">Northeast Markets</option>
                                    <option value="national">National Portfolio</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Number of Properties</label>
                                <input type="number" id="hf-property-count" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="25" onchange="calculateHedgeFund()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Package Type</label>
                                <select id="hf-package-type" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateHedgeFund()">
                                    <option value="">Select Type</option>
                                    <option value="rental-ready">Rental Ready</option>
                                    <option value="light-rehab">Light Rehab Required</option>
                                    <option value="heavy-rehab">Heavy Rehab Required</option>
                                    <option value="mixed">Mixed Condition</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Metrics -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üí∞ Financial Metrics</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Total Package Value</label>
                                <input type="number" id="hf-total-value" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="5000000" onchange="calculateHedgeFund()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Average Property Value</label>
                                <input type="number" id="hf-avg-property-value" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="200000" readonly>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Total Renovation Budget</label>
                                <input type="number" id="hf-renovation-budget" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="500000" onchange="calculateHedgeFund()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Expected Annual Rent Roll</label>
                                <input type="number" id="hf-annual-rent" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="600000" onchange="calculateHedgeFund()">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Institutional Requirements -->
                <div class="space-y-6">
                    <!-- Volume Discounts -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üìä Volume Discount Structure</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Base Discount (%)</label>
                                <input type="number" id="hf-base-discount" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="5" step="0.1" onchange="calculateHedgeFund()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Volume Tier Bonus (%)</label>
                                <select id="hf-volume-bonus" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateHedgeFund()">
                                    <option value="0">No Bonus (1-10 properties)</option>
                                    <option value="2">2% Bonus (11-25 properties)</option>
                                    <option value="5">5% Bonus (26-50 properties)</option>
                                    <option value="8">8% Bonus (51-100 properties)</option>
                                    <option value="12">12% Bonus (100+ properties)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Cash Closing Bonus (%)</label>
                                <input type="number" id="hf-cash-bonus" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="2" step="0.1" onchange="calculateHedgeFund()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Quick Close Bonus (< 30 days) (%)</label>
                                <input type="number" id="hf-quick-close-bonus" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="1" step="0.1" onchange="calculateHedgeFund()">
                            </div>
                        </div>
                    </div>

                    <!-- Due Diligence Timeline -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">‚è±Ô∏è Due Diligence Timeline</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Inspection Period (Days)</label>
                                <select id="hf-inspection-period" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateHedgeFund()">
                                    <option value="15">15 Days (Premium)</option>
                                    <option value="30">30 Days (Standard)</option>
                                    <option value="45">45 Days (Extended)</option>
                                    <option value="60">60 Days (Comprehensive)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Financing Contingency (Days)</label>
                                <input type="number" id="hf-financing-days" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="45" onchange="calculateHedgeFund()">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Total Closing Timeline (Days)</label>
                                <input type="number" id="hf-closing-timeline" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="60" readonly>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Earnest Money (%)</label>
                                <select id="hf-earnest-money" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculateHedgeFund()">
                                    <option value="0.5">0.5% (Minimum)</option>
                                    <option value="1">1% (Standard)</option>
                                    <option value="2">2% (Premium)</option>
                                    <option value="3">3% (High Confidence)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Package Analysis Results -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                <!-- Pricing Analysis -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üíµ Pricing Analysis</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                            <span class="font-medium text-gray-700">Original Package Value:</span>
                            <span class="text-lg font-bold text-gray-900" id="hf-original-value">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                            <span class="font-medium text-gray-700">Total Discounts:</span>
                            <span class="text-lg font-bold text-red-600" id="hf-total-discounts">0%</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-green-50 border border-green-200 rounded-lg">
                            <span class="font-semibold text-green-800">Final Package Price:</span>
                            <span class="text-xl font-bold text-green-600" id="hf-final-price">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-blue-50 border border-blue-200 rounded-lg">
                            <span class="font-semibold text-blue-800">Total Savings:</span>
                            <span class="text-xl font-bold text-blue-600" id="hf-total-savings">$0</span>
                        </div>
                    </div>
                </div>

                <!-- ROI Projections -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üìà ROI Projections</h3>
                    <div class="space-y-4">
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600" id="hf-gross-yield">0%</div>
                            <div class="text-sm text-gray-600">Gross Rental Yield</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600" id="hf-net-yield">0%</div>
                            <div class="text-sm text-gray-600">Net Yield (After Renovation)</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600" id="hf-cap-rate">0%</div>
                            <div class="text-sm text-gray-600">Estimated Cap Rate</div>
                        </div>
                        <div class="text-center p-3 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-orange-600" id="hf-irr">0%</div>
                            <div class="text-sm text-gray-600">Projected 5-Year IRR</div>
                        </div>
                    </div>
                </div>

                <!-- Package Metrics -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üìä Package Metrics</h3>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                            <span class="font-medium text-gray-700">Avg Price/Property:</span>
                            <span class="text-lg font-bold text-gray-900" id="hf-avg-price-property">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                            <span class="font-medium text-gray-700">Renovation/Property:</span>
                            <span class="text-lg font-bold text-gray-900" id="hf-renovation-per-property">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                            <span class="font-medium text-gray-700">Annual Rent/Property:</span>
                            <span class="text-lg font-bold text-gray-900" id="hf-rent-per-property">$0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                            <span class="font-medium text-gray-700">Earnest Money Required:</span>
                            <span class="text-lg font-bold text-gray-900" id="hf-earnest-amount">$0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Institutional Requirements Checklist -->
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-8">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">‚úÖ Institutional Requirements Checklist</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Documentation Required:</h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li class="flex items-center"><span class="mr-2">üìã</span>Property condition reports</li>
                            <li class="flex items-center"><span class="mr-2">üè†</span>Title reports (preliminary)</li>
                            <li class="flex items-center"><span class="mr-2">üí∞</span>Rent roll projections</li>
                            <li class="flex items-center"><span class="mr-2">üìä</span>Market analysis reports</li>
                            <li class="flex items-center"><span class="mr-2">üîß</span>Renovation cost estimates</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Package Standards:</h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li class="flex items-center"><span class="mr-2" id="min-properties-check">‚ùå</span>Minimum 10 properties</li>
                            <li class="flex items-center"><span class="mr-2" id="value-threshold-check">‚ùå</span>$2M+ total value</li>
                            <li class="flex items-center"><span class="mr-2" id="yield-threshold-check">‚ùå</span>6%+ gross yield</li>
                            <li class="flex items-center"><span class="mr-2" id="geography-check">‚ùå</span>Geographic concentration</li>
                            <li class="flex items-center"><span class="mr-2" id="timeline-check">‚ùå</span>Reasonable due diligence</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Competitive Advantages:</h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li class="flex items-center"><span class="mr-2" id="volume-discount-check">‚ùå</span>Volume discount applied</li>
                            <li class="flex items-center"><span class="mr-2" id="cash-bonus-check">‚ùå</span>Cash closing incentive</li>
                            <li class="flex items-center"><span class="mr-2" id="quick-close-check">‚ùå</span>Quick close bonus</li>
                            <li class="flex items-center"><span class="mr-2" id="assignable-check">‚úÖ</span>Assignable contracts</li>
                            <li class="flex items-center"><span class="mr-2" id="track-record-check">‚úÖ</span>Proven wholesaler track record</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Export and Presentation Tools -->
            <div class="mt-6 flex justify-center gap-4 flex-wrap">
                <button onclick="exportHedgeFundPackage()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    üìÑ Export Package Summary
                </button>
                <button onclick="generatePitchDeck()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium">
                    üìä Generate Pitch Deck
                </button>
                <button onclick="calculateDueDiligence()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                    üîç Due Diligence Checklist
                </button>
                <button onclick="contactInvestors()" class="bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition-colors font-medium">
                    üìû Investor Contact List
                </button>
            </div>

            <!-- JavaScript for Hedge Fund Calculator -->
            <script>
                function calculateHedgeFund() {
                    // Get input values
                    const propertyCount = parseInt(document.getElementById('hf-property-count').value) || 0;
                    const totalValue = parseFloat(document.getElementById('hf-total-value').value) || 0;
                    const renovationBudget = parseFloat(document.getElementById('hf-renovation-budget').value) || 0;
                    const annualRent = parseFloat(document.getElementById('hf-annual-rent').value) || 0;
                    const baseDiscount = parseFloat(document.getElementById('hf-base-discount').value) || 0;
                    const volumeBonus = parseFloat(document.getElementById('hf-volume-bonus').value) || 0;
                    const cashBonus = parseFloat(document.getElementById('hf-cash-bonus').value) || 0;
                    const quickCloseBonus = parseFloat(document.getElementById('hf-quick-close-bonus').value) || 0;
                    const inspectionPeriod = parseInt(document.getElementById('hf-inspection-period').value) || 30;
                    const financingDays = parseInt(document.getElementById('hf-financing-days').value) || 45;
                    const earnestMoney = parseFloat(document.getElementById('hf-earnest-money').value) || 1;

                    // Calculate derived values
                    const avgPropertyValue = propertyCount > 0 ? totalValue / propertyCount : 0;
                    const totalDiscountPercent = baseDiscount + volumeBonus + cashBonus + quickCloseBonus;
                    const totalDiscountAmount = totalValue * (totalDiscountPercent / 100);
                    const finalPrice = totalValue - totalDiscountAmount;
                    const totalInvestment = finalPrice + renovationBudget;
                    const closingTimeline = Math.max(inspectionPeriod, financingDays);
                    const earnestAmount = finalPrice * (earnestMoney / 100);

                    // Calculate ROI metrics
                    const grossYield = totalValue > 0 ? (annualRent / totalValue) * 100 : 0;
                    const netYield = totalInvestment > 0 ? (annualRent / totalInvestment) * 100 : 0;
                    const capRate = netYield * 0.8; // Assume 20% expense ratio
                    const projectedIRR = capRate + 3; // Simplified IRR estimation

                    // Calculate per-property metrics
                    const avgPricePerProperty = propertyCount > 0 ? finalPrice / propertyCount : 0;
                    const renovationPerProperty = propertyCount > 0 ? renovationBudget / propertyCount : 0;
                    const rentPerProperty = propertyCount > 0 ? annualRent / propertyCount : 0;

                    // Update displays
                    document.getElementById('hf-avg-property-value').value = avgPropertyValue.toFixed(0);
                    document.getElementById('hf-closing-timeline').value = closingTimeline;

                    document.getElementById('hf-original-value').textContent = '$' + totalValue.toLocaleString();
                    document.getElementById('hf-total-discounts').textContent = totalDiscountPercent.toFixed(1) + '%';
                    document.getElementById('hf-final-price').textContent = '$' + finalPrice.toLocaleString();
                    document.getElementById('hf-total-savings').textContent = '$' + totalDiscountAmount.toLocaleString();

                    document.getElementById('hf-gross-yield').textContent = grossYield.toFixed(1) + '%';
                    document.getElementById('hf-net-yield').textContent = netYield.toFixed(1) + '%';
                    document.getElementById('hf-cap-rate').textContent = capRate.toFixed(1) + '%';
                    document.getElementById('hf-irr').textContent = projectedIRR.toFixed(1) + '%';

                    document.getElementById('hf-avg-price-property').textContent = '$' + avgPricePerProperty.toLocaleString();
                    document.getElementById('hf-renovation-per-property').textContent = '$' + renovationPerProperty.toLocaleString();
                    document.getElementById('hf-rent-per-property').textContent = '$' + rentPerProperty.toLocaleString();
                    document.getElementById('hf-earnest-amount').textContent = '$' + earnestAmount.toLocaleString();

                    // Update institutional requirements checklist
                    updateInstitutionalChecklist(propertyCount, totalValue, grossYield, totalDiscountPercent, cashBonus, quickCloseBonus);
                }

                function updateInstitutionalChecklist(propertyCount, totalValue, grossYield, totalDiscountPercent, cashBonus, quickCloseBonus) {
                    // Check minimum properties
                    document.getElementById('min-properties-check').textContent = propertyCount >= 10 ? '‚úÖ' : '‚ùå';

                    // Check value threshold
                    document.getElementById('value-threshold-check').textContent = totalValue >= 2000000 ? '‚úÖ' : '‚ùå';

                    // Check yield threshold
                    document.getElementById('yield-threshold-check').textContent = grossYield >= 6 ? '‚úÖ' : '‚ùå';

                    // Check geography (simplified - assume concentrated if single market selected)
                    const targetMarket = document.getElementById('hf-target-market').value;
                    document.getElementById('geography-check').textContent = targetMarket && targetMarket !== 'national' ? '‚úÖ' : '‚ùå';

                    // Check reasonable timeline
                    const timeline = parseInt(document.getElementById('hf-closing-timeline').value) || 0;
                    document.getElementById('timeline-check').textContent = timeline <= 60 ? '‚úÖ' : '‚ùå';

                    // Check volume discount
                    document.getElementById('volume-discount-check').textContent = totalDiscountPercent > 5 ? '‚úÖ' : '‚ùå';

                    // Check cash bonus
                    document.getElementById('cash-bonus-check').textContent = cashBonus > 0 ? '‚úÖ' : '‚ùå';

                    // Check quick close bonus
                    document.getElementById('quick-close-check').textContent = quickCloseBonus > 0 ? '‚úÖ' : '‚ùå';
                }

                function clearHedgeFundCalculator() {
                    // Clear all input fields
                    const inputs = document.querySelectorAll('#content-hedge-fund-calculator input, #content-hedge-fund-calculator select');
                    inputs.forEach(input => {
                        if (input.type !== 'button') {
                            input.value = '';
                        }
                    });

                    // Reset all displays
                    document.getElementById('hf-original-value').textContent = '$0';
                    document.getElementById('hf-total-discounts').textContent = '0%';
                    document.getElementById('hf-final-price').textContent = '$0';
                    document.getElementById('hf-total-savings').textContent = '$0';
                    document.getElementById('hf-gross-yield').textContent = '0%';
                    document.getElementById('hf-net-yield').textContent = '0%';
                    document.getElementById('hf-cap-rate').textContent = '0%';
                    document.getElementById('hf-irr').textContent = '0%';
                    document.getElementById('hf-avg-price-property').textContent = '$0';
                    document.getElementById('hf-renovation-per-property').textContent = '$0';
                    document.getElementById('hf-rent-per-property').textContent = '$0';
                    document.getElementById('hf-earnest-amount').textContent = '$0';

                    // Reset checklist
                    const checkmarks = ['min-properties-check', 'value-threshold-check', 'yield-threshold-check',
                                      'geography-check', 'timeline-check', 'volume-discount-check', 'cash-bonus-check', 'quick-close-check'];
                    checkmarks.forEach(id => {
                        document.getElementById(id).textContent = '‚ùå';
                    });
                    document.getElementById('assignable-check').textContent = '‚úÖ';
                    document.getElementById('track-record-check').textContent = '‚úÖ';
                }

                function exportHedgeFundPackage() {
                    const packageName = document.getElementById('hf-package-name').value || 'Hedge Fund Package';
                    const propertyCount = document.getElementById('hf-property-count').value || '0';
                    const finalPrice = document.getElementById('hf-final-price').textContent;
                    const grossYield = document.getElementById('hf-gross-yield').textContent;

                    const reportContent = `HEDGE FUND PROPERTY PACKAGE SUMMARY
Generated: ${new Date().toLocaleDateString()}

PACKAGE OVERVIEW
Package Name: ${packageName}
Number of Properties: ${propertyCount}
Target Market: ${document.getElementById('hf-target-market').value}
Package Type: ${document.getElementById('hf-package-type').value}

FINANCIAL SUMMARY
Original Package Value: ${document.getElementById('hf-original-value').textContent}
Total Discounts Applied: ${document.getElementById('hf-total-discounts').textContent}
Final Package Price: ${finalPrice}
Total Savings: ${document.getElementById('hf-total-savings').textContent}

ROI PROJECTIONS
Gross Rental Yield: ${grossYield}
Net Yield (After Renovation): ${document.getElementById('hf-net-yield').textContent}
Estimated Cap Rate: ${document.getElementById('hf-cap-rate').textContent}
Projected 5-Year IRR: ${document.getElementById('hf-irr').textContent}

PACKAGE METRICS
Average Price per Property: ${document.getElementById('hf-avg-price-property').textContent}
Renovation Budget per Property: ${document.getElementById('hf-renovation-per-property').textContent}
Annual Rent per Property: ${document.getElementById('hf-rent-per-property').textContent}
Earnest Money Required: ${document.getElementById('hf-earnest-amount').textContent}

DUE DILIGENCE TIMELINE
Inspection Period: ${document.getElementById('hf-inspection-period').value} days
Financing Contingency: ${document.getElementById('hf-financing-days').value} days
Total Closing Timeline: ${document.getElementById('hf-closing-timeline').value} days

COMPETITIVE ADVANTAGES
- Volume discount pricing structure
- Institutional-grade documentation
- Proven wholesaler track record
- Assignable contract terms
- Comprehensive market analysis

NEXT STEPS
1. Review detailed property list and condition reports
2. Conduct market analysis validation
3. Finalize financing arrangements
4. Execute purchase agreements
5. Begin due diligence process

Generated by Enriched Property Solutions LLC - Hedge Fund Calculator`;

                    const blob = new Blob([reportContent], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${packageName.replace(/[^a-zA-Z0-9]/g, '_')}_Package_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }

                function generatePitchDeck() {
                    alert('Pitch Deck Generator\n\nThis feature would create a professional presentation including:\n\n‚Ä¢ Executive Summary\n‚Ä¢ Market Overview\n‚Ä¢ Property Portfolio Details\n‚Ä¢ Financial Projections\n‚Ä¢ Risk Analysis\n‚Ä¢ Investment Highlights\n\nIntegration with PowerPoint/Google Slides APIs would enable automated deck generation.');
                }

                function calculateDueDiligence() {
                    const propertyCount = document.getElementById('hf-property-count').value || 0;
                    const timeline = document.getElementById('hf-closing-timeline').value || 0;

                    alert(`Due Diligence Checklist Generated\n\nFor ${propertyCount} properties with ${timeline}-day timeline:\n\n‚úÖ Property inspections (Days 1-15)\n‚úÖ Title searches (Days 1-20)\n‚úÖ Market analysis validation (Days 5-25)\n‚úÖ Financial document review (Days 10-30)\n‚úÖ Legal document preparation (Days 20-40)\n‚úÖ Final approval process (Days 40-${timeline})\n\nThis checklist can be exported and integrated with project management tools.`);
                }

                function contactInvestors() {
                    alert('Institutional Investor Contact List\n\nThis feature would provide access to:\n\nüè¶ Hedge Fund Contacts\nüè¢ Private Equity Firms\nüí∞ Family Offices\nüèòÔ∏è REITs\nüìä Investment Groups\n\nFiltered by:\n‚Ä¢ Investment size preferences\n‚Ä¢ Geographic focus\n‚Ä¢ Property type specialization\n‚Ä¢ Recent acquisition activity\n\nCRM integration available for lead management.');
                }
            </script>
        </div>

        <!-- Seller Psychology Profiler Tab -->
        <div id="content-seller-psychology" class="tab-content hidden">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900">üé≠ Seller Psychology Profiler</h2>
                <button onclick="clearSellerPsychology()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                    Clear Profile
                </button>
            </div>

            <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-800"><strong>Negotiation Intelligence:</strong> Analyze seller psychology, communication style, and motivation triggers to optimize your approach and increase deal success rates.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Left Column: Assessment Questions -->
                <div class="space-y-6">
                    <!-- Seller Background -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üë§ Seller Background</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Seller Name/Contact</label>
                                <input type="text" id="sp-seller-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="John & Mary Smith">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Age Range</label>
                                <select id="sp-age-range" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Age Range</option>
                                    <option value="20-30">20-30 years old</option>
                                    <option value="31-45">31-45 years old</option>
                                    <option value="46-60">46-60 years old</option>
                                    <option value="61-75">61-75 years old</option>
                                    <option value="75+">75+ years old</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Educational Background</label>
                                <select id="sp-education" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Education Level</option>
                                    <option value="high-school">High School</option>
                                    <option value="some-college">Some College</option>
                                    <option value="bachelors">Bachelor's Degree</option>
                                    <option value="advanced">Advanced Degree</option>
                                    <option value="trade">Trade School/Technical</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Profession/Career</label>
                                <select id="sp-profession" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Profession</option>
                                    <option value="executive">Executive/Management</option>
                                    <option value="professional">Professional (Doctor, Lawyer, etc.)</option>
                                    <option value="teacher">Teacher/Education</option>
                                    <option value="sales">Sales/Marketing</option>
                                    <option value="healthcare">Healthcare Worker</option>
                                    <option value="tradesman">Skilled Tradesman</option>
                                    <option value="retired">Retired</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Communication Style Assessment -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üí¨ Communication Style</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Initial Contact Response</label>
                                <select id="sp-initial-response" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Response Style</option>
                                    <option value="immediate">Responded immediately</option>
                                    <option value="quick">Responded within hours</option>
                                    <option value="delayed">Took 1-2 days to respond</option>
                                    <option value="very-delayed">Took several days to respond</option>
                                    <option value="reluctant">Seemed reluctant to respond</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Communication Preference</label>
                                <select id="sp-comm-preference" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Preference</option>
                                    <option value="phone">Prefers phone calls</option>
                                    <option value="text">Prefers text messages</option>
                                    <option value="email">Prefers email</option>
                                    <option value="in-person">Prefers in-person meetings</option>
                                    <option value="mixed">No strong preference</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Speaking Style</label>
                                <select id="sp-speaking-style" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Speaking Style</option>
                                    <option value="direct">Direct and to the point</option>
                                    <option value="detailed">Detailed and thorough</option>
                                    <option value="emotional">Emotional and personal</option>
                                    <option value="analytical">Analytical and data-focused</option>
                                    <option value="storytelling">Tells stories and rambles</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Decision Making Speed</label>
                                <select id="sp-decision-speed" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Decision Speed</option>
                                    <option value="immediate">Makes decisions quickly</option>
                                    <option value="deliberate">Takes time to think</option>
                                    <option value="consultative">Needs to consult others</option>
                                    <option value="anxious">Seems anxious about decisions</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Motivation & Situation -->
                <div class="space-y-6">
                    <!-- Motivation Triggers -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üéØ Motivation Triggers</h3>
                        <div class="space-y-3">
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-financial-stress" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Financial stress/hardship</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-time-pressure" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Time pressure/urgency</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-family-situation" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Family situation changes</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-convenience" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Convenience/simplicity</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-health-issues" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Health/age-related issues</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-property-burden" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Property is a burden</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="sp-investment-focus" class="mr-2" onchange="calculatePsychology()">
                                <span class="text-sm">Investment/business minded</span>
                            </label>
                        </div>
                    </div>

                    <!-- Emotional State -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üòä Emotional State</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Overall Emotional State</label>
                                <select id="sp-emotional-state" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Emotional State</option>
                                    <option value="stressed">Stressed/Overwhelmed</option>
                                    <option value="optimistic">Optimistic/Positive</option>
                                    <option value="frustrated">Frustrated/Annoyed</option>
                                    <option value="sad">Sad/Depressed</option>
                                    <option value="excited">Excited/Enthusiastic</option>
                                    <option value="neutral">Neutral/Calm</option>
                                    <option value="suspicious">Suspicious/Guarded</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Trust Level</label>
                                <select id="sp-trust-level" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Trust Level</option>
                                    <option value="high">High - Trusts easily</option>
                                    <option value="moderate">Moderate - Cautious but reasonable</option>
                                    <option value="low">Low - Very skeptical</option>
                                    <option value="previous-bad">Had previous bad experience</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Negotiation Approach</label>
                                <select id="sp-negotiation-style" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Negotiation Style</option>
                                    <option value="collaborative">Collaborative - Seeks win-win</option>
                                    <option value="competitive">Competitive - Wants to "win"</option>
                                    <option value="accommodating">Accommodating - Avoids conflict</option>
                                    <option value="analytical">Analytical - Wants all the facts</option>
                                    <option value="emotional">Emotional - Makes heart-based decisions</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Situational Factors -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">üè† Situational Factors</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Property Ownership Duration</label>
                                <select id="sp-ownership-duration" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Duration</option>
                                    <option value="less-1">Less than 1 year</option>
                                    <option value="1-5">1-5 years</option>
                                    <option value="5-15">5-15 years</option>
                                    <option value="15-30">15-30 years</option>
                                    <option value="30-plus">30+ years</option>
                                    <option value="inherited">Inherited property</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Previous Selling Experience</label>
                                <select id="sp-selling-experience" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Experience</option>
                                    <option value="first-time">First time seller</option>
                                    <option value="limited">Limited experience</option>
                                    <option value="experienced">Experienced seller</option>
                                    <option value="investor">Real estate investor</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-semibold mb-2">Current Market Knowledge</label>
                                <select id="sp-market-knowledge" class="w-full px-4 py-3 border border-gray-300 rounded-lg" onchange="calculatePsychology()">
                                    <option value="">Select Knowledge Level</option>
                                    <option value="high">High - Very informed</option>
                                    <option value="moderate">Moderate - Some research done</option>
                                    <option value="low">Low - Little knowledge</option>
                                    <option value="misinformed">Misinformed about value</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Psychology Profile Results -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
                <!-- Psychology Type -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üß† Psychology Profile</h3>
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-2" id="sp-profile-icon">üé≠</div>
                        <div class="text-xl font-bold mb-2" id="sp-profile-type">Complete Assessment</div>
                        <div class="text-sm text-gray-600" id="sp-profile-description">Fill out the assessment to see seller profile</div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Analytical Score:</span>
                            <span class="font-semibold" id="sp-analytical-score">0%</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Emotional Score:</span>
                            <span class="font-semibold" id="sp-emotional-score">0%</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Trust Level:</span>
                            <span class="font-semibold" id="sp-trust-score">0%</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Urgency Level:</span>
                            <span class="font-semibold" id="sp-urgency-score">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Communication Strategy -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üí¨ Communication Strategy</h3>
                    <div id="sp-communication-strategy" class="space-y-3 text-sm">
                        <p class="text-gray-500">Complete assessment to see personalized communication recommendations</p>
                    </div>
                </div>

                <!-- Negotiation Tactics -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">üéØ Negotiation Tactics</h3>
                    <div id="sp-negotiation-tactics" class="space-y-3 text-sm">
                        <p class="text-gray-500">Complete assessment to see recommended negotiation approach</p>
                    </div>
                </div>
            </div>

            <!-- Objection Handling & Scripts -->
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-8">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üó£Ô∏è Objection Handling & Scripts</h3>
                <div id="sp-objection-handling" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Common Objections:</h4>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p class="text-gray-500">Complete assessment to see likely objections and responses</p>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Recommended Scripts:</h4>
                        <div class="text-sm text-gray-700 space-y-2">
                            <p class="text-gray-500">Complete assessment to see personalized conversation starters</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Follow-up Strategy -->
            <div class="bg-white rounded-lg shadow p-6 mb-8">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">üìÖ Follow-up Strategy</h3>
                <div id="sp-followup-strategy" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Timing:</h4>
                        <p class="text-sm text-gray-500" id="sp-followup-timing">Complete assessment for timing recommendations</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Method:</h4>
                        <p class="text-sm text-gray-500" id="sp-followup-method">Complete assessment for method recommendations</p>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">Message Tone:</h4>
                        <p class="text-sm text-gray-500" id="sp-followup-tone">Complete assessment for tone recommendations</p>
                    </div>
                </div>
            </div>

            <!-- Export and Tools -->
            <div class="mt-6 flex justify-center gap-4 flex-wrap">
                <button onclick="exportSellerProfile()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    üìÑ Export Seller Profile
                </button>
                <button onclick="generateNegotiationPlan()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium">
                    üìã Generate Negotiation Plan
                </button>
            </div>

            <!-- JavaScript for Seller Psychology -->
            <script>
                function calculatePsychology() {
                    console.log('calculatePsychology() called');

                    // Get all input values
                    const ageRange = document.getElementById('sp-age-range').value;
                    const education = document.getElementById('sp-education').value;
                    const profession = document.getElementById('sp-profession').value;
                    const initialResponse = document.getElementById('sp-initial-response').value;
                    const commPreference = document.getElementById('sp-comm-preference').value;
                    const speakingStyle = document.getElementById('sp-speaking-style').value;
                    const decisionSpeed = document.getElementById('sp-decision-speed').value;
                    const emotionalState = document.getElementById('sp-emotional-state').value;
                    const trustLevel = document.getElementById('sp-trust-level').value;
                    const negotiationStyle = document.getElementById('sp-negotiation-style').value;
                    const ownershipDuration = document.getElementById('sp-ownership-duration').value;
                    const sellingExperience = document.getElementById('sp-selling-experience').value;
                    const marketKnowledge = document.getElementById('sp-market-knowledge').value;

                    // Check motivation triggers
                    const motivationTriggers = [];
                    if (document.getElementById('sp-financial-stress').checked) motivationTriggers.push('financial');
                    if (document.getElementById('sp-time-pressure').checked) motivationTriggers.push('time');
                    if (document.getElementById('sp-family-situation').checked) motivationTriggers.push('family');
                    if (document.getElementById('sp-convenience').checked) motivationTriggers.push('convenience');
                    if (document.getElementById('sp-health-issues').checked) motivationTriggers.push('health');
                    if (document.getElementById('sp-property-burden').checked) motivationTriggers.push('burden');
                    if (document.getElementById('sp-investment-focus').checked) motivationTriggers.push('investment');

                    console.log('Input values:', { ageRange, education, profession, initialResponse, commPreference, speakingStyle, decisionSpeed, emotionalState, trustLevel, negotiationStyle, ownershipDuration, sellingExperience, marketKnowledge, motivationTriggers });

                    // Calculate scores
                    let analyticalScore = 0;
                    let emotionalScore = 0;
                    let trustScore = 0;
                    let urgencyScore = 0;

                    // Analytical score factors
                    if (education === 'bachelors' || education === 'advanced') analyticalScore += 20;
                    if (profession === 'executive' || profession === 'professional') analyticalScore += 15;
                    if (speakingStyle === 'analytical' || speakingStyle === 'detailed') analyticalScore += 25;
                    if (negotiationStyle === 'analytical') analyticalScore += 20;
                    if (marketKnowledge === 'high' || marketKnowledge === 'moderate') analyticalScore += 15;

                    // Emotional score factors
                    if (speakingStyle === 'emotional' || speakingStyle === 'storytelling') emotionalScore += 25;
                    if (emotionalState === 'stressed' || emotionalState === 'sad' || emotionalState === 'frustrated') emotionalScore += 20;
                    if (negotiationStyle === 'emotional' || negotiationStyle === 'accommodating') emotionalScore += 20;
                    if (motivationTriggers.includes('family') || motivationTriggers.includes('health')) emotionalScore += 15;
                    if (ownershipDuration === '15-30' || ownershipDuration === '30-plus') emotionalScore += 15;

                    // Trust score factors
                    if (trustLevel === 'high') trustScore += 40;
                    else if (trustLevel === 'moderate') trustScore += 25;
                    else if (trustLevel === 'low') trustScore += 10;
                    else if (trustLevel === 'previous-bad') trustScore += 5;

                    if (initialResponse === 'immediate' || initialResponse === 'quick') trustScore += 15;
                    if (emotionalState === 'optimistic' || emotionalState === 'excited') trustScore += 10;

                    // Urgency score factors
                    if (motivationTriggers.includes('financial') || motivationTriggers.includes('time')) urgencyScore += 25;
                    if (emotionalState === 'stressed' || emotionalState === 'frustrated') urgencyScore += 20;
                    if (initialResponse === 'immediate') urgencyScore += 15;
                    if (decisionSpeed === 'immediate') urgencyScore += 20;
                    if (decisionSpeed === 'anxious') urgencyScore += 25;

                    // Determine primary psychology type
                    let profileType = '';
                    let profileIcon = '';
                    let profileDescription = '';

                    if (analyticalScore > emotionalScore && analyticalScore > 50) {
                        profileType = 'The Analyzer';
                        profileIcon = 'üîç';
                        profileDescription = 'Data-driven, logical, needs facts and proof';
                    } else if (emotionalScore > analyticalScore && emotionalScore > 50) {
                        profileType = 'The Emotional Decision Maker';
                        profileIcon = '‚ù§Ô∏è';
                        profileDescription = 'Heart-driven, personal connections matter';
                    } else if (trustScore < 30) {
                        profileType = 'The Skeptic';
                        profileIcon = 'ü§î';
                        profileDescription = 'Cautious, needs credibility and social proof';
                    } else if (urgencyScore > 60) {
                        profileType = 'The Urgent Seller';
                        profileIcon = '‚ö°';
                        profileDescription = 'Time-sensitive, motivated to act quickly';
                    } else if (motivationTriggers.includes('convenience')) {
                        profileType = 'The Convenience Seeker';
                        profileIcon = 'üéØ';
                        profileDescription = 'Values simplicity and ease of process';
                    } else {
                        profileType = 'The Balanced Seller';
                        profileIcon = '‚öñÔ∏è';
                        profileDescription = 'Moderate approach, flexible negotiation style';
                    }

                    console.log('Calculated scores:', { analyticalScore, emotionalScore, trustScore, urgencyScore });
                    console.log('Profile determined:', { profileType, profileIcon, profileDescription });

                    // Update displays
                    document.getElementById('sp-profile-type').textContent = profileType;
                    document.getElementById('sp-profile-icon').textContent = profileIcon;
                    document.getElementById('sp-profile-description').textContent = profileDescription;
                    document.getElementById('sp-analytical-score').textContent = Math.min(analyticalScore, 100) + '%';
                    document.getElementById('sp-emotional-score').textContent = Math.min(emotionalScore, 100) + '%';
                    document.getElementById('sp-trust-score').textContent = Math.min(trustScore, 100) + '%';
                    document.getElementById('sp-urgency-score').textContent = Math.min(urgencyScore, 100) + '%';

                    console.log('Display elements updated');

                    // Generate communication strategy
                    updateCommunicationStrategy(profileType, analyticalScore, emotionalScore, trustScore, commPreference);

                    // Generate negotiation tactics
                    updateNegotiationTactics(profileType, negotiationStyle, urgencyScore, motivationTriggers);

                    // Generate objection handling
                    updateObjectionHandling(profileType, trustScore, sellingExperience, marketKnowledge);

                    // Generate follow-up strategy
                    updateFollowupStrategy(profileType, decisionSpeed, urgencyScore, commPreference);
                }

                function updateCommunicationStrategy(profileType, analytical, emotional, trust, commPref) {
                    const strategyDiv = document.getElementById('sp-communication-strategy');
                    let strategies = [];

                    if (profileType === 'The Analyzer') {
                        strategies = [
                            'üìä Lead with facts and market data',
                            'üìã Provide written documentation',
                            '‚è∞ Allow time for decision making',
                            'üî¢ Use specific numbers and comparisons'
                        ];
                    } else if (profileType === 'The Emotional Decision Maker') {
                        strategies = [
                            'ü§ù Build personal rapport first',
                            'üíù Focus on benefits to family',
                            'üìñ Share success stories',
                            '‚ù§Ô∏è Use empathetic language'
                        ];
                    } else if (profileType === 'The Skeptic') {
                        strategies = [
                            '‚≠ê Provide references and testimonials',
                            'üèÜ Highlight credentials and experience',
                            'üìÑ Offer transparent documentation',
                            'üîí Address concerns directly'
                        ];
                    } else if (profileType === 'The Urgent Seller') {
                        strategies = [
                            '‚ö° Emphasize quick closing process',
                            'üìû Respond immediately to inquiries',
                            'üéØ Focus on solving their time problem',
                            'üí® Streamline paperwork and decisions'
                        ];
                    } else {
                        strategies = [
                            '‚öñÔ∏è Balance facts with personal touch',
                            'ü§ù Build trust through consistency',
                            'üìã Provide options and flexibility',
                            'üí¨ Match their communication style'
                        ];
                    }

                    strategyDiv.innerHTML = strategies.map(strategy =>
                        `<p class="flex items-start"><span class="mr-2">${strategy.split(' ')[0]}</span>${strategy.substring(2)}</p>`
                    ).join('');
                }

                function updateNegotiationTactics(profileType, negotiationStyle, urgency, triggers) {
                    const tacticsDiv = document.getElementById('sp-negotiation-tactics');
                    let tactics = [];

                    if (urgency > 60) {
                        tactics = [
                            'üí∞ Lead with cash offer benefits',
                            'üìÖ Emphasize quick closing timeline',
                            'üéØ Address their urgency directly',
                            '‚ö° Create win-win solutions'
                        ];
                    } else if (profileType === 'The Analyzer') {
                        tactics = [
                            'üìä Present multiple scenarios',
                            'üîç Break down all costs clearly',
                            'üìà Show market comparisons',
                            '‚è∞ Allow processing time'
                        ];
                    } else if (profileType === 'The Emotional Decision Maker') {
                        tactics = [
                            'üè† Focus on home\'s next chapter',
                            'üë™ Emphasize family benefits',
                            'üíù Highlight peace of mind',
                            'ü§ó Use collaborative language'
                        ];
                    } else {
                        tactics = [
                            'ü§ù Find mutual benefits',
                            'üìã Offer multiple options',
                            '‚öñÔ∏è Be fair and transparent',
                            'üí¨ Listen actively to concerns'
                        ];
                    }

                    tacticsDiv.innerHTML = tactics.map(tactic =>
                        `<p class="flex items-start"><span class="mr-2">${tactic.split(' ')[0]}</span>${tactic.substring(2)}</p>`
                    ).join('');
                }

                function updateObjectionHandling(profileType, trust, experience, knowledge) {
                    const objectionDiv = document.getElementById('sp-objection-handling');

                    let commonObjections = [];
                    let scripts = [];

                    if (trust < 30) {
                        commonObjections = ['"How do I know you\'re legitimate?"', '"I\'ve heard bad things about wholesalers"', '"This sounds too good to be true"'];
                        scripts = ['"I understand your concern. Let me share some references..."', '"Here\'s my business license and recent testimonials..."', '"Would you like to speak with my previous clients?"'];
                    } else if (profileType === 'The Analyzer') {
                        commonObjections = ['"I need to research this more"', '"Can you prove this is a fair price?"', '"What are all the costs involved?"'];
                        scripts = ['"Absolutely, let me provide you with market data..."', '"Here are recent comparable sales..."', '"I\'ll break down every cost for you..."'];
                    } else {
                        commonObjections = ['"I need to think about it"', '"Is this the best you can do?"', '"I want to get another opinion"'];
                        scripts = ['"That\'s completely understandable..."', '"Let me see what flexibility I have..."', '"I encourage you to get a second opinion..."'];
                    }

                    objectionDiv.innerHTML = `
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">Common Objections:</h4>
                            <div class="text-sm text-gray-700 space-y-2">
                                ${commonObjections.map(obj => `<p>‚Ä¢ ${obj}</p>`).join('')}
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">Recommended Scripts:</h4>
                            <div class="text-sm text-gray-700 space-y-2">
                                ${scripts.map(script => `<p>‚Ä¢ ${script}</p>`).join('')}
                            </div>
                        </div>
                    `;
                }

                function updateFollowupStrategy(profileType, decisionSpeed, urgency, commPref) {
                    let timing = '';
                    let method = '';
                    let tone = '';

                    if (urgency > 60) {
                        timing = 'Within 24 hours';
                        method = 'Phone call + text backup';
                        tone = 'Urgent but helpful';
                    } else if (decisionSpeed === 'deliberate') {
                        timing = 'Wait 3-5 days';
                        method = 'Email with additional info';
                        tone = 'Patient and informative';
                    } else if (profileType === 'The Skeptic') {
                        timing = 'Wait 1 week';
                        method = 'Email with social proof';
                        tone = 'Professional and credible';
                    } else {
                        timing = '2-3 days';
                        method = commPref || 'Phone call';
                        tone = 'Friendly and helpful';
                    }

                    document.getElementById('sp-followup-timing').textContent = timing;
                    document.getElementById('sp-followup-method').textContent = method;
                    document.getElementById('sp-followup-tone').textContent = tone;
                }

                function clearSellerPsychology() {
                    // Clear all inputs
                    const inputs = document.querySelectorAll('#content-seller-psychology input, #content-seller-psychology select');
                    inputs.forEach(input => {
                        if (input.type === 'checkbox') {
                            input.checked = false;
                        } else {
                            input.value = '';
                        }
                    });

                    // Reset displays
                    document.getElementById('sp-profile-type').textContent = 'Complete Assessment';
                    document.getElementById('sp-profile-icon').textContent = 'üé≠';
                    document.getElementById('sp-profile-description').textContent = 'Fill out the assessment to see seller profile';
                    document.getElementById('sp-analytical-score').textContent = '0%';
                    document.getElementById('sp-emotional-score').textContent = '0%';
                    document.getElementById('sp-trust-score').textContent = '0%';
                    document.getElementById('sp-urgency-score').textContent = '0%';

                    // Reset strategy sections
                    document.getElementById('sp-communication-strategy').innerHTML = '<p class="text-gray-500">Complete assessment to see personalized communication recommendations</p>';
                    document.getElementById('sp-negotiation-tactics').innerHTML = '<p class="text-gray-500">Complete assessment to see recommended negotiation approach</p>';
                    document.getElementById('sp-objection-handling').innerHTML = `
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">Common Objections:</h4>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p class="text-gray-500">Complete assessment to see likely objections and responses</p>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">Recommended Scripts:</h4>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p class="text-gray-500">Complete assessment to see personalized conversation starters</p>
                            </div>
                        </div>
                    `;
                    document.getElementById('sp-followup-timing').textContent = 'Complete assessment for timing recommendations';
                    document.getElementById('sp-followup-method').textContent = 'Complete assessment for method recommendations';
                    document.getElementById('sp-followup-tone').textContent = 'Complete assessment for tone recommendations';
                }

                function exportSellerProfile() {
                    const sellerName = document.getElementById('sp-seller-name').value || 'Seller Profile';
                    const profileType = document.getElementById('sp-profile-type').textContent;

                    const reportContent = `SELLER PSYCHOLOGY PROFILE
Generated: ${new Date().toLocaleDateString()}

SELLER INFORMATION
Name: ${sellerName}
Profile Type: ${profileType}
Description: ${document.getElementById('sp-profile-description').textContent}

PSYCHOLOGY SCORES
Analytical Score: ${document.getElementById('sp-analytical-score').textContent}
Emotional Score: ${document.getElementById('sp-emotional-score').textContent}
Trust Level: ${document.getElementById('sp-trust-score').textContent}
Urgency Level: ${document.getElementById('sp-urgency-score').textContent}

COMMUNICATION STRATEGY
${Array.from(document.querySelectorAll('#sp-communication-strategy p')).map(p => p.textContent).join('\n')}

NEGOTIATION TACTICS
${Array.from(document.querySelectorAll('#sp-negotiation-tactics p')).map(p => p.textContent).join('\n')}

FOLLOW-UP STRATEGY
Timing: ${document.getElementById('sp-followup-timing').textContent}
Method: ${document.getElementById('sp-followup-method').textContent}
Tone: ${document.getElementById('sp-followup-tone').textContent}

OBJECTION HANDLING
${Array.from(document.querySelectorAll('#sp-objection-handling p')).map(p => p.textContent).join('\n')}

Generated by Enriched Property Solutions LLC - Seller Psychology Profiler`;

                    const blob = new Blob([reportContent], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${sellerName.replace(/[^a-zA-Z0-9]/g, '_')}_Psychology_Profile_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }

                function generateNegotiationPlan() {
                    const sellerName = document.getElementById('sp-seller-name').value || 'Seller';
                    const profileType = document.getElementById('sp-profile-type').textContent;
                    const profileDescription = document.getElementById('sp-profile-description').textContent;
                    const analyticalScore = document.getElementById('sp-analytical-score').textContent;
                    const emotionalScore = document.getElementById('sp-emotional-score').textContent;
                    const trustScore = document.getElementById('sp-trust-score').textContent;
                    const urgencyScore = document.getElementById('sp-urgency-score').textContent;

                    // Get selected values for plan customization
                    const education = document.getElementById('sp-education').value;
                    const profession = document.getElementById('sp-profession').value;
                    const emotionalState = document.getElementById('sp-emotional-state').value;
                    const trustLevel = document.getElementById('sp-trust-level').value;
                    const negotiationStyle = document.getElementById('sp-negotiation-style').value;
                    const commPreference = document.getElementById('sp-comm-preference').value;
                    const decisionSpeed = document.getElementById('sp-decision-speed').value;

                    // Check motivation triggers
                    const motivations = [];
                    if (document.getElementById('sp-financial-stress').checked) motivations.push('Financial Stress');
                    if (document.getElementById('sp-time-pressure').checked) motivations.push('Time Pressure');
                    if (document.getElementById('sp-family-situation').checked) motivations.push('Family Changes');
                    if (document.getElementById('sp-convenience').checked) motivations.push('Convenience');
                    if (document.getElementById('sp-health-issues').checked) motivations.push('Health Issues');
                    if (document.getElementById('sp-property-burden').checked) motivations.push('Property Burden');
                    if (document.getElementById('sp-investment-focus').checked) motivations.push('Investment Minded');

                    let negotiationPlan = generateDetailedNegotiationPlan(sellerName, profileType, profileDescription, {
                        analytical: analyticalScore,
                        emotional: emotionalScore,
                        trust: trustScore,
                        urgency: urgencyScore
                    }, {
                        education, profession, emotionalState, trustLevel, negotiationStyle, commPreference, decisionSpeed, motivations
                    });

                    // Export the plan
                    const blob = new Blob([negotiationPlan], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${sellerName.replace(/[^a-zA-Z0-9]/g, '_')}_Negotiation_Plan_${new Date().toISOString().slice(0, 10)}.txt`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }

                function generateDetailedNegotiationPlan(sellerName, profileType, description, scores, details) {
                    const plan = `COMPREHENSIVE NEGOTIATION PLAN
Generated: ${new Date().toLocaleDateString()} at ${new Date().toLocaleTimeString()}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
SELLER PROFILE SUMMARY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Seller Name: ${sellerName}
Psychology Profile: ${profileType}
Profile Description: ${description}

PSYCHOLOGY SCORES:
‚Ä¢ Analytical Tendency: ${scores.analytical}
‚Ä¢ Emotional Tendency: ${scores.emotional}
‚Ä¢ Trust Level: ${scores.trust}
‚Ä¢ Urgency Level: ${scores.urgency}

MOTIVATION TRIGGERS: ${details.motivations.length > 0 ? details.motivations.join(', ') : 'None identified'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
PRE-NEGOTIATION PREPARATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generatePreNegotiationChecklist(profileType, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
NEGOTIATION STRATEGY ROADMAP
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateNegotiationRoadmap(profileType, scores, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CONVERSATION FLOW GUIDE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateConversationFlow(profileType, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
KEY TALKING POINTS & MESSAGING
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateTalkingPoints(profileType, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
OBJECTION HANDLING SCRIPTS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateObjectionScripts(profileType, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
POTENTIAL PITFALLS & RED FLAGS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generatePitfalls(profileType, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
FOLLOW-UP SCHEDULE & TIMELINE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateFollowUpSchedule(profileType, scores, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
REQUIRED DOCUMENTATION & MATERIALS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateRequiredDocs(profileType, details)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
SUCCESS METRICS & TRACKING
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${generateSuccessMetrics(profileType)}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
END OF NEGOTIATION PLAN
Generated by Enriched Property Solutions LLC - Seller Psychology Profiler
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;

                    return plan;
                }

                function generatePreNegotiationChecklist(profileType, details) {
                    let checklist = "ESSENTIAL PREPARATION ITEMS:\n\n";

                    if (profileType === 'The Analyzer') {
                        checklist += `‚òê Gather comprehensive market data and comparables
‚òê Prepare detailed cost breakdown spreadsheets
‚òê Research property history and tax records
‚òê Compile references and testimonials
‚òê Prepare multiple offer scenarios with pros/cons
‚òê Research buyer's market knowledge level
‚òê Prepare written proposals and documentation`;
                    } else if (profileType === 'The Emotional Decision Maker') {
                        checklist += `‚òê Research seller's personal story and property history
‚òê Prepare success stories from similar situations
‚òê Gather testimonials from families you've helped
‚òê Understand family dynamics and decision makers
‚òê Prepare empathetic talking points
‚òê Research neighborhood and community connections
‚òê Plan for extended conversation time`;
                    } else if (profileType === 'The Skeptic') {
                        checklist += `‚òê Prepare business credentials and licenses
‚òê Gather client references and contact information
‚òê Compile recent transaction examples
‚òê Prepare transparent fee disclosures
‚òê Research any past negative experiences they may have heard
‚òê Prepare third-party validation sources
‚òê Plan for multiple touchpoints to build trust`;
                    } else if (profileType === 'The Urgent Seller') {
                        checklist += `‚òê Prepare quick-close timeline and process
‚òê Have cash proof of funds readily available
‚òê Streamline paperwork and contracts
‚òê Prepare expedited due diligence process
‚òê Have backup solutions for potential delays
‚òê Prepare immediate next steps
‚òê Clear your schedule for rapid response`;
                    } else {
                        checklist += `‚òê Prepare balanced mix of data and personal approach
‚òê Gather both analytical and emotional talking points
‚òê Prepare flexible negotiation options
‚òê Research seller's preferred communication style
‚òê Plan for multiple meeting formats
‚òê Prepare both written and verbal presentations
‚òê Have backup strategies for different responses`;
                    }

                    checklist += `\n\nGENERAL PREPARATION (ALL PROFILES):
‚òê Property valuation and market analysis
‚òê Cash proof of funds or lender pre-approval
‚òê Purchase agreement templates
‚òê Business cards and marketing materials
‚òê Reference list with contact information
‚òê Mobile device with calculator and note-taking app
‚òê Professional appearance and materials organized`;

                    return checklist;
                }

                function generateNegotiationRoadmap(profileType, scores, details) {
                    let roadmap = "";

                    if (parseInt(scores.urgency) > 60) {
                        roadmap += `PHASE 1: RAPID RAPPORT & PROBLEM IDENTIFICATION (5-10 minutes)
‚Ä¢ Acknowledge their time sensitivity immediately
‚Ä¢ Ask direct questions about their timeline
‚Ä¢ Identify the core problem driving urgency
‚Ä¢ Express ability to move quickly

PHASE 2: SOLUTION PRESENTATION (10-15 minutes)
‚Ä¢ Present cash offer as immediate solution
‚Ä¢ Highlight quick closing timeline (7-14 days)
‚Ä¢ Address their specific urgent needs
‚Ä¢ Minimize paperwork and complexity

PHASE 3: COMMITMENT & NEXT STEPS (5-10 minutes)
‚Ä¢ Push for same-day decision if possible
‚Ä¢ Schedule immediate property inspection
‚Ä¢ Outline next 48-72 hours
‚Ä¢ Exchange contact information for rapid communication`;
                    } else if (profileType === 'The Analyzer') {
                        roadmap += `PHASE 1: DATA-DRIVEN INTRODUCTION (15-20 minutes)
‚Ä¢ Present your credentials and track record
‚Ä¢ Share market analysis and comparable sales
‚Ä¢ Provide detailed explanation of your process
‚Ä¢ Answer analytical questions thoroughly

PHASE 2: COMPREHENSIVE OFFER PRESENTATION (20-30 minutes)
‚Ä¢ Present multiple scenarios with detailed breakdowns
‚Ä¢ Show cost comparisons vs. traditional sale
‚Ä¢ Provide written documentation for review
‚Ä¢ Allow time for questions and analysis

PHASE 3: DECISION FRAMEWORK (10-15 minutes)
‚Ä¢ Summarize key decision points
‚Ä¢ Provide take-away materials for review
‚Ä¢ Schedule follow-up meeting for decision
‚Ä¢ Respect their need for deliberation time`;
                    } else if (profileType === 'The Emotional Decision Maker') {
                        roadmap += `PHASE 1: PERSONAL CONNECTION & STORY (20-25 minutes)
‚Ä¢ Build personal rapport and trust
‚Ä¢ Listen to their story and circumstances
‚Ä¢ Share relevant success stories
‚Ä¢ Establish emotional connection to solution

PHASE 2: BENEFIT-FOCUSED PRESENTATION (15-20 minutes)
‚Ä¢ Focus on how sale helps their family/situation
‚Ä¢ Emphasize peace of mind and stress relief
‚Ä¢ Share testimonials from similar situations
‚Ä¢ Address emotional concerns and fears

PHASE 3: COLLABORATIVE DECISION (10-15 minutes)
‚Ä¢ Position as partnership, not transaction
‚Ä¢ Include all family decision-makers
‚Ä¢ Allow emotional processing time
‚Ä¢ Schedule comfortable follow-up timeline`;
                    } else {
                        roadmap += `PHASE 1: BALANCED INTRODUCTION (15-20 minutes)
‚Ä¢ Establish credibility with both facts and rapport
‚Ä¢ Present your track record and personal approach
‚Ä¢ Understand their priorities and preferences
‚Ä¢ Adapt communication style to their responses

PHASE 2: FLEXIBLE PRESENTATION (20-25 minutes)
‚Ä¢ Mix analytical data with personal benefits
‚Ä¢ Provide options and flexibility
‚Ä¢ Address both logical and emotional concerns
‚Ä¢ Adjust approach based on their engagement

PHASE 3: MUTUAL AGREEMENT (10-15 minutes)
‚Ä¢ Summarize mutual benefits
‚Ä¢ Address any remaining concerns
‚Ä¢ Provide comfortable decision timeline
‚Ä¢ Establish clear next steps and communication`;
                    }

                    return roadmap;
                }

                function generateConversationFlow(profileType, details) {
                    let flow = "";

                    if (profileType === 'The Analyzer') {
                        flow = `OPENING (First 2-3 minutes):
"Thank you for your time, [Name]. I've done some preliminary research on your property and the local market. I'd like to share what I've found and get your perspective on a few key points."

DISCOVERY QUESTIONS:
‚Ä¢ "What factors are most important to you in evaluating an offer?"
‚Ä¢ "Have you researched recent sales in your neighborhood?"
‚Ä¢ "What timeline are you working with for the sale?"
‚Ä¢ "What costs or complications are you hoping to avoid?"

PRESENTATION APPROACH:
‚Ä¢ "Based on the market data I've analyzed..."
‚Ä¢ "Here are three scenarios I've prepared for you..."
‚Ä¢ "The numbers show that..."
‚Ä¢ "Let me break down exactly how this works..."

HANDLING QUESTIONS:
‚Ä¢ Provide detailed, fact-based answers
‚Ä¢ Reference specific data sources
‚Ä¢ Offer to provide additional documentation
‚Ä¢ Acknowledge when you need to research something

CLOSING APPROACH:
"I've provided you with all the data and analysis. What additional information do you need to make an informed decision?"`;

                    } else if (profileType === 'The Emotional Decision Maker') {
                        flow = `OPENING (First 5-7 minutes):
"Hi [Name], thank you so much for meeting with me. Before we talk about your property, I'd love to hear a bit about your situation and what's prompting you to consider selling."

DISCOVERY QUESTIONS:
‚Ä¢ "How long have you lived in this home?"
‚Ä¢ "What are your hopes for the next chapter?"
‚Ä¢ "How is this decision affecting your family?"
‚Ä¢ "What would the ideal outcome look like for you?"

PRESENTATION APPROACH:
‚Ä¢ "I understand this is more than just a transaction for you..."
‚Ä¢ "Here's how we've helped families in similar situations..."
‚Ä¢ "This approach will give you peace of mind because..."
‚Ä¢ "Your family's needs are my priority..."

HANDLING CONCERNS:
‚Ä¢ Acknowledge emotions and validate feelings
‚Ä¢ Share relevant success stories
‚Ä¢ Focus on benefits to family/situation
‚Ä¢ Provide reassurance and support

CLOSING APPROACH:
"It sounds like this solution addresses your main concerns. How do you feel about moving forward together?"`;

                    } else if (profileType === 'The Skeptic') {
                        flow = `OPENING (First 3-5 minutes):
"Hello [Name]. I appreciate you taking the time to meet with me. I know there are a lot of people in real estate who don't always have sellers' best interests at heart, so I'd like to start by showing you exactly who I am and how I operate."

CREDIBILITY BUILDING:
‚Ä¢ Present business license and credentials
‚Ä¢ Share client references and testimonials
‚Ä¢ Explain your process transparently
‚Ä¢ Address common industry concerns upfront

DISCOVERY QUESTIONS:
‚Ä¢ "Have you had any negative experiences with real estate investors?"
‚Ä¢ "What concerns do you have about working with someone like me?"
‚Ä¢ "What would make you feel confident in a buyer?"
‚Ä¢ "What questions do you have about my process?"

PRESENTATION APPROACH:
‚Ä¢ "Here's exactly how the process works, step by step..."
‚Ä¢ "You can verify everything I'm telling you by..."
‚Ä¢ "I encourage you to check my references..."
‚Ä¢ "Here are the contracts and disclosures upfront..."

CLOSING APPROACH:
"I've been completely transparent about my process and credentials. What else do you need to feel confident moving forward?"`;

                    } else {
                        flow = `OPENING (First 3-5 minutes):
"Hi [Name], thanks for your time today. I'm here to learn about your situation and see if there's a way I can help. Can you tell me a bit about what's prompting you to consider selling?"

DISCOVERY QUESTIONS:
‚Ä¢ "What's your ideal timeline for this process?"
‚Ä¢ "What aspects of selling are most important to you?"
‚Ä¢ "Have you considered other selling options?"
‚Ä¢ "What concerns do you have about the process?"

PRESENTATION APPROACH:
‚Ä¢ Adapt based on their responses and preferences
‚Ä¢ Mix data with personal benefits as appropriate
‚Ä¢ Provide options and flexibility
‚Ä¢ Focus on their stated priorities

CLOSING APPROACH:
"Based on everything we've discussed, does this approach seem like a good fit for your situation?"`;
                    }

                    return flow;
                }

                function generateTalkingPoints(profileType, details) {
                    let points = "";

                    if (profileType === 'The Analyzer') {
                        points = `PRIMARY MESSAGING THEMES:
‚Ä¢ Market efficiency and data-driven pricing
‚Ä¢ Cost savings vs. traditional sale (commissions, repairs, etc.)
‚Ä¢ Timeline certainty and process control
‚Ä¢ Risk mitigation and guaranteed closing

KEY PHRASES TO USE:
‚Ä¢ "Based on comparable sales data..."
‚Ä¢ "The numbers clearly show..."
‚Ä¢ "This eliminates the variables of..."
‚Ä¢ "Here's the breakdown of costs..."
‚Ä¢ "Statistically speaking..."
‚Ä¢ "The data supports..."

SUPPORTING STATISTICS:
‚Ä¢ Average time on market in their area
‚Ä¢ Typical repair costs for homes their age
‚Ä¢ Average commission and closing costs
‚Ä¢ Success rate of your past transactions
‚Ä¢ Market trends and predictions`;

                    } else if (profileType === 'The Emotional Decision Maker') {
                        points = `PRIMARY MESSAGING THEMES:
‚Ä¢ Family benefit and stress relief
‚Ä¢ New beginning and fresh start
‚Ä¢ Peace of mind and security
‚Ä¢ Partnership and support through transition

KEY PHRASES TO USE:
‚Ä¢ "Your family deserves..."
‚Ä¢ "This gives you peace of mind..."
‚Ä¢ "I understand this is emotional..."
‚Ä¢ "We're here to support you through..."
‚Ä¢ "Your new chapter can begin..."
‚Ä¢ "This takes the burden off your shoulders..."

EMOTIONAL TRIGGERS:
‚Ä¢ Relief from property stress
‚Ä¢ More time with family
‚Ä¢ Financial security for loved ones
‚Ä¢ Removing uncertainty and worry
‚Ä¢ Enabling new opportunities`;

                    } else if (profileType === 'The Skeptic') {
                        points = `PRIMARY MESSAGING THEMES:
‚Ä¢ Transparency and honesty
‚Ä¢ Proven track record and credibility
‚Ä¢ Risk reduction and guarantees
‚Ä¢ Third-party validation

KEY PHRASES TO USE:
‚Ä¢ "I want to be completely transparent..."
‚Ä¢ "You can verify this by..."
‚Ä¢ "Here are my references..."
‚Ä¢ "I encourage you to check..."
‚Ä¢ "Everything is documented..."
‚Ä¢ "You have full protection..."

CREDIBILITY BUILDERS:
‚Ä¢ Business license and certifications
‚Ä¢ Better Business Bureau rating
‚Ä¢ Client testimonials with contact info
‚Ä¢ Professional association memberships
‚Ä¢ Years in business and transaction history`;

                    } else {
                        points = `PRIMARY MESSAGING THEMES:
‚Ä¢ Flexibility and options
‚Ä¢ Balanced approach to their needs
‚Ä¢ Professional yet personal service
‚Ä¢ Win-win solutions

KEY PHRASES TO USE:
‚Ä¢ "We can work together to..."
‚Ä¢ "I want to understand what's important to you..."
‚Ä¢ "There are several ways we could structure this..."
‚Ä¢ "Let's find the best solution for your situation..."
‚Ä¢ "I'm here to make this work for you..."

ADAPTABLE APPROACHES:
‚Ä¢ Emphasize data if they ask analytical questions
‚Ä¢ Share stories if they express emotional concerns
‚Ä¢ Provide references if they seem skeptical
‚Ä¢ Accelerate if they show urgency`;
                    }

                    return points;
                }

                function generateObjectionScripts(profileType, details) {
                    let scripts = "";

                    if (profileType === 'The Analyzer') {
                        scripts = `COMMON OBJECTION: "I need to research this more."
RESPONSE: "I completely understand - you should research any major decision. Here's additional data I can provide: [list specific resources]. Would you like me to email you the comparable sales report and cost analysis spreadsheet so you can review the numbers thoroughly?"

COMMON OBJECTION: "How do I know this is a fair price?"
RESPONSE: "That's exactly the right question to ask. Let me show you the three different valuation methods I used: recent comparables, cost approach, and income approach. Here's the spreadsheet with all the data sources. Would you like to verify any of these comparables yourself?"

COMMON OBJECTION: "I want to get a second opinion."
RESPONSE: "Absolutely, you should get multiple perspectives on a decision this important. I'd recommend getting an appraisal or CMA from a local realtor. When you do, ask them to factor in the time, costs, and risks of a traditional sale that my offer eliminates."`;

                    } else if (profileType === 'The Emotional Decision Maker') {
                        scripts = `COMMON OBJECTION: "This is happening too fast."
RESPONSE: "I understand this feels overwhelming - selling your home is one of life's biggest decisions. We can move at whatever pace feels comfortable for you. The most important thing is that you feel good about the decision. What timeline would work better for you?"

COMMON OBJECTION: "I'm worried about making the wrong choice."
RESPONSE: "That's a completely natural concern, and it shows how much you care about doing right by your family. Can I share how the Johnson family felt the same way? They were in a very similar situation, and here's what happened for them... [share relevant success story]"

COMMON OBJECTION: "My family thinks I should list with a realtor."
RESPONSE: "Your family wants what's best for you, and it's wonderful that you have their support. Have you had a chance to discuss with them the benefits of a direct sale - like avoiding months of showings, not having to do repairs, and having certainty about the closing? Would it help if I spoke with them to answer any questions?"`;

                    } else if (profileType === 'The Skeptic') {
                        scripts = `COMMON OBJECTION: "How do I know you're legitimate?"
RESPONSE: "That's an excellent question, and you should verify anyone you're considering working with. Here's my business license, my Better Business Bureau profile, and contact information for three recent clients who've given me permission to share their experience. Would you like to call any of them right now?"

COMMON OBJECTION: "I've heard bad things about real estate investors."
RESPONSE: "Unfortunately, there are some bad actors in every industry, and real estate is no exception. That's exactly why I operate with complete transparency. Here's my contract with all terms clearly outlined, here are my fees disclosed upfront, and here's my business attorney's contact if you want independent legal advice."

COMMON OBJECTION: "This sounds too good to be true."
RESPONSE: "I appreciate your skepticism - it shows you're thinking carefully about this decision. Everything I'm proposing is standard in the real estate investment industry. Here's how the business model works and why I can make this offer... [explain business model]. What specific part seems unclear or concerning to you?"`;

                    } else {
                        scripts = `COMMON OBJECTION: "I need to think about it."
RESPONSE: "Of course, this is a big decision and you should take the time you need. To help you think through this, what are the main factors you'll be considering? Is there any additional information I can provide that would be helpful in your decision-making process?"

COMMON OBJECTION: "Is this the best you can do on price?"
RESPONSE: "I understand you want to make sure you're getting fair value. Let me walk you through how I arrived at this number and what factors I considered. I'm always willing to discuss the offer if there are aspects of your situation I may not have fully understood. What concerns do you have about the price?"

COMMON OBJECTION: "I want to get another opinion."
RESPONSE: "That's smart - you should definitely get multiple perspectives on any major decision. I encourage you to speak with a realtor, get an appraisal, or consult with anyone else you trust. When you do, make sure to factor in all the costs and time involved with each option. I'm confident this offer will compare favorably when you consider everything."`;
                    }

                    return scripts;
                }

                function generatePitfalls(profileType, details) {
                    let pitfalls = "";

                    if (profileType === 'The Analyzer') {
                        pitfalls = `POTENTIAL PITFALLS TO AVOID:

‚ö†Ô∏è ANALYSIS PARALYSIS
‚Ä¢ Don't overwhelm with too much data at once
‚Ä¢ Set clear decision deadlines
‚Ä¢ Focus on the 3-4 most important factors
‚Ä¢ Summarize key points clearly

‚ö†Ô∏è QUESTIONING YOUR CREDIBILITY
‚Ä¢ Be prepared with sources for all claims
‚Ä¢ Never exaggerate or oversell
‚Ä¢ Admit when you don't know something
‚Ä¢ Follow up with promised information quickly

‚ö†Ô∏è GETTING LOST IN DETAILS
‚Ä¢ Keep big picture benefits visible
‚Ä¢ Use visual aids and summaries
‚Ä¢ Check for understanding regularly
‚Ä¢ Don't let minor details derail major points

RED FLAGS TO WATCH FOR:
‚Ä¢ Asking for multiple revisions without commitment signals
‚Ä¢ Requesting excessive documentation (possible time-waster)
‚Ä¢ Comparing your offer to unrealistic retail prices
‚Ä¢ Involving too many advisors in the decision process`;

                    } else if (profileType === 'The Emotional Decision Maker') {
                        pitfalls = `POTENTIAL PITFALLS TO AVOID:

‚ö†Ô∏è RUSHING THE EMOTIONAL PROCESS
‚Ä¢ Allow time for feelings to be expressed
‚Ä¢ Don't push for quick decisions
‚Ä¢ Respect their need to include family
‚Ä¢ Be patient with emotional responses

‚ö†Ô∏è BEING TOO TRANSACTIONAL
‚Ä¢ Don't focus only on numbers and logistics
‚Ä¢ Remember this is their home, not just property
‚Ä¢ Acknowledge the emotional significance
‚Ä¢ Share your personal investment in their success

‚ö†Ô∏è IGNORING FAMILY DYNAMICS
‚Ä¢ Identify all decision makers early
‚Ä¢ Address concerns of skeptical family members
‚Ä¢ Don't create family conflict with pressure
‚Ä¢ Ensure everyone feels heard and respected

RED FLAGS TO WATCH FOR:
‚Ä¢ Family members strongly opposed to sale
‚Ä¢ Seller seems to be in emotional crisis
‚Ä¢ Multiple competing emotional priorities
‚Ä¢ Unrealistic expectations based on emotional attachment`;

                    } else if (profileType === 'The Skeptic') {
                        pitfalls = `POTENTIAL PITFALLS TO AVOID:

‚ö†Ô∏è APPEARING PUSHY OR AGGRESSIVE
‚Ä¢ Let them set the pace
‚Ä¢ Provide information, don't pressure
‚Ä¢ Respect their need for verification
‚Ä¢ Never use high-pressure tactics

‚ö†Ô∏è HIDING OR MINIMIZING INFORMATION
‚Ä¢ Disclose everything upfront
‚Ä¢ Explain your business model clearly
‚Ä¢ Address negative industry perceptions
‚Ä¢ Be transparent about your profit

‚ö†Ô∏è TAKING SKEPTICISM PERSONALLY
‚Ä¢ Don't get defensive about questions
‚Ä¢ Thank them for due diligence
‚Ä¢ Provide evidence cheerfully
‚Ä¢ Stay professional and helpful

RED FLAGS TO WATCH FOR:
‚Ä¢ Continued skepticism despite evidence
‚Ä¢ Requests for unreasonable guarantees
‚Ä¢ Involving lawyers before basic agreement
‚Ä¢ Past litigation history with contractors/investors`;

                    } else {
                        pitfalls = `POTENTIAL PITFALLS TO AVOID:

‚ö†Ô∏è MISREADING THEIR COMMUNICATION STYLE
‚Ä¢ Pay attention to their responses
‚Ä¢ Adjust your approach if they seem disengaged
‚Ä¢ Ask how they prefer to receive information
‚Ä¢ Mirror their energy and pace

‚ö†Ô∏è BEING TOO GENERIC
‚Ä¢ Customize your approach to their specific situation
‚Ä¢ Reference their particular concerns
‚Ä¢ Avoid one-size-fits-all presentations
‚Ä¢ Show you understand their unique needs

‚ö†Ô∏è FAILING TO BUILD ENOUGH TRUST
‚Ä¢ Invest time in relationship building
‚Ä¢ Provide references and social proof
‚Ä¢ Follow through on all commitments
‚Ä¢ Be consistent in your communication

RED FLAGS TO WATCH FOR:
‚Ä¢ Inability to identify their primary motivation
‚Ä¢ Conflicting signals about urgency or priorities
‚Ä¢ Reluctance to share basic information about situation
‚Ä¢ Multiple decision-making styles causing confusion`;
                    }

                    return pitfalls;
                }

                function generateFollowUpSchedule(profileType, scores, details) {
                    let schedule = "";

                    if (parseInt(scores.urgency) > 60) {
                        schedule = `IMMEDIATE FOLLOW-UP (Same Day):
‚Ä¢ Send recap email within 2 hours
‚Ä¢ Text confirmation of next steps
‚Ä¢ Schedule property inspection for next business day
‚Ä¢ Prepare expedited paperwork

24-HOUR FOLLOW-UP:
‚Ä¢ Call to confirm inspection appointment
‚Ä¢ Answer any overnight questions
‚Ä¢ Send digital copies of all documents
‚Ä¢ Confirm financing/proof of funds

48-HOUR FOLLOW-UP:
‚Ä¢ Property inspection completed
‚Ä¢ Present final offer immediately
‚Ä¢ Push for decision within 24 hours
‚Ä¢ Have contracts ready for signature

WEEKLY FOLLOW-UP (if delayed):
‚Ä¢ Check on decision timeline
‚Ä¢ Address any new concerns
‚Ä¢ Provide updated market information
‚Ä¢ Maintain urgency without pressure`;

                    } else if (profileType === 'The Analyzer') {
                        schedule = `48-HOUR FOLLOW-UP:
‚Ä¢ Email detailed offer package
‚Ä¢ Include all supporting documentation
‚Ä¢ Provide reference contact information
‚Ä¢ Schedule follow-up meeting for questions

1-WEEK FOLLOW-UP:
‚Ä¢ Call to discuss any questions
‚Ä¢ Provide additional comparables if requested
‚Ä¢ Address any concerns that arose
‚Ä¢ Confirm timeline for their decision

2-WEEK FOLLOW-UP:
‚Ä¢ Check on decision status
‚Ä¢ Offer to meet with advisors/family
‚Ä¢ Provide updated market analysis
‚Ä¢ Set firm decision deadline

MONTHLY FOLLOW-UP (if no decision):
‚Ä¢ Send market updates
‚Ä¢ Check if circumstances have changed
‚Ä¢ Maintain relationship for future opportunities
‚Ä¢ Adjust offer if market conditions warrant`;

                    } else if (profileType === 'The Emotional Decision Maker') {
                        schedule = `NEXT DAY FOLLOW-UP:
‚Ä¢ Send warm, personal thank-you note
‚Ä¢ Include family-focused benefits summary
‚Ä¢ Share additional success stories
‚Ä¢ Offer to answer family questions

3-DAY FOLLOW-UP:
‚Ä¢ Call to check on their feelings about the meeting
‚Ä¢ Address any emotional concerns that arose
‚Ä¢ Offer to meet with other family members
‚Ä¢ Provide references from similar families

1-WEEK FOLLOW-UP:
‚Ä¢ Personal call to maintain relationship
‚Ä¢ Ask about family discussions and feedback
‚Ä¢ Offer flexibility on timeline or terms
‚Ä¢ Schedule follow-up meeting if needed

BI-WEEKLY FOLLOW-UP:
‚Ä¢ Maintain personal connection
‚Ä¢ Share relevant market updates
‚Ä¢ Check on family situation changes
‚Ä¢ Be available for support and questions`;

                    } else {
                        schedule = `2-DAY FOLLOW-UP:
‚Ä¢ Email recap of meeting and next steps
‚Ä¢ Provide any requested additional information
‚Ä¢ Confirm their preferred communication method
‚Ä¢ Schedule follow-up call or meeting

1-WEEK FOLLOW-UP:
‚Ä¢ Call to address questions and concerns
‚Ä¢ Adapt approach based on their feedback
‚Ä¢ Provide updated information as needed
‚Ä¢ Confirm decision timeline

2-WEEK FOLLOW-UP:
‚Ä¢ Check on decision progress
‚Ä¢ Offer additional flexibility if helpful
‚Ä¢ Address any new concerns or questions
‚Ä¢ Maintain professional relationship

MONTHLY FOLLOW-UP:
‚Ä¢ Provide market updates
‚Ä¢ Check if circumstances have changed
‚Ä¢ Maintain relationship for future opportunities
‚Ä¢ Adjust approach based on new information`;
                    }

                    return schedule;
                }

                function generateRequiredDocs(profileType, details) {
                    let docs = "";

                    if (profileType === 'The Analyzer') {
                        docs = `ESSENTIAL DOCUMENTATION:

üìã ANALYTICAL MATERIALS:
‚Ä¢ Comprehensive market analysis report
‚Ä¢ Comparable sales spreadsheet with sources
‚Ä¢ Detailed cost breakdown analysis
‚Ä¢ Timeline comparison chart (direct sale vs. traditional)
‚Ä¢ ROI calculations and projections
‚Ä¢ Property history and tax record summary

üìÑ BUSINESS CREDENTIALS:
‚Ä¢ Business license and registration
‚Ä¢ Professional certifications
‚Ä¢ Insurance certificates
‚Ä¢ Financial statements or proof of funds
‚Ä¢ Recent transaction examples with outcomes
‚Ä¢ Client testimonials with contact information

üìä OFFER DOCUMENTATION:
‚Ä¢ Formal written offer with all terms
‚Ä¢ Purchase agreement template
‚Ä¢ Disclosure forms
‚Ä¢ Inspection contingency details
‚Ä¢ Closing timeline and responsibilities
‚Ä¢ Wire transfer instructions and procedures`;

                    } else if (profileType === 'The Emotional Decision Maker') {
                        docs = `ESSENTIAL DOCUMENTATION:

üíù RELATIONSHIP-BUILDING MATERIALS:
‚Ä¢ Personal bio and family information
‚Ä¢ Success stories from similar families
‚Ä¢ Photo testimonials from past clients
‚Ä¢ Community involvement and references
‚Ä¢ Personal mission statement
‚Ä¢ Before/after stories of families helped

üìÑ TRUST-BUILDING DOCUMENTS:
‚Ä¢ Business credentials and licenses
‚Ä¢ Better Business Bureau profile
‚Ä¢ Professional association memberships
‚Ä¢ Client reference list with contact info
‚Ä¢ Awards or recognition received
‚Ä¢ Charitable work or community involvement

üìã OFFER MATERIALS:
‚Ä¢ Personalized offer letter
‚Ä¢ Simple, clear purchase agreement
‚Ä¢ Family-friendly timeline explanation
‚Ä¢ Moving and transition resources
‚Ä¢ Local service provider recommendations
‚Ä¢ Post-sale support offerings`;

                    } else if (profileType === 'The Skeptic') {
                        docs = `ESSENTIAL DOCUMENTATION:

üîí CREDIBILITY MATERIALS:
‚Ä¢ Government-issued business license
‚Ä¢ Professional liability insurance certificate
‚Ä¢ Better Business Bureau rating and profile
‚Ä¢ State real estate license (if applicable)
‚Ä¢ Professional association memberships
‚Ä¢ Bank references and financial credentials

üìã TRANSPARENCY DOCUMENTS:
‚Ä¢ Complete business model explanation
‚Ä¢ All fees and costs disclosed upfront
‚Ä¢ Sample contracts with terms highlighted
‚Ä¢ Client reference list with full contact info
‚Ä¢ Recent transaction examples with outcomes
‚Ä¢ Third-party verification sources

‚öñÔ∏è LEGAL PROTECTIONS:
‚Ä¢ Attorney contact information
‚Ä¢ Professional escrow company details
‚Ä¢ Title insurance information
‚Ä¢ All required legal disclosures
‚Ä¢ Consumer protection guarantees
‚Ä¢ Complaint resolution process`;

                    } else {
                        docs = `ESSENTIAL DOCUMENTATION:

üìÑ FLEXIBLE PRESENTATION MATERIALS:
‚Ä¢ Business overview and credentials
‚Ä¢ Market analysis (detailed and summary versions)
‚Ä¢ Success stories and testimonials
‚Ä¢ Multiple offer structure options
‚Ä¢ Timeline flexibility examples
‚Ä¢ Various communication format options

üéØ ADAPTABLE RESOURCES:
‚Ä¢ Analytical data for number-focused discussions
‚Ä¢ Personal stories for emotional connections
‚Ä¢ Credibility materials for skeptical concerns
‚Ä¢ Urgency-focused materials for time-sensitive needs
‚Ä¢ Reference materials for all personality types
‚Ä¢ Follow-up templates for various preferences

üìã COMPREHENSIVE OFFER PACKAGE:
‚Ä¢ Multiple offer scenarios and options
‚Ä¢ Clear terms and condition explanations
‚Ä¢ Flexible timeline accommodations
‚Ä¢ Various communication and update methods
‚Ä¢ Support resources and assistance offerings
‚Ä¢ Post-sale relationship and service options`;
                    }

                    return docs;
                }

                function generateSuccessMetrics(profileType) {
                    return `TRACKING NEGOTIATION SUCCESS:

üìä IMMEDIATE METRICS (During Meeting):
‚Ä¢ Level of engagement and interest shown
‚Ä¢ Questions asked (quality and quantity)
‚Ä¢ Objections raised and how well addressed
‚Ä¢ Body language and emotional responses
‚Ä¢ Decision-maker involvement and buy-in
‚Ä¢ Timeline and next steps agreed upon

üìà SHORT-TERM METRICS (1-2 weeks):
‚Ä¢ Response time to follow-up communications
‚Ä¢ Additional information requested
‚Ä¢ Reference checks conducted
‚Ä¢ Family/advisor involvement level
‚Ä¢ Timeline adherence and progression
‚Ä¢ Objection resolution success rate

üéØ LONG-TERM METRICS (1 month+):
‚Ä¢ Final decision outcome (yes/no/delay)
‚Ä¢ Negotiation success rate for this profile type
‚Ä¢ Average time to decision for similar sellers
‚Ä¢ Referral generation from successful deals
‚Ä¢ Repeat business potential
‚Ä¢ Overall satisfaction scores

üí° PROCESS IMPROVEMENT INDICATORS:
‚Ä¢ Which talking points resonated most
‚Ä¢ Most effective objection handling approaches
‚Ä¢ Optimal follow-up timing and methods
‚Ä¢ Most persuasive documentation/evidence
‚Ä¢ Communication preferences that worked best
‚Ä¢ Successful relationship-building techniques

üîÑ CONTINUOUS IMPROVEMENT:
‚Ä¢ Update profile assessment based on actual behavior
‚Ä¢ Refine approach for similar seller types
‚Ä¢ Document successful tactics for future use
‚Ä¢ Identify areas for skill development
‚Ä¢ Track market feedback and adjust accordingly
‚Ä¢ Build template improvements for next negotiation`;
                }

                function saveToContacts() {
                    const sellerName = document.getElementById('sp-seller-name').value || 'Unknown Seller';
                    const profileType = document.getElementById('sp-profile-type').textContent;
                    alert(`Seller Profile Saved to Contacts!\n\nContact: ${sellerName}\nProfile: ${profileType}\n\nThis feature would:\n\nüë• Add to CRM system\nüìù Include psychology notes\nüìÖ Set follow-up reminders\nüéØ Track communication preferences\nüìä Monitor interaction history\n\nIntegration available with major CRM platforms.`);
                }
            </script>
        </div>

    </div>

    <!-- Footer -->
    <footer class="bg-white border-t mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="text-center text-gray-500 text-sm">
                ¬© 2025 Enriched Property Solutions LLC - Wholesaling Tools Dashboard
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/deal-analysis.js"></script>

    <!-- Firebase & Analytics for Zip Code Finder -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const config = {
            apiKey: "AIzaSyC5NMJp2LM-UlNfmynWQVKU-EHwkt6eFh4",
            authDomain: "zipcodefinder-705eb.firebaseapp.com",
            projectId: "zipcodefinder-705eb",
            storageBucket: "zipcodefinder-705eb.firebasestorage.app",
            messagingSenderId: "1077562498903",
            appId: "1:1077562498903:web:eb8dfaeca0d840adcea812",
            measurementId: "G-Z0NRRE8KTP"
        };

        const app = initializeApp(config);
        const db = getFirestore(app);

        window._app = app;
        window._db = db;
        window._col = collection;
        window._add = addDoc;
        window._ts = serverTimestamp;
    </script>
</body>
</html>
